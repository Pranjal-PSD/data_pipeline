[0m16:34:40.103366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF5DFEAF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF60972A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF60A2B2C0>]}


============================== 16:34:40.103366 | 0b2e517e-dbe7-4ef4-9bdd-0bdafea35e0a ==============================
[0m16:34:40.103366 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:34:40.103366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:34:40.170181 [info ] [MainThread]: dbt version: 1.10.5
[0m16:34:40.171384 [info ] [MainThread]: python version: 3.12.6
[0m16:34:40.171384 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m16:34:40.171384 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m16:34:40.753116 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m16:34:40.754152 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m16:34:40.754152 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m16:34:40.756840 [info ] [MainThread]: adapter type: snowflake
[0m16:34:40.756840 [info ] [MainThread]: adapter version: 1.10.0
[0m16:34:40.880314 [info ] [MainThread]: Configuration:
[0m16:34:40.880314 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:34:40.896419 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:34:40.896419 [info ] [MainThread]: Required dependencies:
[0m16:34:40.896419 [debug] [MainThread]: Executing "git --help"
[0m16:34:40.925825 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:34:40.925825 [debug] [MainThread]: STDERR: "b''"
[0m16:34:40.928224 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:34:40.928224 [info ] [MainThread]: Connection:
[0m16:34:40.930235 [info ] [MainThread]:   account: YFCCUOK-SC28960
[0m16:34:40.930235 [info ] [MainThread]:   user: Pranjal007
[0m16:34:40.930235 [info ] [MainThread]:   database: dbt_db
[0m16:34:40.930235 [info ] [MainThread]:   warehouse: dbt_wh
[0m16:34:40.930235 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:34:40.930235 [info ] [MainThread]:   schema: dbt_schema
[0m16:34:40.930235 [info ] [MainThread]:   authenticator: None
[0m16:34:40.930235 [info ] [MainThread]:   oauth_client_id: None
[0m16:34:40.930235 [info ] [MainThread]:   query_tag: None
[0m16:34:40.930235 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:34:40.930235 [info ] [MainThread]:   host: None
[0m16:34:40.930235 [info ] [MainThread]:   port: None
[0m16:34:40.930235 [info ] [MainThread]:   proxy_host: None
[0m16:34:40.930235 [info ] [MainThread]:   proxy_port: None
[0m16:34:40.930235 [info ] [MainThread]:   protocol: None
[0m16:34:40.930235 [info ] [MainThread]:   connect_retries: 1
[0m16:34:40.930235 [info ] [MainThread]:   connect_timeout: None
[0m16:34:40.930235 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:34:40.930235 [info ] [MainThread]:   retry_all: False
[0m16:34:40.930235 [info ] [MainThread]:   insecure_mode: False
[0m16:34:40.930235 [info ] [MainThread]:   reuse_connections: True
[0m16:34:40.930235 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m16:34:40.930235 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:34:41.372571 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:34:41.454889 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:34:41.454889 [debug] [MainThread]: On debug: select 1 as id
[0m16:34:41.454889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:44.014112 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.550 seconds
[0m16:34:44.016113 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:34:44.017120 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:34:44.019339 [debug] [MainThread]: Command `dbt debug` succeeded at 16:34:44.018311 after 4.11 seconds
[0m16:34:44.019339 [debug] [MainThread]: Connection 'debug' was left open.
[0m16:34:44.020339 [debug] [MainThread]: On debug: Close
[0m16:34:44.200640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF606A47A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF62258500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF633881A0>]}
[0m16:34:44.201646 [debug] [MainThread]: Flushing usage events
[0m16:34:45.316067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:56.367824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8991D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C89C6CA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C89C6D520>]}


============================== 16:35:56.375284 | 3c858013-c932-4360-9979-3146da652a3e ==============================
[0m16:35:56.375284 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:35:56.377292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:35:56.410231 [info ] [MainThread]: dbt version: 1.10.5
[0m16:35:56.411308 [info ] [MainThread]: python version: 3.12.6
[0m16:35:56.411308 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m16:35:56.412334 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m16:35:56.995008 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m16:35:56.995008 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m16:35:56.995008 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m16:35:57.010914 [info ] [MainThread]: adapter type: snowflake
[0m16:35:57.010914 [info ] [MainThread]: adapter version: 1.10.0
[0m16:35:57.164334 [info ] [MainThread]: Configuration:
[0m16:35:57.168325 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:35:57.169435 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:35:57.169435 [info ] [MainThread]: Required dependencies:
[0m16:35:57.169435 [debug] [MainThread]: Executing "git --help"
[0m16:35:57.215605 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:35:57.217616 [debug] [MainThread]: STDERR: "b''"
[0m16:35:57.217616 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:35:57.219627 [info ] [MainThread]: Connection:
[0m16:35:57.219627 [info ] [MainThread]:   account: YFCCUOK-SC28960
[0m16:35:57.219627 [info ] [MainThread]:   user: Pranjal007
[0m16:35:57.221637 [info ] [MainThread]:   database: dbt_db
[0m16:35:57.221637 [info ] [MainThread]:   warehouse: dbt_wh
[0m16:35:57.224023 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:35:57.225154 [info ] [MainThread]:   schema: dbt_schema
[0m16:35:57.225661 [info ] [MainThread]:   authenticator: None
[0m16:35:57.225661 [info ] [MainThread]:   oauth_client_id: None
[0m16:35:57.225661 [info ] [MainThread]:   query_tag: None
[0m16:35:57.225661 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:35:57.229915 [info ] [MainThread]:   host: None
[0m16:35:57.229915 [info ] [MainThread]:   port: None
[0m16:35:57.231806 [info ] [MainThread]:   proxy_host: None
[0m16:35:57.231806 [info ] [MainThread]:   proxy_port: None
[0m16:35:57.231806 [info ] [MainThread]:   protocol: None
[0m16:35:57.231806 [info ] [MainThread]:   connect_retries: 1
[0m16:35:57.234635 [info ] [MainThread]:   connect_timeout: None
[0m16:35:57.236461 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:35:57.236461 [info ] [MainThread]:   retry_all: False
[0m16:35:57.238473 [info ] [MainThread]:   insecure_mode: False
[0m16:35:57.238473 [info ] [MainThread]:   reuse_connections: True
[0m16:35:57.239982 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m16:35:57.239982 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:35:57.681408 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:35:57.799127 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:35:57.799127 [debug] [MainThread]: On debug: select 1 as id
[0m16:35:57.799127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:00.113321 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.315 seconds
[0m16:36:00.113321 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:36:00.113321 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:36:00.113321 [debug] [MainThread]: Command `dbt debug` succeeded at 16:36:00.113321 after 3.95 seconds
[0m16:36:00.120396 [debug] [MainThread]: Connection 'debug' was left open.
[0m16:36:00.120396 [debug] [MainThread]: On debug: Close
[0m16:36:00.332849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C86E5A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8C30F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88C05220>]}
[0m16:36:00.332849 [debug] [MainThread]: Flushing usage events
[0m16:36:01.588774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:41.945309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A38FE2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A386C2FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3863CDA0>]}


============================== 16:42:41.951391 | 8745537a-4bc9-4da6-bfbc-28c2ac4822d7 ==============================
[0m16:42:41.951391 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:42:41.952301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:42:41.984574 [info ] [MainThread]: dbt version: 1.10.5
[0m16:42:41.985573 [info ] [MainThread]: python version: 3.12.6
[0m16:42:41.986944 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m16:42:41.986944 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m16:42:42.599187 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m16:42:42.600742 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m16:42:42.602304 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m16:42:42.603715 [info ] [MainThread]: adapter type: snowflake
[0m16:42:42.604371 [info ] [MainThread]: adapter version: 1.10.0
[0m16:42:42.751992 [info ] [MainThread]: Configuration:
[0m16:42:42.752796 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:42:42.753806 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:42:42.754807 [info ] [MainThread]: Required dependencies:
[0m16:42:42.755291 [debug] [MainThread]: Executing "git --help"
[0m16:42:42.793642 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:42:42.794665 [debug] [MainThread]: STDERR: "b''"
[0m16:42:42.794665 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:42:42.795813 [info ] [MainThread]: Connection:
[0m16:42:42.797322 [info ] [MainThread]:   account: YFCCUOK-SC28960
[0m16:42:42.797322 [info ] [MainThread]:   user: Pranjal007
[0m16:42:42.798496 [info ] [MainThread]:   database: dbt_db
[0m16:42:42.799794 [info ] [MainThread]:   warehouse: dbt_wh
[0m16:42:42.799794 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:42:42.800795 [info ] [MainThread]:   schema: dbt_schema
[0m16:42:42.802077 [info ] [MainThread]:   authenticator: None
[0m16:42:42.802077 [info ] [MainThread]:   oauth_client_id: None
[0m16:42:42.803225 [info ] [MainThread]:   query_tag: None
[0m16:42:42.804244 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:42:42.804244 [info ] [MainThread]:   host: None
[0m16:42:42.805258 [info ] [MainThread]:   port: None
[0m16:42:42.806258 [info ] [MainThread]:   proxy_host: None
[0m16:42:42.807242 [info ] [MainThread]:   proxy_port: None
[0m16:42:42.808244 [info ] [MainThread]:   protocol: None
[0m16:42:42.808244 [info ] [MainThread]:   connect_retries: 1
[0m16:42:42.809245 [info ] [MainThread]:   connect_timeout: None
[0m16:42:42.810245 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:42:42.811243 [info ] [MainThread]:   retry_all: False
[0m16:42:42.812244 [info ] [MainThread]:   insecure_mode: False
[0m16:42:42.812244 [info ] [MainThread]:   reuse_connections: True
[0m16:42:42.813248 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m16:42:42.814244 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:42:43.260973 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:42:43.348661 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:42:43.349662 [debug] [MainThread]: On debug: select 1 as id
[0m16:42:43.349662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:45.562995 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.213 seconds
[0m16:42:45.564999 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:42:45.565995 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:42:45.566996 [debug] [MainThread]: Command `dbt debug` succeeded at 16:42:45.566996 after 3.87 seconds
[0m16:42:45.568105 [debug] [MainThread]: Connection 'debug' was left open.
[0m16:42:45.568105 [debug] [MainThread]: On debug: Close
[0m16:42:45.976433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A35FE3EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3B2F4B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3B658F50>]}
[0m16:42:45.977436 [debug] [MainThread]: Flushing usage events
[0m16:42:47.126045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:31.033698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CC35AB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CC6189160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CC617AD20>]}


============================== 16:51:31.038727 | 29f911f7-bf69-4e22-a780-680514e4ff6e ==============================
[0m16:51:31.038727 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:51:31.040736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:51:31.286932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29f911f7-bf69-4e22-a780-680514e4ff6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CC660B260>]}
[0m16:51:31.337963 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-rxchev14'
[0m16:51:31.340393 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:54:19.862749 [error] [MainThread]: Encountered an error:

[0m16:54:19.904737 [debug] [MainThread]: Command `dbt deps` failed at 16:54:19.904737 after 169.14 seconds
[0m16:54:19.904737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CC5AE91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CC78ABCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CC67B6600>]}
[0m16:54:19.904737 [debug] [MainThread]: Flushing usage events
[0m16:54:22.194114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:28.780866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020486411550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020486411970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020486412900>]}


============================== 16:54:28.786201 | 69fe917c-74d2-49ab-a376-7dfaeee162b0 ==============================
[0m16:54:28.786201 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:54:28.788211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:54:29.011642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69fe917c-74d2-49ab-a376-7dfaeee162b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020485DC5C10>]}
[0m16:54:29.055193 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-ojg0tlml'
[0m16:54:29.055193 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:55:53.548204 [error] [MainThread]: Encountered an error:

[0m16:55:53.852566 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\deps\resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\deps\registry.py", line 98, in resolved
    self._check_in_index()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\deps\registry.py", line 75, in _check_in_index
    index = registry.index_cached()
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\utils\utils.py", line 127, in __call__
    value = self.func(*args)
            ^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\clients\registry.py", line 189, in index
    return connection_exception_retry(get_index_fn, 5)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\utils\connection.py", line 22, in connection_exception_retry
    return fn()
           ^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\clients\registry.py", line 168, in _get_index
    resp = requests.get(url, timeout=30)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\util\connection.py", line 81, in create_connection
    sock.close()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 501, in close
    def close(self):
    
KeyboardInterrupt

[0m16:55:53.854572 [debug] [MainThread]: Command `dbt deps` failed at 16:55:53.854572 after 85.32 seconds
[0m16:55:53.856577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048691E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020483AEA150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204839B4170>]}
[0m16:55:53.856577 [debug] [MainThread]: Flushing usage events
[0m16:55:56.293505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:33.582098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2D72C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2CADBF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2B132F60>]}


============================== 16:56:33.587823 | d5bcaa07-9b84-45b4-9279-166dd0b9aedd ==============================
[0m16:56:33.587823 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:56:33.587823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:33.780636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5bcaa07-9b84-45b4-9279-166dd0b9aedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DB3D6A0>]}
[0m16:56:33.824393 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-neei71ir'
[0m16:56:33.826404 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:59:02.327601 [error] [MainThread]: Encountered an error:

[0m16:59:02.336623 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\deps\resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\deps\registry.py", line 98, in resolved
    self._check_in_index()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\deps\registry.py", line 75, in _check_in_index
    index = registry.index_cached()
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\utils\utils.py", line 127, in __call__
    value = self.func(*args)
            ^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\clients\registry.py", line 189, in index
    return connection_exception_retry(get_index_fn, 5)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\utils\connection.py", line 22, in connection_exception_retry
    return fn()
           ^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\clients\registry.py", line 168, in _get_index
    resp = requests.get(url, timeout=30)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\util\connection.py", line 81, in create_connection
    sock.close()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 501, in close
    def close(self):
    
KeyboardInterrupt

[0m16:59:02.339912 [debug] [MainThread]: Command `dbt deps` failed at 16:59:02.339912 after 149.02 seconds
[0m16:59:02.340914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2CCC4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2D1D92E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2F0A0320>]}
[0m16:59:02.341915 [debug] [MainThread]: Flushing usage events
[0m16:59:04.484688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:10.720357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002265E9845F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022664730920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022664DB92E0>]}


============================== 17:00:10.725830 | 13fb5032-671f-4202-b735-2bc4f62b1ba7 ==============================
[0m17:00:10.725830 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:00:10.726749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:00:10.916613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13fb5032-671f-4202-b735-2bc4f62b1ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022664F23EF0>]}
[0m17:00:10.960008 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-_i_6n86e'
[0m17:00:10.962007 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m17:00:13.110124 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:13.110124 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m17:00:13.110124 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m17:00:13.110124 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:13.139786 [debug] [MainThread]: STDOUT: "b'7672637704c7ae428125d8aa1769e5e34ae32251\n'"
[0m17:00:13.139786 [debug] [MainThread]: STDERR: "b''"
[0m17:00:13.139786 [debug] [MainThread]: Checking out revision 1.3.1.
[0m17:00:13.139786 [debug] [MainThread]: Executing "git remote set-branches origin 1.3.1"
[0m17:00:13.180220 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:13.180220 [debug] [MainThread]: STDERR: "b''"
[0m17:00:13.180220 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 1.3.1"
[0m17:00:15.904295 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:15.905580 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               1.3.1      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n * [new tag]         1.1.1      -> 1.1.1\n * [new tag]         1.2.0      -> 1.2.0\n * [new tag]         1.2.0-rc1  -> 1.2.0-rc1\n * [new tag]         1.3.0      -> 1.3.0\n * [new tag]         1.3.1      -> 1.3.1\n'"
[0m17:00:15.905580 [debug] [MainThread]: Executing "git tag --list"
[0m17:00:15.940812 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0\n1.2.0-rc1\n1.3.0\n1.3.1\n'"
[0m17:00:15.943327 [debug] [MainThread]: STDERR: "b''"
[0m17:00:15.943327 [debug] [MainThread]: Executing "git reset --hard tags/1.3.1"
[0m17:00:16.124190 [debug] [MainThread]: STDOUT: "b'HEAD is now at 4232773 Fix logic to not reset the variable (#1043)\n'"
[0m17:00:16.126891 [debug] [MainThread]: STDERR: "b''"
[0m17:00:16.126891 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:16.149964 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:16.149964 [debug] [MainThread]: STDERR: "b''"
[0m17:00:16.151972 [debug] [MainThread]: Checked out at 4232773.
[0m17:00:16.151972 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:16.171809 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:16.171809 [debug] [MainThread]: STDERR: "b''"
[0m17:00:16.196685 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m17:00:16.218619 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:16.220630 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m17:00:16.220630 [debug] [MainThread]: command return code=128
[0m17:00:16.220630 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m17:00:16.220630 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:16.246285 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:16.246285 [debug] [MainThread]: STDERR: "b''"
[0m17:00:16.246285 [debug] [MainThread]: Checking out revision 1.3.1.
[0m17:00:16.246285 [debug] [MainThread]: Executing "git remote set-branches origin 1.3.1"
[0m17:00:16.284050 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:16.284050 [debug] [MainThread]: STDERR: "b''"
[0m17:00:16.286057 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 1.3.1"
[0m17:00:19.188897 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:19.190391 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               1.3.1      -> FETCH_HEAD\n'"
[0m17:00:19.190391 [debug] [MainThread]: Executing "git tag --list"
[0m17:00:19.227849 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0\n1.2.0-rc1\n1.3.0\n1.3.1\n'"
[0m17:00:19.228867 [debug] [MainThread]: STDERR: "b''"
[0m17:00:19.229856 [debug] [MainThread]: Executing "git reset --hard tags/1.3.1"
[0m17:00:19.280777 [debug] [MainThread]: STDOUT: "b'HEAD is now at 4232773 Fix logic to not reset the variable (#1043)\n'"
[0m17:00:19.281798 [debug] [MainThread]: STDERR: "b''"
[0m17:00:19.281798 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:19.305670 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:19.306723 [debug] [MainThread]: STDERR: "b''"
[0m17:00:19.306723 [debug] [MainThread]: Already at 4232773, nothing to do.
[0m17:00:19.307723 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:19.329801 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:19.330817 [debug] [MainThread]: STDERR: "b''"
[0m17:00:19.471065 [info ] [MainThread]: Updating lock file in file path: C:\Users\lenovo\data_pipeline/package-lock.yml
[0m17:00:19.492375 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-mlevjakh'
[0m17:00:19.493720 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m17:00:19.494739 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m17:00:21.472295 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:21.472295 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m17:00:21.474303 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m17:00:21.474303 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:21.496394 [debug] [MainThread]: STDOUT: "b'7672637704c7ae428125d8aa1769e5e34ae32251\n'"
[0m17:00:21.498404 [debug] [MainThread]: STDERR: "b''"
[0m17:00:21.498404 [debug] [MainThread]: Checking out revision 423277393abcd0f3827e30bdbe5c896bfa833239.
[0m17:00:21.498404 [debug] [MainThread]: Executing "git fetch origin --depth 1 423277393abcd0f3827e30bdbe5c896bfa833239"
[0m17:00:23.304483 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:23.305521 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            423277393abcd0f3827e30bdbe5c896bfa833239 -> FETCH_HEAD\n'"
[0m17:00:23.306517 [debug] [MainThread]: Executing "git reset --hard 423277393abcd0f3827e30bdbe5c896bfa833239"
[0m17:00:23.431459 [debug] [MainThread]: STDOUT: "b'HEAD is now at 4232773 Fix logic to not reset the variable (#1043)\n'"
[0m17:00:23.431459 [debug] [MainThread]: STDERR: "b''"
[0m17:00:23.432471 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:23.454530 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:23.455556 [debug] [MainThread]: STDERR: "b''"
[0m17:00:23.456550 [debug] [MainThread]: Checked out at 4232773.
[0m17:00:23.456550 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:23.479219 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:23.480243 [debug] [MainThread]: STDERR: "b''"
[0m17:00:23.482765 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m17:00:23.502713 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:23.504030 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m17:00:23.504030 [debug] [MainThread]: command return code=128
[0m17:00:23.505077 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m17:00:23.505077 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:23.528799 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:23.528799 [debug] [MainThread]: STDERR: "b''"
[0m17:00:23.529802 [debug] [MainThread]: Checking out revision 423277393abcd0f3827e30bdbe5c896bfa833239.
[0m17:00:23.529802 [debug] [MainThread]: Executing "git fetch origin --depth 1 423277393abcd0f3827e30bdbe5c896bfa833239"
[0m17:00:25.494549 [debug] [MainThread]: STDOUT: "b''"
[0m17:00:25.494963 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            423277393abcd0f3827e30bdbe5c896bfa833239 -> FETCH_HEAD\n'"
[0m17:00:25.494963 [debug] [MainThread]: Executing "git reset --hard 423277393abcd0f3827e30bdbe5c896bfa833239"
[0m17:00:25.545833 [debug] [MainThread]: STDOUT: "b'HEAD is now at 4232773 Fix logic to not reset the variable (#1043)\n'"
[0m17:00:25.545833 [debug] [MainThread]: STDERR: "b''"
[0m17:00:25.545833 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:00:25.562339 [debug] [MainThread]: STDOUT: "b'423277393abcd0f3827e30bdbe5c896bfa833239\n'"
[0m17:00:25.562339 [debug] [MainThread]: STDERR: "b''"
[0m17:00:25.562339 [debug] [MainThread]: Already at 4232773, nothing to do.
[0m17:00:25.574358 [info ] [MainThread]: Installed from revision 423277393abcd0f3827e30bdbe5c896bfa833239
[0m17:00:25.574358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '13fb5032-671f-4202-b735-2bc4f62b1ba7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266617BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266420CF80>]}
[0m17:00:25.576798 [debug] [MainThread]: Command `dbt deps` succeeded at 17:00:25.576798 after 15.11 seconds
[0m17:00:25.576798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002265E9845F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022664F23C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022666120B30>]}
[0m17:00:25.576798 [debug] [MainThread]: Flushing usage events
[0m17:00:26.766303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:02.460550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE15652B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE1565550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE1567500>]}


============================== 17:04:02.466969 | b43a6da3-5c18-4b03-94b5-1161367c3a73 ==============================
[0m17:04:02.466969 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:04:02.467959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:02.676426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b43a6da3-5c18-4b03-94b5-1161367c3a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE21259A0>]}
[0m17:04:02.719670 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-1exx65aq'
[0m17:04:02.721108 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:06:52.527476 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:06:52.528479 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:09:41.206981 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:09:41.226964 [info ] [MainThread]: Updating lock file in file path: C:\Users\lenovo\data_pipeline/package-lock.yml
[0m17:09:41.248004 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-q1pa2nxm'
[0m17:09:41.259106 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:09:43.314694 [info ] [MainThread]: Installed from version 1.3.1
[0m17:09:43.315694 [info ] [MainThread]: Up to date!
[0m17:09:43.316709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b43a6da3-5c18-4b03-94b5-1161367c3a73', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE2238F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE3305CA0>]}
[0m17:09:43.318690 [debug] [MainThread]: Command `dbt deps` succeeded at 17:09:43.318690 after 341.11 seconds
[0m17:09:43.319689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE20BCC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE14DE3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BE14DF590>]}
[0m17:09:43.319689 [debug] [MainThread]: Flushing usage events
[0m17:09:44.361864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:26.694303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7F0DAE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7EFCBEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7EFCB710>]}


============================== 18:29:26.697210 | 99dddeca-61ce-423e-8201-7bf368139dab ==============================
[0m18:29:26.697210 [info ] [MainThread]: Running with dbt=1.10.5
[0m18:29:26.697210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:27.539793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99dddeca-61ce-423e-8201-7bf368139dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7F1D3EC0>]}
[0m18:29:27.636878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99dddeca-61ce-423e-8201-7bf368139dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04483140>]}
[0m18:29:27.636878 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:29:28.295779 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m18:29:28.295779 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:29:28.299851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99dddeca-61ce-423e-8201-7bf368139dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E023ABFB0>]}
[0m18:29:32.837489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.marts
[0m18:29:32.850487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99dddeca-61ce-423e-8201-7bf368139dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04B96060>]}
[0m18:29:32.940226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m18:29:32.944214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m18:29:32.981898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99dddeca-61ce-423e-8201-7bf368139dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04C64470>]}
[0m18:29:32.981898 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 593 macros
[0m18:29:32.982898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99dddeca-61ce-423e-8201-7bf368139dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04C17560>]}
[0m18:29:32.984898 [info ] [MainThread]: 
[0m18:29:32.985406 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:29:32.985406 [info ] [MainThread]: 
[0m18:29:32.986428 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:29:32.987428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m18:29:33.116618 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m18:29:33.116618 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m18:29:33.117621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:34.714263 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.600 seconds
[0m18:29:34.721679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:29:34.721679 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:29:34.721679 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m18:29:34.721679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:35.240950 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.506 seconds
[0m18:29:35.242733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99dddeca-61ce-423e-8201-7bf368139dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04CC3230>]}
[0m18:29:35.249312 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m18:29:35.249312 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m18:29:35.249312 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m18:29:35.249312 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m18:29:35.264961 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m18:29:35.264961 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m18:29:35.297094 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m18:29:35.297094 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m18:29:35.297094 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m18:29:35.297094 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:29:37.350355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.042 seconds
[0m18:29:37.389985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99dddeca-61ce-423e-8201-7bf368139dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7F1D3050>]}
[0m18:29:37.390970 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.14s]
[0m18:29:37.392971 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m18:29:37.396490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:37.397488 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m18:29:37.397488 [debug] [MainThread]: On list_dbt_db: Close
[0m18:29:37.592360 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:29:37.593874 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:29:37.832933 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m18:29:37.833957 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m18:29:38.013036 [info ] [MainThread]: 
[0m18:29:38.014038 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m18:29:38.016127 [debug] [MainThread]: Command end result
[0m18:29:38.059551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m18:29:38.066838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m18:29:38.077259 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m18:29:38.077259 [info ] [MainThread]: 
[0m18:29:38.078763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:38.079837 [info ] [MainThread]: 
[0m18:29:38.080841 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:29:38.081842 [debug] [MainThread]: Command `dbt run` succeeded at 18:29:38.081842 after 11.65 seconds
[0m18:29:38.082843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7F0DAE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E02292690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E02292090>]}
[0m18:29:38.082843 [debug] [MainThread]: Flushing usage events
[0m18:29:39.329348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:48:58.641552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC15DCF140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC13B62E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC15DCEF00>]}


============================== 09:48:58.641552 | 42ee22b2-2999-4c87-8e37-01bd3c730cb1 ==============================
[0m09:48:58.641552 [info ] [MainThread]: Running with dbt=1.10.5
[0m09:48:58.641552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:48:59.687310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42ee22b2-2999-4c87-8e37-01bd3c730cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC163E10A0>]}
[0m09:48:59.752788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42ee22b2-2999-4c87-8e37-01bd3c730cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC163E32C0>]}
[0m09:48:59.754359 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:49:00.256415 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m09:49:01.905479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:49:01.905479 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\staging\stg_tpch_line_items.sql
[0m09:49:02.142232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.marts
[0m09:49:02.156405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42ee22b2-2999-4c87-8e37-01bd3c730cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC18B80C80>]}
[0m09:49:02.236974 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m09:49:02.258219 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m09:49:02.294026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42ee22b2-2999-4c87-8e37-01bd3c730cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC188CB230>]}
[0m09:49:02.294026 [info ] [MainThread]: Found 2 models, 3 data tests, 2 sources, 593 macros
[0m09:49:02.295025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42ee22b2-2999-4c87-8e37-01bd3c730cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC18B82C60>]}
[0m09:49:02.296484 [info ] [MainThread]: 
[0m09:49:02.297484 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:49:02.298484 [info ] [MainThread]: 
[0m09:49:02.298484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:49:02.303484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m09:49:04.799792 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m09:49:04.799792 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m09:49:04.799792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:07.531174 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.731 seconds
[0m09:49:07.534179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m09:49:07.545178 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m09:49:07.545178 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m09:49:07.545178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:08.565135 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.020 seconds
[0m09:49:08.567663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42ee22b2-2999-4c87-8e37-01bd3c730cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC18EED8E0>]}
[0m09:49:08.581124 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m09:49:08.581124 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m09:49:08.582124 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m09:49:08.582124 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m09:49:08.582124 [info ] [Thread-2 (]: 2 of 2 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m09:49:08.583471 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m09:49:08.583471 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m09:49:08.591806 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m09:49:08.591806 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m09:49:08.594805 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m09:49:08.595804 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m09:49:08.595804 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m09:49:08.619821 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m09:49:08.622771 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m09:49:08.624919 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m09:49:08.624919 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m09:49:08.624919 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:49:08.625920 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m09:49:08.626920 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m09:49:08.627920 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:49:09.634542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.007 seconds
[0m09:49:09.635655 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.010 seconds
[0m09:49:09.661392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42ee22b2-2999-4c87-8e37-01bd3c730cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC132EF290>]}
[0m09:49:09.661392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42ee22b2-2999-4c87-8e37-01bd3c730cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC15700860>]}
[0m09:49:09.661392 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 1.07s]
[0m09:49:09.663634 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m09:49:09.662547 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 1.08s]
[0m09:49:09.663634 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m09:49:09.665029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:09.665029 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m09:49:09.666396 [debug] [MainThread]: On list_dbt_db: Close
[0m09:49:09.964461 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m09:49:09.964461 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m09:49:10.218421 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m09:49:10.218421 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m09:49:10.541511 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m09:49:10.541511 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m09:49:10.704632 [info ] [MainThread]: 
[0m09:49:10.704632 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m09:49:10.704632 [debug] [MainThread]: Command end result
[0m09:49:10.720908 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m09:49:10.729789 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m09:49:10.735888 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m09:49:10.736903 [info ] [MainThread]: 
[0m09:49:10.736903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:10.736903 [info ] [MainThread]: 
[0m09:49:10.738287 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m09:49:10.738287 [debug] [MainThread]: Command `dbt run` succeeded at 09:49:10.738287 after 12.31 seconds
[0m09:49:10.738287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC130E7A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC126C8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC156AE450>]}
[0m09:49:10.738287 [debug] [MainThread]: Flushing usage events
[0m09:49:12.184906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:47.043646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436E2C5E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436DDBE0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436E47A090>]}


============================== 09:58:47.047650 | a5721fc4-9052-4f54-b7ef-031e1f0dbee6 ==============================
[0m09:58:47.047650 [info ] [MainThread]: Running with dbt=1.10.5
[0m09:58:47.047650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s int_order_items', 'send_anonymous_usage_stats': 'True'}
[0m09:58:47.573543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5721fc4-9052-4f54-b7ef-031e1f0dbee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024370377740>]}
[0m09:58:47.629147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5721fc4-9052-4f54-b7ef-031e1f0dbee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436FED9370>]}
[0m09:58:47.631078 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:58:47.990321 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m09:58:48.226970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m09:58:48.226970 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\int_order_items.sql
[0m09:58:48.226970 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\int_order_items_summary.sql
[0m09:58:48.227970 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\fct_orders.sql
[0m09:58:48.227970 [debug] [MainThread]: Partial parsing: added file: data_pipeline://macros\pricing.sql
[0m09:58:48.504314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5721fc4-9052-4f54-b7ef-031e1f0dbee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024371060DA0>]}
[0m09:58:48.579332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m09:58:48.582336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m09:58:48.603916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5721fc4-9052-4f54-b7ef-031e1f0dbee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243710C3DD0>]}
[0m09:58:48.604916 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 594 macros
[0m09:58:48.605910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5721fc4-9052-4f54-b7ef-031e1f0dbee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024370896E10>]}
[0m09:58:48.607134 [info ] [MainThread]: 
[0m09:58:48.607134 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:58:48.608284 [info ] [MainThread]: 
[0m09:58:48.608284 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:58:48.609481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m09:58:48.704873 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m09:58:48.705873 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m09:58:48.705873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:50.856992 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.160 seconds
[0m09:58:50.872666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m09:58:50.883424 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m09:58:50.884588 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m09:58:50.884588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:51.776691 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.893 seconds
[0m09:58:51.780383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5721fc4-9052-4f54-b7ef-031e1f0dbee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024371113E90>]}
[0m09:58:51.785300 [debug] [Thread-1 (]: Began running node model.data_pipeline.int_order_items
[0m09:58:51.786304 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m09:58:51.787314 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m09:58:51.787314 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.int_order_items
[0m09:58:51.794441 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m09:58:51.795442 [debug] [Thread-1 (]: Began executing node model.data_pipeline.int_order_items
[0m09:58:51.820194 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m09:58:51.822321 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m09:58:51.822321 [debug] [Thread-1 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m09:58:51.822321 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:58:56.759159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.936 seconds
[0m09:58:56.778720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5721fc4-9052-4f54-b7ef-031e1f0dbee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436B832F90>]}
[0m09:58:56.780063 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 4.99s]
[0m09:58:56.781104 [debug] [Thread-1 (]: Finished running node model.data_pipeline.int_order_items
[0m09:58:56.782102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:56.782102 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m09:58:56.783091 [debug] [MainThread]: On list_dbt_db: Close
[0m09:58:57.205271 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m09:58:57.206315 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m09:58:58.194137 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m09:58:58.194137 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m09:58:58.465601 [info ] [MainThread]: 
[0m09:58:58.465601 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.86 seconds (9.86s).
[0m09:58:58.465601 [debug] [MainThread]: Command end result
[0m09:58:58.492352 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m09:58:58.492352 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m09:58:58.499170 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m09:58:58.499170 [info ] [MainThread]: 
[0m09:58:58.499170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:58.499170 [info ] [MainThread]: 
[0m09:58:58.499170 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:58:58.499170 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:58.499170 after 11.63 seconds
[0m09:58:58.499170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436E5DE840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436C19B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436C19B140>]}
[0m09:58:58.499170 [debug] [MainThread]: Flushing usage events
[0m09:58:59.790304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:04:32.129487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911F10EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911F10F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029119744560>]}


============================== 10:04:32.134032 | 8a2e38d7-6d78-4577-a8bf-96508f5e8b89 ==============================
[0m10:04:32.134032 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:04:32.134032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:04:32.683396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029121CAF650>]}
[0m10:04:32.744966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911FE132C0>]}
[0m10:04:32.750125 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:04:33.093573 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:04:33.343708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:04:33.343708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:04:33.386399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911FC6BF80>]}
[0m10:04:33.476264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:04:33.478394 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:04:33.501343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002912234D9A0>]}
[0m10:04:33.502752 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 594 macros
[0m10:04:33.503753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002912245F020>]}
[0m10:04:33.505751 [info ] [MainThread]: 
[0m10:04:33.505751 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:04:33.506751 [info ] [MainThread]: 
[0m10:04:33.506751 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:04:33.512041 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:04:33.610399 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:04:33.610399 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:04:33.610399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:35.209468 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.599 seconds
[0m10:04:35.212557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:04:35.221557 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:04:35.222559 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:04:35.222559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:35.828151 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.607 seconds
[0m10:04:35.830305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029121EB7D40>]}
[0m10:04:35.834939 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m10:04:35.834939 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m10:04:35.836944 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m10:04:35.836944 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m10:04:35.836944 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m10:04:35.836944 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m10:04:35.838949 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m10:04:35.853004 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m10:04:35.855009 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m10:04:35.857013 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m10:04:35.857013 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m10:04:35.879191 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m10:04:35.886191 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m10:04:35.889191 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m10:04:35.891190 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m10:04:35.892391 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m10:04:35.892700 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m10:04:35.892700 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m10:04:35.893853 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:04:35.893853 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:36.592894 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m10:04:36.614003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911F130920>]}
[0m10:04:36.625381 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 0.78s]
[0m10:04:36.626230 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m10:04:37.022658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.138 seconds
[0m10:04:37.034923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002912298DD60>]}
[0m10:04:37.034923 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 1.20s]
[0m10:04:37.034923 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m10:04:37.034923 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m10:04:37.034923 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m10:04:37.038454 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m10:04:37.038454 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m10:04:37.038454 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m10:04:37.038454 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m10:04:37.062209 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m10:04:37.062209 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m10:04:37.062209 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m10:04:37.062209 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:04:42.055244 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 4.989 seconds
[0m10:04:42.057259 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002912283E930>]}
[0m10:04:42.058340 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 5.02s]
[0m10:04:42.059350 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m10:04:42.059350 [debug] [Thread-6 (]: Began running node model.data_pipeline.int_order_items_summary
[0m10:04:42.060350 [info ] [Thread-6 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m10:04:42.061550 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m10:04:42.061550 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m10:04:42.064550 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m10:04:42.065559 [debug] [Thread-6 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m10:04:42.067559 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m10:04:42.068559 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m10:04:42.069935 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m10:04:42.069935 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m10:04:44.771352 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.701 seconds
[0m10:04:44.773353 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029123AA7F80>]}
[0m10:04:44.773915 [info ] [Thread-6 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 2.71s]
[0m10:04:44.774433 [debug] [Thread-6 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m10:04:44.775376 [debug] [Thread-8 (]: Began running node model.data_pipeline.fct_orders
[0m10:04:44.775983 [info ] [Thread-8 (]: 5 of 5 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m10:04:44.775983 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m10:04:44.775983 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.fct_orders
[0m10:04:44.775983 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m10:04:44.775983 [debug] [Thread-8 (]: Began executing node model.data_pipeline.fct_orders
[0m10:04:44.782391 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m10:04:44.782391 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m10:04:44.782391 [debug] [Thread-8 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m10:04:44.785619 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m10:04:46.637803 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.853 seconds
[0m10:04:46.640269 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a2e38d7-6d78-4577-a8bf-96508f5e8b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029123AC0AD0>]}
[0m10:04:46.641268 [info ] [Thread-8 (]: 5 of 5 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 1.86s]
[0m10:04:46.642272 [debug] [Thread-8 (]: Finished running node model.data_pipeline.fct_orders
[0m10:04:46.643304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:46.644755 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:04:46.644755 [debug] [MainThread]: On list_dbt_db: Close
[0m10:04:46.811527 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:04:46.812535 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:04:47.400743 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m10:04:47.400743 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m10:04:47.859523 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m10:04:47.860522 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m10:04:48.297013 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m10:04:48.297013 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m10:04:48.646606 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m10:04:48.646606 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m10:04:48.872968 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m10:04:48.873975 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m10:04:49.206371 [info ] [MainThread]: 
[0m10:04:49.207369 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 15.70 seconds (15.70s).
[0m10:04:49.208374 [debug] [MainThread]: Command end result
[0m10:04:49.230655 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:04:49.232671 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:04:49.237671 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:04:49.238668 [info ] [MainThread]: 
[0m10:04:49.238668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:49.239667 [info ] [MainThread]: 
[0m10:04:49.239667 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m10:04:49.240669 [debug] [MainThread]: Command `dbt run` succeeded at 10:04:49.240669 after 17.30 seconds
[0m10:04:49.240669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911C3278C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911F1B7BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002911F1B7B00>]}
[0m10:04:49.241698 [debug] [MainThread]: Flushing usage events
[0m10:04:50.980713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:34.814201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB649AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB8E21340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB8E21D00>]}


============================== 10:13:34.818205 | ad7313c1-2e85-41dc-a359-456d21443f76 ==============================
[0m10:13:34.818205 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:13:34.819215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:13:35.309869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad7313c1-2e85-41dc-a359-456d21443f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBB739EE0>]}
[0m10:13:35.358710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad7313c1-2e85-41dc-a359-456d21443f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB96AB680>]}
[0m10:13:35.358710 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:13:35.695005 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:13:35.939187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m10:13:35.939187 [debug] [MainThread]: Partial parsing: added file: data_pipeline://tests\fct_orders_discount.sql
[0m10:13:35.939187 [debug] [MainThread]: Partial parsing: added file: data_pipeline://tests\fct_orders_date_valid.sql
[0m10:13:35.939187 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\generic_tests.yml
[0m10:13:36.273185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad7313c1-2e85-41dc-a359-456d21443f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBB97A6C0>]}
[0m10:13:36.351377 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:13:36.351377 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:13:36.397451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad7313c1-2e85-41dc-a359-456d21443f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBC0962D0>]}
[0m10:13:36.397451 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m10:13:36.398451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7313c1-2e85-41dc-a359-456d21443f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBBDF7410>]}
[0m10:13:36.400453 [info ] [MainThread]: 
[0m10:13:36.400453 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:13:36.401453 [info ] [MainThread]: 
[0m10:13:36.401453 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:13:36.406125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:13:36.505606 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:13:36.506608 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:13:36.506608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:37.487423 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.980 seconds
[0m10:13:37.489480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7313c1-2e85-41dc-a359-456d21443f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBC048890>]}
[0m10:13:37.493480 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m10:13:37.494756 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m10:13:37.494756 [debug] [Thread-3 (]: Began running node test.data_pipeline.fct_orders_discount
[0m10:13:37.495770 [debug] [Thread-4 (]: Began running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m10:13:37.495770 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_fct_orders_status_code__P__O__F .............. [RUN]
[0m10:13:37.495770 [debug] [Thread-5 (]: Began running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m10:13:37.496766 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m10:13:37.496766 [info ] [Thread-2 (]: 2 of 9 START test fct_orders_date_valid ........................................ [RUN]
[0m10:13:37.496766 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m10:13:37.497766 [debug] [Thread-8 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m10:13:37.497766 [info ] [Thread-3 (]: 3 of 9 START test fct_orders_discount .......................................... [RUN]
[0m10:13:37.497766 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m10:13:37.498936 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048'
[0m10:13:37.498936 [info ] [Thread-4 (]: 4 of 9 START test not_null_fct_orders_order_key ................................ [RUN]
[0m10:13:37.498936 [info ] [Thread-5 (]: 5 of 9 START test relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m10:13:37.500157 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_date_valid'
[0m10:13:37.500157 [info ] [Thread-6 (]: 6 of 9 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m10:13:37.501205 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m10:13:37.500157 [info ] [Thread-7 (]: 7 of 9 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m10:13:37.501205 [info ] [Thread-8 (]: 8 of 9 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m10:13:37.502205 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m10:13:37.501205 [info ] [Thread-9 (]: 9 of 9 START test unique_fct_orders_order_key .................................. [RUN]
[0m10:13:37.502205 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15'
[0m10:13:37.503359 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce'
[0m10:13:37.503359 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m10:13:37.503359 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m10:13:37.503359 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m10:13:37.505733 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m10:13:37.505733 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m10:13:37.513079 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m10:13:37.514081 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273'
[0m10:13:37.514081 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m10:13:37.515092 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m10:13:37.517080 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m10:13:37.517080 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m10:13:37.519225 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m10:13:37.519225 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m10:13:37.520234 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m10:13:37.520234 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m10:13:37.527829 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m10:13:37.531830 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m10:13:37.535828 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m10:13:37.540562 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m10:13:37.541679 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m10:13:37.546802 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m10:13:37.549806 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m10:13:37.550805 [debug] [Thread-3 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m10:13:37.550805 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m10:13:37.573594 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m10:13:37.576603 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m10:13:37.576603 [debug] [Thread-5 (]: Began executing node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m10:13:37.579603 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m10:13:37.579603 [debug] [Thread-4 (]: Began executing node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m10:13:37.580606 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m10:13:37.580606 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m10:13:37.583919 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m10:13:37.583919 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m10:13:37.584922 [debug] [Thread-8 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m10:13:37.585921 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m10:13:37.590098 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m10:13:37.591097 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m10:13:37.594095 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m10:13:37.595102 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m10:13:37.597095 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m10:13:37.600155 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m10:13:37.601158 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m10:13:37.602157 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_orders
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"} */
[0m10:13:37.602157 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m10:13:37.603162 [debug] [Thread-3 (]: On test.data_pipeline.fct_orders_discount: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    item_discount_amount > 0
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
[0m10:13:37.604314 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m10:13:37.605513 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m10:13:37.605513 [debug] [Thread-5 (]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_orders
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"} */
[0m10:13:37.606660 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m10:13:37.607872 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:13:37.607872 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_date_valid: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
[0m10:13:37.608888 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m10:13:37.609883 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:13:37.609883 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m10:13:37.610887 [debug] [Thread-4 (]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_key
from dbt_db.dbt_schema.fct_orders
where order_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"} */
[0m10:13:37.610887 [debug] [Thread-9 (]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_orders
where order_key is not null
group by order_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"} */
[0m10:13:37.611884 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m10:13:37.611884 [debug] [Thread-7 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
[0m10:13:37.612964 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:13:37.613963 [debug] [Thread-8 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
[0m10:13:37.615303 [debug] [Thread-6 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
[0m10:13:37.617305 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:13:37.617305 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m10:13:37.618305 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m10:13:37.619303 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m10:13:37.621299 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m10:13:38.586679 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m10:13:38.603169 [info ] [Thread-9 (]: 9 of 9 PASS unique_fct_orders_order_key ........................................ [[32mPASS[0m in 1.09s]
[0m10:13:38.604168 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m10:13:38.870693 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m10:13:38.872692 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.255 seconds
[0m10:13:38.872692 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.252 seconds
[0m10:13:38.873692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.266 seconds
[0m10:13:38.875692 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.263 seconds
[0m10:13:38.874691 [info ] [Thread-3 (]: 3 of 9 PASS fct_orders_discount ................................................ [[32mPASS[0m in 1.37s]
[0m10:13:38.877692 [info ] [Thread-4 (]: 4 of 9 PASS not_null_fct_orders_order_key ...................................... [[32mPASS[0m in 1.37s]
[0m10:13:38.878692 [info ] [Thread-6 (]: 6 of 9 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 1.38s]
[0m10:13:38.881781 [debug] [Thread-3 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m10:13:38.880772 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_fct_orders_status_code__P__O__F .................... [[32mPASS[0m in 1.38s]
[0m10:13:38.882782 [debug] [Thread-4 (]: Finished running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m10:13:38.881781 [info ] [Thread-2 (]: 2 of 9 PASS fct_orders_date_valid .............................................. [[32mPASS[0m in 1.38s]
[0m10:13:38.883784 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m10:13:38.883784 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m10:13:38.884782 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m10:13:39.034736 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.416 seconds
[0m10:13:39.036735 [info ] [Thread-7 (]: 7 of 9 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 1.53s]
[0m10:13:39.036735 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m10:13:39.200672 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.581 seconds
[0m10:13:39.203016 [info ] [Thread-8 (]: 8 of 9 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 1.70s]
[0m10:13:39.203931 [debug] [Thread-8 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m10:13:39.282104 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.671 seconds
[0m10:13:39.284131 [info ] [Thread-5 (]: 5 of 9 PASS relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [[32mPASS[0m in 1.78s]
[0m10:13:39.285432 [debug] [Thread-5 (]: Finished running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m10:13:39.287412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:39.287412 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:13:39.288413 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:13:39.776054 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048' was left open.
[0m10:13:39.776054 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: Close
[0m10:13:40.105757 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m10:13:40.105757 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m10:13:40.434501 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m10:13:40.434501 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m10:13:40.764996 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15' was left open.
[0m10:13:40.764996 [debug] [MainThread]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: Close
[0m10:13:41.174014 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' was left open.
[0m10:13:41.175443 [debug] [MainThread]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: Close
[0m10:13:41.428552 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m10:13:41.429554 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m10:13:41.758207 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m10:13:41.759208 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m10:13:42.251195 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m10:13:42.252194 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m10:13:42.654616 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273' was left open.
[0m10:13:42.656084 [debug] [MainThread]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: Close
[0m10:13:42.902894 [info ] [MainThread]: 
[0m10:13:42.903922 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 6.50 seconds (6.50s).
[0m10:13:42.905561 [debug] [MainThread]: Command end result
[0m10:13:42.928676 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:13:42.930168 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:13:42.936754 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:13:42.937782 [info ] [MainThread]: 
[0m10:13:42.937782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:42.938782 [info ] [MainThread]: 
[0m10:13:42.938782 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m10:13:42.939781 [debug] [MainThread]: Command `dbt test` succeeded at 10:13:42.939781 after 8.30 seconds
[0m10:13:42.940782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB8A1FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB90244D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB9025490>]}
[0m10:13:42.940782 [debug] [MainThread]: Flushing usage events
[0m10:13:45.299863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:08.494960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013953414DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013953104470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013952BFB080>]}


============================== 22:53:08.501558 | 7f0ba763-fcac-4062-91b5-cd8a3f7b95e8 ==============================
[0m22:53:08.501558 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:53:08.502212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\Airflow-Data_Pipeline\\dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:53:08.527953 [info ] [MainThread]: dbt version: 1.10.5
[0m22:53:08.528953 [info ] [MainThread]: python version: 3.12.6
[0m22:53:08.529955 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m22:53:08.529955 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m22:53:08.530953 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles
[0m22:53:08.530953 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles\profiles.yml
[0m22:53:08.530953 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m22:53:08.651886 [info ] [MainThread]: Configuration:
[0m22:53:08.652883 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m22:53:08.653881 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:53:08.653881 [info ] [MainThread]: Required dependencies:
[0m22:53:08.653881 [debug] [MainThread]: Executing "git --help"
[0m22:53:08.716037 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:53:08.717026 [debug] [MainThread]: STDERR: "b''"
[0m22:53:08.717026 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:53:08.718292 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:53:08.719292 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:53:08.719292 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m22:53:08.720786 [debug] [MainThread]: Command `dbt debug` failed at 22:53:08.720786 after 0.45 seconds
[0m22:53:08.720786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001395353F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139530631D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013953060650>]}
[0m22:53:08.721796 [debug] [MainThread]: Flushing usage events
[0m22:53:11.062896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:52.469543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C12A583B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C107C3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1197E060>]}


============================== 22:55:52.479096 | 7af43e2e-7142-4faa-99a6-06dace6d938c ==============================
[0m22:55:52.479096 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:55:52.480100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:55:52.513744 [info ] [MainThread]: dbt version: 1.10.5
[0m22:55:52.514744 [info ] [MainThread]: python version: 3.12.6
[0m22:55:52.515748 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m22:55:52.516416 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m22:55:53.193935 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m22:55:53.194479 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m22:55:53.195490 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m22:55:53.197503 [info ] [MainThread]: adapter type: snowflake
[0m22:55:53.197503 [info ] [MainThread]: adapter version: 1.10.0
[0m22:55:53.361037 [info ] [MainThread]: Configuration:
[0m22:55:53.364567 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:55:53.364567 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:55:53.366070 [info ] [MainThread]: Required dependencies:
[0m22:55:53.366070 [debug] [MainThread]: Executing "git --help"
[0m22:55:53.428101 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:55:53.428101 [debug] [MainThread]: STDERR: "b''"
[0m22:55:53.428101 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:55:53.429653 [info ] [MainThread]: Connection:
[0m22:55:53.429653 [info ] [MainThread]:   account: YFCCUOK-SC28960
[0m22:55:53.431232 [info ] [MainThread]:   user: Pranjal007
[0m22:55:53.431232 [info ] [MainThread]:   database: dbt_db
[0m22:55:53.432812 [info ] [MainThread]:   warehouse: dbt_wh
[0m22:55:53.432812 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m22:55:53.432812 [info ] [MainThread]:   schema: dbt_schema
[0m22:55:53.432812 [info ] [MainThread]:   authenticator: None
[0m22:55:53.432812 [info ] [MainThread]:   oauth_client_id: None
[0m22:55:53.436751 [info ] [MainThread]:   query_tag: None
[0m22:55:53.436751 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:55:53.437394 [info ] [MainThread]:   host: None
[0m22:55:53.437394 [info ] [MainThread]:   port: None
[0m22:55:53.437394 [info ] [MainThread]:   proxy_host: None
[0m22:55:53.439639 [info ] [MainThread]:   proxy_port: None
[0m22:55:53.439639 [info ] [MainThread]:   protocol: None
[0m22:55:53.439639 [info ] [MainThread]:   connect_retries: 1
[0m22:55:53.441425 [info ] [MainThread]:   connect_timeout: None
[0m22:55:53.441425 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:55:53.442707 [info ] [MainThread]:   retry_all: False
[0m22:55:53.442707 [info ] [MainThread]:   insecure_mode: False
[0m22:55:53.442707 [info ] [MainThread]:   reuse_connections: True
[0m22:55:53.442707 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m22:55:53.446071 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:55:53.976375 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:55:54.180443 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:55:54.180443 [debug] [MainThread]: On debug: select 1 as id
[0m22:55:54.180443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:56.824128 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.643 seconds
[0m22:55:56.825657 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:55:56.826673 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:55:56.828668 [debug] [MainThread]: Command `dbt debug` succeeded at 22:55:56.827669 after 4.64 seconds
[0m22:55:56.828668 [debug] [MainThread]: Connection 'debug' was left open.
[0m22:55:56.829669 [debug] [MainThread]: On debug: Close
[0m22:55:57.070077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C11ADBB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C15571E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C14F876B0>]}
[0m22:55:57.070637 [debug] [MainThread]: Flushing usage events
[0m22:55:58.541696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:32.695771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B45EEDB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B45FBB170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B45F66780>]}


============================== 19:18:32.705645 | 5bec733f-b2ff-492e-9fc0-4ea0ee4573e5 ==============================
[0m19:18:32.705645 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:18:32.709823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\Airflow-Data_Pipeline\\dbt_profiles', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:18:32.756433 [info ] [MainThread]: dbt version: 1.10.5
[0m19:18:32.756433 [info ] [MainThread]: python version: 3.12.6
[0m19:18:32.756433 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m19:18:32.756433 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m19:18:32.761139 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles
[0m19:18:32.761139 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles\profiles.yml
[0m19:18:32.761139 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m19:18:32.908336 [info ] [MainThread]: Configuration:
[0m19:18:32.908336 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m19:18:32.908336 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:18:32.908336 [info ] [MainThread]: Required dependencies:
[0m19:18:32.911613 [debug] [MainThread]: Executing "git --help"
[0m19:18:32.948516 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:18:32.948516 [debug] [MainThread]: STDERR: "b''"
[0m19:18:32.950126 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:18:32.950126 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:18:32.950126 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:18:32.951788 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m19:18:32.953405 [debug] [MainThread]: Command `dbt debug` failed at 19:18:32.952812 after 0.42 seconds
[0m19:18:32.953405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B45EEDB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B45361C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B43790B30>]}
[0m19:18:32.953405 [debug] [MainThread]: Flushing usage events
[0m19:18:34.780314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:20:36.643326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE2C82960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE4D7F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE4B37260>]}


============================== 19:20:36.649119 | d893433a-9e52-4a25-879c-6fbea80f1c62 ==============================
[0m19:20:36.649119 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:20:36.657069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\Airflow-Data_Pipeline\\dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:20:36.703575 [info ] [MainThread]: dbt version: 1.10.5
[0m19:20:36.704622 [info ] [MainThread]: python version: 3.12.6
[0m19:20:36.706471 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m19:20:36.707692 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m19:20:36.707692 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles
[0m19:20:36.709903 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles\profiles.yml
[0m19:20:36.710950 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m19:20:36.941607 [info ] [MainThread]: Configuration:
[0m19:20:36.941607 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m19:20:36.941607 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:20:36.941607 [info ] [MainThread]: Required dependencies:
[0m19:20:36.941607 [debug] [MainThread]: Executing "git --help"
[0m19:20:36.998554 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:20:36.998554 [debug] [MainThread]: STDERR: "b''"
[0m19:20:36.998554 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:20:37.003213 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:20:37.003213 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:20:37.005223 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\lenovo\Airflow-Data_Pipeline\dbt_profiles\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m19:20:37.007233 [debug] [MainThread]: Command `dbt debug` failed at 19:20:37.007233 after 0.60 seconds
[0m19:20:37.007233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE52C6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE522D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE4C31490>]}
[0m19:20:37.007233 [debug] [MainThread]: Flushing usage events
[0m19:20:39.006579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:57.741890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A4F34B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A51F98860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A51F9B0B0>]}


============================== 19:21:57.749678 | 711240d6-61c8-4b74-8a3d-10a6cc2aeed5 ==============================
[0m19:21:57.749678 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:21:57.749678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:21:57.795547 [info ] [MainThread]: dbt version: 1.10.5
[0m19:21:57.797071 [info ] [MainThread]: python version: 3.12.6
[0m19:21:57.798083 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m19:21:57.798083 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m19:21:59.833844 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m19:21:59.835337 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m19:21:59.836358 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m19:21:59.838632 [info ] [MainThread]: adapter type: snowflake
[0m19:21:59.840139 [info ] [MainThread]: adapter version: 1.10.0
[0m19:22:00.112586 [info ] [MainThread]: Configuration:
[0m19:22:00.113588 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:22:00.114589 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:22:00.115589 [info ] [MainThread]: Required dependencies:
[0m19:22:00.116590 [debug] [MainThread]: Executing "git --help"
[0m19:22:00.163150 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:22:00.164150 [debug] [MainThread]: STDERR: "b''"
[0m19:22:00.165150 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:22:00.167150 [info ] [MainThread]: Connection:
[0m19:22:00.168150 [info ] [MainThread]:   account: YFCCUOK-SC28960
[0m19:22:00.169150 [info ] [MainThread]:   user: Pranjal007
[0m19:22:00.170159 [info ] [MainThread]:   database: dbt_db
[0m19:22:00.171155 [info ] [MainThread]:   warehouse: dbt_wh
[0m19:22:00.172160 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:22:00.173152 [info ] [MainThread]:   schema: dbt_schema
[0m19:22:00.174469 [info ] [MainThread]:   authenticator: None
[0m19:22:00.175854 [info ] [MainThread]:   oauth_client_id: None
[0m19:22:00.176853 [info ] [MainThread]:   query_tag: None
[0m19:22:00.176853 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:22:00.179400 [info ] [MainThread]:   host: None
[0m19:22:00.180403 [info ] [MainThread]:   port: None
[0m19:22:00.181756 [info ] [MainThread]:   proxy_host: None
[0m19:22:00.181756 [info ] [MainThread]:   proxy_port: None
[0m19:22:00.181756 [info ] [MainThread]:   protocol: None
[0m19:22:00.181756 [info ] [MainThread]:   connect_retries: 1
[0m19:22:00.181756 [info ] [MainThread]:   connect_timeout: None
[0m19:22:00.181756 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:22:00.181756 [info ] [MainThread]:   retry_all: False
[0m19:22:00.181756 [info ] [MainThread]:   insecure_mode: False
[0m19:22:00.189909 [info ] [MainThread]:   reuse_connections: True
[0m19:22:00.190421 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m19:22:00.192433 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:22:01.216789 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:22:06.563401 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:22:06.579401 [debug] [MainThread]: On debug: select 1 as id
[0m19:22:06.579401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:09.154557 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.574 seconds
[0m19:22:09.156640 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:22:09.157659 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:22:09.159646 [debug] [MainThread]: Command `dbt debug` succeeded at 19:22:09.159646 after 11.74 seconds
[0m19:22:09.160644 [debug] [MainThread]: Connection 'debug' was left open.
[0m19:22:09.160644 [debug] [MainThread]: On debug: Close
[0m19:22:09.426485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A524FF4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A548B2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A548B2C60>]}
[0m19:22:09.427483 [debug] [MainThread]: Flushing usage events
[0m19:22:10.658302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:07.084376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631DBE3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016320833EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163208328D0>]}


============================== 19:23:07.084376 | 7b681b1e-2d4a-4bd0-928b-b3529f2e363b ==============================
[0m19:23:07.084376 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:23:07.084376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_orders.sql+', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:23:07.601954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b681b1e-2d4a-4bd0-928b-b3529f2e363b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016322A23FB0>]}
[0m19:23:07.646575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b681b1e-2d4a-4bd0-928b-b3529f2e363b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016322AC1970>]}
[0m19:23:07.646575 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:23:07.952976 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:23:09.430459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 50 files changed.
[0m19:23:09.430459 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\width_bucket.sql
[0m19:23:09.431460 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_table_types_sql.sql
[0m19:23:09.431460 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\sequential_values.sql
[0m19:23:09.432460 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck_table.sql
[0m19:23:09.432460 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\slugify.sql
[0m19:23:09.432460 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\union.sql
[0m19:23:09.432460 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_pattern.sql
[0m19:23:09.433465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equality.sql
[0m19:23:09.433465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_parameter.sql
[0m19:23:09.433465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\expression_is_true.sql
[0m19:23:09.434465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\at_least_one.sql
[0m19:23:09.434465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_relation.sql
[0m19:23:09.434465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_subtract.sql
[0m19:23:09.435465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_column_values.sql
[0m19:23:09.435465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\groupby.sql
[0m19:23:09.435465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_log_format.sql
[0m19:23:09.436465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_surrogate_key.sql
[0m19:23:09.436465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\unique_combination_of_columns.sql
[0m19:23:09.436465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\cardinality_equality.sql
[0m19:23:09.437465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_path.sql
[0m19:23:09.437465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_prefix.sql
[0m19:23:09.437465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_prefix_sql.sql
[0m19:23:09.438465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\pivot.sql
[0m19:23:09.438465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\date_spine.sql
[0m19:23:09.438465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_empty_string.sql
[0m19:23:09.439465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_ephemeral.sql
[0m19:23:09.439465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equal_rowcount.sql
[0m19:23:09.439465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_add.sql
[0m19:23:09.440465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\recency.sql
[0m19:23:09.440465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_query_results_as_dict.sql
[0m19:23:09.440465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_filtered_columns_in_relation.sql
[0m19:23:09.440465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_constant.sql
[0m19:23:09.441465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\fewer_rows_than.sql
[0m19:23:09.441465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\surrogate_key.sql
[0m19:23:09.441465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_accepted_values.sql
[0m19:23:09.442465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_divide.sql
[0m19:23:09.442465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\relationships_where.sql
[0m19:23:09.442465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\mutually_exclusive_ranges.sql
[0m19:23:09.443465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_host.sql
[0m19:23:09.443465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\deduplicate.sql
[0m19:23:09.443465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\unpivot.sql
[0m19:23:09.443465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck.sql
[0m19:23:09.444465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_time.sql
[0m19:23:09.444465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_single_value.sql
[0m19:23:09.444465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\log_info.sql
[0m19:23:09.445465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_null_proportion.sql
[0m19:23:09.445465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_series.sql
[0m19:23:09.445465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\haversine_distance.sql
[0m19:23:09.446465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\accepted_range.sql
[0m19:23:09.446465 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_pattern_sql.sql
[0m19:23:10.022795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b681b1e-2d4a-4bd0-928b-b3529f2e363b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001632360D7C0>]}
[0m19:23:10.098297 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:23:10.118494 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:23:10.141923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b681b1e-2d4a-4bd0-928b-b3529f2e363b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016323396C00>]}
[0m19:23:10.141923 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:23:10.142931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b681b1e-2d4a-4bd0-928b-b3529f2e363b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016323531340>]}
[0m19:23:10.144936 [info ] [MainThread]: 
[0m19:23:10.145941 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:23:10.145941 [info ] [MainThread]: 
[0m19:23:10.146937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:10.147937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m19:23:10.217632 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m19:23:10.218636 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m19:23:10.218636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:11.606882 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.388 seconds
[0m19:23:11.614236 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:23:11.625467 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:23:11.625467 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:23:11.625467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:12.543594 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.918 seconds
[0m19:23:12.545608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b681b1e-2d4a-4bd0-928b-b3529f2e363b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163233B3920>]}
[0m19:23:12.554995 [debug] [Thread-1 (]: Began running node model.data_pipeline.fct_orders
[0m19:23:12.554995 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m19:23:12.554995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m19:23:12.554995 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.fct_orders
[0m19:23:12.561783 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m19:23:12.561783 [debug] [Thread-1 (]: Began executing node model.data_pipeline.fct_orders
[0m19:23:12.579765 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m19:23:12.579765 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m19:23:12.579765 [debug] [Thread-1 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m19:23:12.579765 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:14.933831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.342 seconds
[0m19:23:14.958346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b681b1e-2d4a-4bd0-928b-b3529f2e363b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163201952B0>]}
[0m19:23:14.958346 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 2.40s]
[0m19:23:14.959384 [debug] [Thread-1 (]: Finished running node model.data_pipeline.fct_orders
[0m19:23:14.960372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:14.960372 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m19:23:14.961655 [debug] [MainThread]: On list_dbt_db: Close
[0m19:23:15.217386 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:23:15.218392 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:23:15.576206 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m19:23:15.577207 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m19:23:15.787287 [info ] [MainThread]: 
[0m19:23:15.787287 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m19:23:15.788288 [debug] [MainThread]: Command end result
[0m19:23:15.809287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:23:15.811288 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:23:15.816288 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:23:15.816288 [info ] [MainThread]: 
[0m19:23:15.817288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:15.817288 [info ] [MainThread]: 
[0m19:23:15.818594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:23:15.818594 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:15.818594 after 8.83 seconds
[0m19:23:15.819594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163203E0BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631DB57CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001632012D6A0>]}
[0m19:23:15.819594 [debug] [MainThread]: Flushing usage events
[0m19:23:17.123326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:28.029040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E386AF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3646A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E38B95160>]}


============================== 19:23:28.034048 | e7036eb6-5908-4c1a-a2c6-3e62ee01145d ==============================
[0m19:23:28.034048 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:23:28.034048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select +fct_orders.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:28.480166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3AD956D0>]}
[0m19:23:28.535431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3A928C20>]}
[0m19:23:28.535431 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:23:28.796876 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:23:29.028807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:29.030813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:29.069644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3AF7A1E0>]}
[0m19:23:29.145736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:23:29.147741 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:23:29.166605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3B2F33E0>]}
[0m19:23:29.166605 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:23:29.169916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E38D00D10>]}
[0m19:23:29.170944 [info ] [MainThread]: 
[0m19:23:29.170944 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:23:29.170944 [info ] [MainThread]: 
[0m19:23:29.170944 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:29.175637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m19:23:29.235605 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m19:23:29.235605 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m19:23:29.235605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:31.211961 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.967 seconds
[0m19:23:31.213962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:23:31.224961 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:23:31.225962 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:23:31.225962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:32.026512 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.801 seconds
[0m19:23:32.030677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3AB91760>]}
[0m19:23:32.035893 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m19:23:32.035893 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m19:23:32.035893 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m19:23:32.039123 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m19:23:32.037893 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m19:23:32.039123 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m19:23:32.040197 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m19:23:32.047235 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m19:23:32.055749 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m19:23:32.057747 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m19:23:32.058779 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m19:23:32.079195 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m19:23:32.084199 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m19:23:32.086217 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m19:23:32.087201 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m19:23:32.088690 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m19:23:32.088690 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m19:23:32.089926 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m19:23:32.089926 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:23:32.089926 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:32.752379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m19:23:32.752379 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m19:23:32.800038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E38014B60>]}
[0m19:23:32.800038 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3AF7BEC0>]}
[0m19:23:32.800038 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 0.75s]
[0m19:23:32.800038 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m19:23:32.800038 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 0.76s]
[0m19:23:32.800038 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m19:23:32.800038 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m19:23:32.800038 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m19:23:32.800038 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m19:23:32.800038 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m19:23:32.800038 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m19:23:32.800038 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m19:23:32.818678 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m19:23:32.832198 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m19:23:32.832198 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m19:23:32.832198 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:23:37.702853 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 4.875 seconds
[0m19:23:37.710539 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3AE436B0>]}
[0m19:23:37.710539 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 4.91s]
[0m19:23:37.710539 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m19:23:37.710539 [debug] [Thread-6 (]: Began running node model.data_pipeline.int_order_items_summary
[0m19:23:37.710539 [info ] [Thread-6 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m19:23:37.710539 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m19:23:37.710539 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m19:23:37.715708 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m19:23:37.715708 [debug] [Thread-6 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m19:23:37.720544 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m19:23:37.720544 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m19:23:37.720544 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m19:23:37.720544 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m19:23:39.317414 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.594 seconds
[0m19:23:39.319414 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3B9C7EF0>]}
[0m19:23:39.319414 [info ] [Thread-6 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 1.61s]
[0m19:23:39.320178 [debug] [Thread-6 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m19:23:39.321458 [debug] [Thread-8 (]: Began running node model.data_pipeline.fct_orders
[0m19:23:39.321458 [info ] [Thread-8 (]: 5 of 5 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m19:23:39.322457 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m19:23:39.322457 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.fct_orders
[0m19:23:39.325557 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m19:23:39.326556 [debug] [Thread-8 (]: Began executing node model.data_pipeline.fct_orders
[0m19:23:39.328642 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m19:23:39.330643 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m19:23:39.330643 [debug] [Thread-8 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m19:23:39.330643 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m19:23:40.969371 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.639 seconds
[0m19:23:40.972355 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7036eb6-5908-4c1a-a2c6-3e62ee01145d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3B351970>]}
[0m19:23:40.972355 [info ] [Thread-8 (]: 5 of 5 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 1.65s]
[0m19:23:40.973343 [debug] [Thread-8 (]: Finished running node model.data_pipeline.fct_orders
[0m19:23:40.974452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:40.975786 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m19:23:40.975786 [debug] [MainThread]: On list_dbt_db: Close
[0m19:23:41.603906 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:23:41.603906 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:23:41.992551 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m19:23:41.994062 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m19:23:42.481206 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m19:23:42.481206 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m19:23:42.726945 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m19:23:42.727949 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m19:23:42.988235 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m19:23:42.988235 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m19:23:43.303234 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m19:23:43.304225 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m19:23:43.549778 [info ] [MainThread]: 
[0m19:23:43.550778 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 14.38 seconds (14.38s).
[0m19:23:43.552778 [debug] [MainThread]: Command end result
[0m19:23:43.576294 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:23:43.578478 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:23:43.583624 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:23:43.584625 [info ] [MainThread]: 
[0m19:23:43.584625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:43.584625 [info ] [MainThread]: 
[0m19:23:43.585624 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:23:43.586624 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:43.585624 after 15.66 seconds
[0m19:23:43.586624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E383EF0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E37FDF830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E37FAE1B0>]}
[0m19:23:43.586624 [debug] [MainThread]: Flushing usage events
[0m19:23:45.026919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:24:13.223363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48D4451C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48D53FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48D201850>]}


============================== 19:24:13.232951 | 1b4ee073-f135-4f11-bb4c-e94f9734aa58 ==============================
[0m19:24:13.232951 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:24:13.232951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select +fct_orders', 'send_anonymous_usage_stats': 'True'}
[0m19:24:13.656176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48DDCF380>]}
[0m19:24:13.705790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48DF9BE90>]}
[0m19:24:13.705790 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:24:13.959015 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:24:14.156406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:14.156406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:14.209154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F490248DA0>]}
[0m19:24:14.290440 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:24:14.292441 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:24:14.313439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F490654620>]}
[0m19:24:14.313439 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:24:14.314441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49024A090>]}
[0m19:24:14.315910 [info ] [MainThread]: 
[0m19:24:14.315910 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:24:14.317027 [info ] [MainThread]: 
[0m19:24:14.317027 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:24:14.321028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m19:24:14.390012 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m19:24:14.390012 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m19:24:14.391012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:15.707759 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.317 seconds
[0m19:24:15.711153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:24:15.722659 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:24:15.722659 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:24:15.723658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:16.487148 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.772 seconds
[0m19:24:16.487148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4909A2B10>]}
[0m19:24:16.503243 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m19:24:16.503243 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m19:24:16.503243 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m19:24:16.503243 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m19:24:16.503243 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m19:24:16.503243 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m19:24:16.503243 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m19:24:16.523318 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m19:24:16.523318 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m19:24:16.523318 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m19:24:16.523318 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m19:24:16.523318 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m19:24:16.553093 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m19:24:16.553093 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m19:24:16.553093 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m19:24:16.553093 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m19:24:16.558486 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m19:24:16.558486 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:24:16.558486 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m19:24:16.558486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:17.348478 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m19:24:17.364336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48AE4A510>]}
[0m19:24:17.364336 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 0.86s]
[0m19:24:17.364336 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m19:24:17.454102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m19:24:17.454102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F490BA4DA0>]}
[0m19:24:17.454102 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 0.95s]
[0m19:24:17.463741 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m19:24:17.464772 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m19:24:17.464772 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m19:24:17.465763 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m19:24:17.466763 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m19:24:17.470763 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m19:24:17.471763 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m19:24:17.487437 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m19:24:17.487437 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m19:24:17.487437 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m19:24:17.487437 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:24:22.387736 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 4.895 seconds
[0m19:24:22.390238 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F490C857F0>]}
[0m19:24:22.391237 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 4.92s]
[0m19:24:22.392238 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m19:24:22.393236 [debug] [Thread-6 (]: Began running node model.data_pipeline.int_order_items_summary
[0m19:24:22.393236 [info ] [Thread-6 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m19:24:22.394236 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m19:24:22.394236 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m19:24:22.397236 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m19:24:22.398236 [debug] [Thread-6 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m19:24:22.400435 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m19:24:22.401435 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m19:24:22.401435 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m19:24:22.402796 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m19:24:24.067369 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.664 seconds
[0m19:24:24.069417 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F490C24EF0>]}
[0m19:24:24.069417 [info ] [Thread-6 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 1.67s]
[0m19:24:24.070371 [debug] [Thread-6 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m19:24:24.071407 [debug] [Thread-8 (]: Began running node model.data_pipeline.fct_orders
[0m19:24:24.071407 [info ] [Thread-8 (]: 5 of 5 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m19:24:24.072626 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m19:24:24.072626 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.fct_orders
[0m19:24:24.075625 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m19:24:24.076626 [debug] [Thread-8 (]: Began executing node model.data_pipeline.fct_orders
[0m19:24:24.079627 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m19:24:24.080626 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m19:24:24.080626 [debug] [Thread-8 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m19:24:24.081626 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m19:24:25.785879 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.704 seconds
[0m19:24:25.788091 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4ee073-f135-4f11-bb4c-e94f9734aa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F490CB03B0>]}
[0m19:24:25.788091 [info ] [Thread-8 (]: 5 of 5 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 1.71s]
[0m19:24:25.789091 [debug] [Thread-8 (]: Finished running node model.data_pipeline.fct_orders
[0m19:24:25.790091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:25.790091 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m19:24:25.791389 [debug] [MainThread]: On list_dbt_db: Close
[0m19:24:26.120954 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:24:26.120954 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:24:26.446695 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m19:24:26.446695 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m19:24:26.620277 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m19:24:26.620277 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m19:24:26.940324 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m19:24:26.941323 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m19:24:27.351874 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m19:24:27.352888 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m19:24:27.679956 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m19:24:27.679956 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m19:24:28.073540 [info ] [MainThread]: 
[0m19:24:28.074785 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 13.76 seconds (13.76s).
[0m19:24:28.075546 [debug] [MainThread]: Command end result
[0m19:24:28.101391 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:24:28.103391 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:24:28.109680 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:24:28.109680 [info ] [MainThread]: 
[0m19:24:28.110682 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:28.110682 [info ] [MainThread]: 
[0m19:24:28.111680 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:24:28.111680 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:28.111680 after 14.99 seconds
[0m19:24:28.112680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48DE67BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48D19EF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48D19FBC0>]}
[0m19:24:28.112680 [debug] [MainThread]: Flushing usage events
[0m19:24:30.252989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:01.042802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014903841550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014906E9FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014906E19370>]}


============================== 19:40:01.049614 | 11108df5-a748-4ae1-8817-9ddbd5bca7c1 ==============================
[0m19:40:01.049614 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:40:01.049614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --selector staging_models', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:40:01.559232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11108df5-a748-4ae1-8817-9ddbd5bca7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014909663230>]}
[0m19:40:01.611966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11108df5-a748-4ae1-8817-9ddbd5bca7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014907133D70>]}
[0m19:40:01.613701 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:40:01.900432 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:40:02.122071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:02.123071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:02.165463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11108df5-a748-4ae1-8817-9ddbd5bca7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149098FCB60>]}
[0m19:40:02.244560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:40:02.244560 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:40:02.276184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11108df5-a748-4ae1-8817-9ddbd5bca7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014909765940>]}
[0m19:40:02.276184 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:40:02.276184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11108df5-a748-4ae1-8817-9ddbd5bca7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014909B68380>]}
[0m19:40:02.282609 [info ] [MainThread]: 
[0m19:40:02.282609 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:40:02.282609 [info ] [MainThread]: 
[0m19:40:02.282609 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:40:02.288116 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m19:40:02.360538 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m19:40:02.360538 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m19:40:02.360538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:04.008855 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.654 seconds
[0m19:40:04.008855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:40:04.025884 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:40:04.025884 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:40:04.025884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:04.673234 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.644 seconds
[0m19:40:04.677371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11108df5-a748-4ae1-8817-9ddbd5bca7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149044E4D70>]}
[0m19:40:04.681780 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m19:40:04.682981 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m19:40:04.682981 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m19:40:04.685996 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m19:40:04.684990 [info ] [Thread-2 (]: 2 of 2 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m19:40:04.686994 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m19:40:04.686994 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m19:40:04.693994 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m19:40:04.704001 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m19:40:04.706996 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m19:40:04.708002 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m19:40:04.708002 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m19:40:04.734097 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m19:40:04.740109 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m19:40:04.742109 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m19:40:04.742109 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m19:40:04.743108 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m19:40:04.743108 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m19:40:04.743108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:40:04.744110 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:40:05.285396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m19:40:05.307858 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m19:40:05.308858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11108df5-a748-4ae1-8817-9ddbd5bca7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149043FA600>]}
[0m19:40:05.309849 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11108df5-a748-4ae1-8817-9ddbd5bca7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001490A16C1A0>]}
[0m19:40:05.311206 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 0.62s]
[0m19:40:05.312206 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m19:40:05.311206 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 0.62s]
[0m19:40:05.313354 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m19:40:05.314858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:05.314858 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m19:40:05.314858 [debug] [MainThread]: On list_dbt_db: Close
[0m19:40:05.497765 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:40:05.498765 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:40:05.737137 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m19:40:05.737649 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m19:40:05.984581 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m19:40:05.984581 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m19:40:06.335314 [info ] [MainThread]: 
[0m19:40:06.335314 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m19:40:06.339478 [debug] [MainThread]: Command end result
[0m19:40:06.359422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:40:06.363483 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:40:06.363483 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:40:06.363483 [info ] [MainThread]: 
[0m19:40:06.363483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:06.363483 [info ] [MainThread]: 
[0m19:40:06.363483 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m19:40:06.363483 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:06.363483 after 5.45 seconds
[0m19:40:06.363483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149041E7E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014906ED34D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014906ED26C0>]}
[0m19:40:06.372696 [debug] [MainThread]: Flushing usage events
[0m19:40:08.605507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:14.059810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71437CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71437F080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71437E0F0>]}


============================== 19:40:14.059810 | 7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca ==============================
[0m19:40:14.059810 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:40:14.059810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --selector marts_models', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:40:14.544929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A716B72BD0>]}
[0m19:40:14.610604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A715C370E0>]}
[0m19:40:14.612605 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:40:14.892668 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:40:15.108698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:15.108698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:15.151697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A716AF9040>]}
[0m19:40:15.245216 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:40:15.248217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:40:15.271363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A717088B60>]}
[0m19:40:15.272361 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:40:15.272361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7170344A0>]}
[0m19:40:15.275372 [info ] [MainThread]: 
[0m19:40:15.275372 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:40:15.276368 [info ] [MainThread]: 
[0m19:40:15.277368 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:40:15.280884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m19:40:15.353333 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m19:40:15.354332 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m19:40:15.354332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:17.682182 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.336 seconds
[0m19:40:17.682182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:40:17.696153 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:40:17.696153 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:40:17.696153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:18.476070 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.770 seconds
[0m19:40:18.479070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7119C4FE0>]}
[0m19:40:18.484228 [debug] [Thread-1 (]: Began running node model.data_pipeline.int_order_items
[0m19:40:18.484228 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m19:40:18.486496 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m19:40:18.487506 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.int_order_items
[0m19:40:18.495511 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m19:40:18.495511 [debug] [Thread-1 (]: Began executing node model.data_pipeline.int_order_items
[0m19:40:18.521063 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m19:40:18.523067 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m19:40:18.523067 [debug] [Thread-1 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m19:40:18.523067 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:40:24.419440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.896 seconds
[0m19:40:24.443198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7118DA720>]}
[0m19:40:24.444199 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 5.96s]
[0m19:40:24.444199 [debug] [Thread-1 (]: Finished running node model.data_pipeline.int_order_items
[0m19:40:24.445577 [debug] [Thread-3 (]: Began running node model.data_pipeline.int_order_items_summary
[0m19:40:24.445577 [info ] [Thread-3 (]: 2 of 3 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m19:40:24.446828 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m19:40:24.446828 [debug] [Thread-3 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m19:40:24.449828 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m19:40:24.450830 [debug] [Thread-3 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m19:40:24.453143 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m19:40:24.454229 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m19:40:24.455229 [debug] [Thread-3 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m19:40:24.455229 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:40:26.896222 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.441 seconds
[0m19:40:26.899261 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7176973E0>]}
[0m19:40:26.901240 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 2.45s]
[0m19:40:26.902234 [debug] [Thread-3 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m19:40:26.903232 [debug] [Thread-5 (]: Began running node model.data_pipeline.fct_orders
[0m19:40:26.903232 [info ] [Thread-5 (]: 3 of 3 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m19:40:26.904234 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m19:40:26.904234 [debug] [Thread-5 (]: Began compiling node model.data_pipeline.fct_orders
[0m19:40:26.908344 [debug] [Thread-5 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m19:40:26.909336 [debug] [Thread-5 (]: Began executing node model.data_pipeline.fct_orders
[0m19:40:26.911338 [debug] [Thread-5 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m19:40:26.913352 [debug] [Thread-5 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m19:40:26.913352 [debug] [Thread-5 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m19:40:26.913352 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m19:40:29.954288 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 3.040 seconds
[0m19:40:29.956298 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d01bc45-3cee-4eb1-bd9c-5b1a829f96ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7176AE6C0>]}
[0m19:40:29.957317 [info ] [Thread-5 (]: 3 of 3 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 3.05s]
[0m19:40:29.958314 [debug] [Thread-5 (]: Finished running node model.data_pipeline.fct_orders
[0m19:40:29.959564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:29.959564 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m19:40:29.960719 [debug] [MainThread]: On list_dbt_db: Close
[0m19:40:30.352748 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:40:30.352748 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:40:30.702349 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m19:40:30.702349 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m19:40:31.032115 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m19:40:31.033113 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m19:40:31.201219 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m19:40:31.201219 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m19:40:31.435725 [info ] [MainThread]: 
[0m19:40:31.435725 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 16.16 seconds (16.16s).
[0m19:40:31.435725 [debug] [MainThread]: Command end result
[0m19:40:31.469935 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:40:31.472388 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:40:31.472388 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:40:31.472388 [info ] [MainThread]: 
[0m19:40:31.472388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:31.472388 [info ] [MainThread]: 
[0m19:40:31.472388 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:40:31.472388 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:31.472388 after 17.52 seconds
[0m19:40:31.472388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7149E1F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A713D11910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A713D11E80>]}
[0m19:40:31.472388 [debug] [MainThread]: Flushing usage events
[0m19:40:33.941972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:37.945835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAB7CDE600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAB7BE7CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAB7241670>]}


============================== 19:40:37.950843 | 3445e960-18b5-435c-9572-47e1b621bd85 ==============================
[0m19:40:37.950843 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:40:37.950843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --selector core_pipeline', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:40:38.449895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABAF22990>]}
[0m19:40:38.496084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABA9EF770>]}
[0m19:40:38.496084 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:40:38.775818 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:40:38.989661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:38.989661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:39.031358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABCE7E480>]}
[0m19:40:39.115632 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:40:39.122973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:40:39.142721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABD5C81D0>]}
[0m19:40:39.144937 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:40:39.144937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABD425EB0>]}
[0m19:40:39.147447 [info ] [MainThread]: 
[0m19:40:39.147447 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:40:39.147447 [info ] [MainThread]: 
[0m19:40:39.150886 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:40:39.154375 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m19:40:39.234766 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m19:40:39.234766 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m19:40:39.235775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:41.192583 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.957 seconds
[0m19:40:41.195584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:40:41.207091 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:40:41.207091 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:40:41.208091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:42.262201 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.054 seconds
[0m19:40:42.265201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABD014AD0>]}
[0m19:40:42.269201 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m19:40:42.270201 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m19:40:42.270201 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m19:40:42.273201 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m19:40:42.272201 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m19:40:42.273201 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m19:40:42.273201 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m19:40:42.288202 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m19:40:42.289202 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m19:40:42.291207 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m19:40:42.292422 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m19:40:42.310534 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m19:40:42.316534 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m19:40:42.319534 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m19:40:42.320543 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m19:40:42.320543 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m19:40:42.321841 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m19:40:42.321841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:40:42.322850 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m19:40:42.322850 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:40:43.216557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.895 seconds
[0m19:40:43.237558 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m19:40:43.239899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAB7DFA810>]}
[0m19:40:43.240708 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDBA3FB0>]}
[0m19:40:43.240708 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 0.96s]
[0m19:40:43.242022 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m19:40:43.240708 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 0.97s]
[0m19:40:43.243184 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m19:40:43.243184 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m19:40:43.243184 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m19:40:43.244580 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m19:40:43.244580 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m19:40:43.247615 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m19:40:43.248615 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m19:40:43.270621 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m19:40:43.272130 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m19:40:43.272130 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m19:40:43.273140 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:40:47.920608 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 4.648 seconds
[0m19:40:47.923624 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDC1BF50>]}
[0m19:40:47.923624 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 4.68s]
[0m19:40:47.924624 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m19:40:47.925624 [debug] [Thread-6 (]: Began running node model.data_pipeline.int_order_items_summary
[0m19:40:47.926625 [info ] [Thread-6 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m19:40:47.927624 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m19:40:47.927624 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m19:40:47.931624 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m19:40:47.932633 [debug] [Thread-6 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m19:40:47.936102 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m19:40:47.937105 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m19:40:47.937105 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m19:40:47.938105 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m19:40:50.986911 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 3.055 seconds
[0m19:40:50.986911 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDBE4C80>]}
[0m19:40:50.986911 [info ] [Thread-6 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 3.06s]
[0m19:40:50.997112 [debug] [Thread-6 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m19:40:50.997112 [debug] [Thread-8 (]: Began running node model.data_pipeline.fct_orders
[0m19:40:50.997112 [info ] [Thread-8 (]: 5 of 5 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m19:40:50.997112 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m19:40:50.997112 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.fct_orders
[0m19:40:50.997112 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m19:40:50.997112 [debug] [Thread-8 (]: Began executing node model.data_pipeline.fct_orders
[0m19:40:51.006112 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m19:40:51.006112 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m19:40:51.006112 [debug] [Thread-8 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m19:40:51.009361 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m19:40:52.962861 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.954 seconds
[0m19:40:52.965159 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3445e960-18b5-435c-9572-47e1b621bd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDB62A20>]}
[0m19:40:52.966158 [info ] [Thread-8 (]: 5 of 5 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 1.97s]
[0m19:40:52.967157 [debug] [Thread-8 (]: Finished running node model.data_pipeline.fct_orders
[0m19:40:52.969442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:52.969442 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m19:40:52.969442 [debug] [MainThread]: On list_dbt_db: Close
[0m19:40:53.135427 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:40:53.136427 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:40:53.381292 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m19:40:53.382292 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m19:40:53.622091 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m19:40:53.623091 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m19:40:53.793406 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m19:40:53.794408 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m19:40:54.034752 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m19:40:54.035752 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m19:40:54.198950 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m19:40:54.213755 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m19:40:54.449635 [info ] [MainThread]: 
[0m19:40:54.451643 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m19:40:54.453338 [debug] [MainThread]: Command end result
[0m19:40:54.476587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:40:54.482680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:40:54.488532 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:40:54.488532 [info ] [MainThread]: 
[0m19:40:54.488532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:54.488532 [info ] [MainThread]: 
[0m19:40:54.490849 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:40:54.492024 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:54.492024 after 16.65 seconds
[0m19:40:54.492024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABA32CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABAC57260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABAC55940>]}
[0m19:40:54.492024 [debug] [MainThread]: Flushing usage events
[0m19:40:56.875764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:41:15.064875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014581C028A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014581BCC4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014581BCEF90>]}


============================== 19:41:15.070579 | 439910d5-c1b7-4145-94d2-392cdff17fe6 ==============================
[0m19:41:15.070579 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:41:15.070579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --selector staging_models', 'send_anonymous_usage_stats': 'True'}
[0m19:41:15.550763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '439910d5-c1b7-4145-94d2-392cdff17fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001458411E810>]}
[0m19:41:15.603833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '439910d5-c1b7-4145-94d2-392cdff17fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014583C663C0>]}
[0m19:41:15.603833 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:41:15.884885 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:41:16.102202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:41:16.102202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:41:16.151069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '439910d5-c1b7-4145-94d2-392cdff17fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001458463CFE0>]}
[0m19:41:16.251089 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:41:16.253425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:41:16.287624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '439910d5-c1b7-4145-94d2-392cdff17fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145843283B0>]}
[0m19:41:16.288621 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:41:16.288621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439910d5-c1b7-4145-94d2-392cdff17fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014582253C80>]}
[0m19:41:16.291633 [info ] [MainThread]: 
[0m19:41:16.292630 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:41:16.292630 [info ] [MainThread]: 
[0m19:41:16.293642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:41:16.297838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:41:16.378588 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:41:16.379588 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:41:16.379588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:17.691469 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.312 seconds
[0m19:41:17.695470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439910d5-c1b7-4145-94d2-392cdff17fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145848E3080>]}
[0m19:41:17.701468 [debug] [Thread-1 (]: Began running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m19:41:17.702550 [debug] [Thread-2 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m19:41:17.702550 [debug] [Thread-3 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m19:41:17.703556 [debug] [Thread-4 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m19:41:17.703556 [info ] [Thread-1 (]: 1 of 4 START test relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m19:41:17.704554 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m19:41:17.706667 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce'
[0m19:41:17.705549 [info ] [Thread-3 (]: 3 of 4 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m19:41:17.707668 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m19:41:17.707668 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m19:41:17.705549 [info ] [Thread-4 (]: 4 of 4 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m19:41:17.708668 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m19:41:17.709759 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m19:41:17.729520 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m19:41:17.729520 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m19:41:17.730520 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m19:41:17.738993 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m19:41:17.740186 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m19:41:17.746915 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m19:41:17.752258 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m19:41:17.753257 [debug] [Thread-1 (]: Began executing node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m19:41:17.772443 [debug] [Thread-2 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m19:41:17.777639 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m19:41:17.779639 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m19:41:17.780648 [debug] [Thread-3 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m19:41:17.780648 [debug] [Thread-4 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m19:41:17.782937 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m19:41:17.784946 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m19:41:17.787200 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m19:41:17.787200 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m19:41:17.787200 [debug] [Thread-1 (]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_orders
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"} */
[0m19:41:17.788644 [debug] [Thread-2 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
[0m19:41:17.788644 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m19:41:17.790077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:17.790077 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m19:41:17.791078 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:41:17.791078 [debug] [Thread-3 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
[0m19:41:17.792076 [debug] [Thread-4 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
[0m19:41:17.794075 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:41:17.795085 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:41:18.536994 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m19:41:18.545030 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 0.84s]
[0m19:41:18.546060 [debug] [Thread-2 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m19:41:19.007806 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.213 seconds
[0m19:41:19.010087 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 1.28s]
[0m19:41:19.010087 [debug] [Thread-4 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m19:41:19.172446 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.378 seconds
[0m19:41:19.174444 [info ] [Thread-3 (]: 3 of 4 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 1.47s]
[0m19:41:19.175447 [debug] [Thread-3 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m19:41:19.328746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.539 seconds
[0m19:41:19.330755 [info ] [Thread-1 (]: 1 of 4 PASS relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [[32mPASS[0m in 1.62s]
[0m19:41:19.331589 [debug] [Thread-1 (]: Finished running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m19:41:19.333795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:19.333795 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:41:19.333795 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:41:19.507696 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' was left open.
[0m19:41:19.507696 [debug] [MainThread]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: Close
[0m19:41:19.753353 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m19:41:19.753353 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m19:41:19.932155 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m19:41:19.933152 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m19:41:20.099713 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m19:41:20.099713 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m19:41:20.423915 [info ] [MainThread]: 
[0m19:41:20.424915 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m19:41:20.425915 [debug] [MainThread]: Command end result
[0m19:41:20.447864 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:41:20.451072 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:41:20.457069 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:41:20.457069 [info ] [MainThread]: 
[0m19:41:20.458070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:20.458070 [info ] [MainThread]: 
[0m19:41:20.459070 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:41:20.460071 [debug] [MainThread]: Command `dbt test` succeeded at 19:41:20.459070 after 5.50 seconds
[0m19:41:20.460071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145820E7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145820E57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014584266BA0>]}
[0m19:41:20.460071 [debug] [MainThread]: Flushing usage events
[0m19:41:22.094923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:31.089977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4BE623350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C0B72450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C0B721E0>]}


============================== 19:45:31.095976 | e399cf77-5525-4e70-8690-104afd20e7e0 ==============================
[0m19:45:31.095976 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:45:31.095976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --selector staging_models', 'send_anonymous_usage_stats': 'True'}
[0m19:45:31.569909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e399cf77-5525-4e70-8690-104afd20e7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C134E240>]}
[0m19:45:31.622642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e399cf77-5525-4e70-8690-104afd20e7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C3A23110>]}
[0m19:45:31.623991 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:45:31.911404 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:45:32.133581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:45:32.134581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:45:32.178098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e399cf77-5525-4e70-8690-104afd20e7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C3B22150>]}
[0m19:45:32.272394 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:45:32.274395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:45:32.300291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e399cf77-5525-4e70-8690-104afd20e7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C3A75940>]}
[0m19:45:32.300291 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:45:32.301293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e399cf77-5525-4e70-8690-104afd20e7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C3EE1A00>]}
[0m19:45:32.302291 [info ] [MainThread]: data_pipeline.staging.stg_tpch_line_items
[0m19:45:32.302291 [info ] [MainThread]: data_pipeline.staging.stg_tpch_orders
[0m19:45:32.303290 [info ] [MainThread]: source:data_pipeline.tpch.lineitem
[0m19:45:32.303290 [info ] [MainThread]: source:data_pipeline.tpch.orders
[0m19:45:32.304290 [info ] [MainThread]: data_pipeline.marts.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_
[0m19:45:32.304290 [info ] [MainThread]: data_pipeline.staging.source_not_null_tpch_orders_o_orderkey
[0m19:45:32.304290 [info ] [MainThread]: data_pipeline.staging.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_
[0m19:45:32.305309 [info ] [MainThread]: data_pipeline.staging.source_unique_tpch_orders_o_orderkey
[0m19:45:32.306309 [debug] [MainThread]: Command `dbt ls` succeeded at 19:45:32.306309 after 1.39 seconds
[0m19:45:32.306309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C123CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C3B4E1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C18A0800>]}
[0m19:45:32.306309 [debug] [MainThread]: Flushing usage events
[0m19:45:33.728833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:46.992494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA018CF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA0083AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA0081640>]}


============================== 19:48:46.998515 | 1aca652b-d302-4b8c-b73e-28e565bbb2ac ==============================
[0m19:48:46.998515 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:48:46.998515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --selector staging_models', 'send_anonymous_usage_stats': 'True'}
[0m19:48:47.443249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aca652b-d302-4b8c-b73e-28e565bbb2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA28BD310>]}
[0m19:48:47.496767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aca652b-d302-4b8c-b73e-28e565bbb2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA004CEF0>]}
[0m19:48:47.498025 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:48:47.747329 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:48:47.958586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:48:47.958586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:48:47.998659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aca652b-d302-4b8c-b73e-28e565bbb2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA27F6480>]}
[0m19:48:48.075666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:48:48.079214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:48:48.096941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aca652b-d302-4b8c-b73e-28e565bbb2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA2DA84A0>]}
[0m19:48:48.097942 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:48:48.097942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aca652b-d302-4b8c-b73e-28e565bbb2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FA2B44440>]}
[0m19:48:48.099940 [info ] [MainThread]: data_pipeline.staging.stg_tpch_line_items
[0m19:48:48.099940 [info ] [MainThread]: data_pipeline.staging.stg_tpch_orders
[0m19:48:48.099940 [info ] [MainThread]: source:data_pipeline.tpch.lineitem
[0m19:48:48.099940 [info ] [MainThread]: source:data_pipeline.tpch.orders
[0m19:48:48.101187 [info ] [MainThread]: data_pipeline.marts.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_
[0m19:48:48.101187 [info ] [MainThread]: data_pipeline.staging.source_not_null_tpch_orders_o_orderkey
[0m19:48:48.101187 [info ] [MainThread]: data_pipeline.staging.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_
[0m19:48:48.102353 [info ] [MainThread]: data_pipeline.staging.source_unique_tpch_orders_o_orderkey
[0m19:48:48.103537 [debug] [MainThread]: Command `dbt ls` succeeded at 19:48:48.102353 after 1.27 seconds
[0m19:48:48.103537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9FBC1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9DA09A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9D4D8CB0>]}
[0m19:48:48.103537 [debug] [MainThread]: Flushing usage events
[0m19:48:50.370156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:08.815332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1CC8F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1C42BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C19AFB8F0>]}


============================== 19:49:08.820485 | ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60 ==============================
[0m19:49:08.820485 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:49:08.821493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --selector core_pipeline', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:09.306697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1EFA48F0>]}
[0m19:49:09.365973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1EF755E0>]}
[0m19:49:09.367980 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:49:09.642676 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:49:09.862738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:09.862738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:09.906570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1F12E510>]}
[0m19:49:09.991958 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:49:09.994961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:49:10.015866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1F508620>]}
[0m19:49:10.017170 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 594 macros
[0m19:49:10.017170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1F12E3F0>]}
[0m19:49:10.020169 [info ] [MainThread]: 
[0m19:49:10.021169 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:49:10.021679 [info ] [MainThread]: 
[0m19:49:10.021679 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:49:10.025511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m19:49:10.097096 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m19:49:10.098095 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m19:49:10.098095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:12.497328 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.399 seconds
[0m19:49:12.497328 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:49:12.504092 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:49:12.504092 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:49:12.504092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:13.975339 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.472 seconds
[0m19:49:13.975339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1F4F8740>]}
[0m19:49:13.991571 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m19:49:13.992634 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m19:49:13.992634 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m19:49:13.995648 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m19:49:13.995337 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m19:49:13.995648 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m19:49:13.995648 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m19:49:14.012245 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m19:49:14.013244 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m19:49:14.015309 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m19:49:14.016310 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m19:49:14.027239 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m19:49:14.041600 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m19:49:14.045841 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m19:49:14.047648 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m19:49:14.047648 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m19:49:14.047648 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m19:49:14.047648 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m19:49:14.047648 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:49:14.047648 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:49:14.724962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m19:49:14.744628 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m19:49:14.747062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C19D0A3F0>]}
[0m19:49:14.748075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1FAD3050>]}
[0m19:49:14.748075 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 0.75s]
[0m19:49:14.749070 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m19:49:14.749070 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 0.75s]
[0m19:49:14.750240 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m19:49:14.751243 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m19:49:14.751243 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m19:49:14.752255 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m19:49:14.752255 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m19:49:14.756257 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m19:49:14.756257 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m19:49:14.777807 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m19:49:14.778808 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m19:49:14.779806 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m19:49:14.779806 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:49:19.305754 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 4.528 seconds
[0m19:49:19.305754 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1FB34CE0>]}
[0m19:49:19.305754 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 4.55s]
[0m19:49:19.305754 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m19:49:19.305754 [debug] [Thread-6 (]: Began running node model.data_pipeline.int_order_items_summary
[0m19:49:19.305754 [info ] [Thread-6 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m19:49:19.305754 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m19:49:19.305754 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m19:49:19.305754 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m19:49:19.305754 [debug] [Thread-6 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m19:49:19.320208 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m19:49:19.322360 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m19:49:19.322873 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m19:49:19.322873 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m19:49:21.921746 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.599 seconds
[0m19:49:21.923737 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1FAD0680>]}
[0m19:49:21.924732 [info ] [Thread-6 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 2.62s]
[0m19:49:21.924732 [debug] [Thread-6 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m19:49:21.925740 [debug] [Thread-8 (]: Began running node model.data_pipeline.fct_orders
[0m19:49:21.926740 [info ] [Thread-8 (]: 5 of 5 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m19:49:21.926740 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m19:49:21.927740 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.fct_orders
[0m19:49:21.930797 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m19:49:21.930797 [debug] [Thread-8 (]: Began executing node model.data_pipeline.fct_orders
[0m19:49:21.934215 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m19:49:21.935215 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m19:49:21.936216 [debug] [Thread-8 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m19:49:21.936216 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m19:49:23.771601 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.839 seconds
[0m19:49:23.771601 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca59e93f-6acd-4fe3-b2a8-3cb9a3227e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1FB43A10>]}
[0m19:49:23.771601 [info ] [Thread-8 (]: 5 of 5 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 1.84s]
[0m19:49:23.771601 [debug] [Thread-8 (]: Finished running node model.data_pipeline.fct_orders
[0m19:49:23.780815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:23.780815 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m19:49:23.780815 [debug] [MainThread]: On list_dbt_db: Close
[0m19:49:24.027252 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:49:24.027252 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:49:24.660690 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m19:49:24.660690 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m19:49:24.836213 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m19:49:24.837637 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m19:49:25.257778 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m19:49:25.257778 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m19:49:25.750969 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m19:49:25.751969 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m19:49:25.921485 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m19:49:25.922806 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m19:49:26.244685 [info ] [MainThread]: 
[0m19:49:26.245682 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 16.22 seconds (16.22s).
[0m19:49:26.246682 [debug] [MainThread]: Command end result
[0m19:49:26.273396 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:49:26.275739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:49:26.282468 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:49:26.282468 [info ] [MainThread]: 
[0m19:49:26.283468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:26.283468 [info ] [MainThread]: 
[0m19:49:26.284678 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:49:26.284678 [debug] [MainThread]: Command `dbt run` succeeded at 19:49:26.284678 after 17.57 seconds
[0m19:49:26.286065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1B9A8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1C1BED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C1C1BEB70>]}
[0m19:49:26.286065 [debug] [MainThread]: Flushing usage events
[0m19:49:28.281155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:14.682708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025920DCD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025920DCF2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025920DCD490>]}


============================== 19:56:14.688807 | ecb4a12f-63f2-44b6-9ec0-d23ac77471cf ==============================
[0m19:56:14.688807 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:56:14.689805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:56:15.165762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb4a12f-63f2-44b6-9ec0-d23ac77471cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259230FC4A0>]}
[0m19:56:15.233075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb4a12f-63f2-44b6-9ec0-d23ac77471cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025922C91C70>]}
[0m19:56:15.233075 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:56:15.520654 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:56:15.662042 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:56:15.662042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ecb4a12f-63f2-44b6-9ec0-d23ac77471cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259234EA000>]}
[0m19:56:17.293496 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.DATA_PIPELINE
[0m19:56:17.302493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb4a12f-63f2-44b6-9ec0-d23ac77471cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592387CF80>]}
[0m19:56:17.394815 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:56:17.397815 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:56:17.426005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb4a12f-63f2-44b6-9ec0-d23ac77471cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259238B88C0>]}
[0m19:56:17.426005 [info ] [MainThread]: Found 5 models, 9 data tests, 1 seed, 2 sources, 594 macros
[0m19:56:17.427309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb4a12f-63f2-44b6-9ec0-d23ac77471cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259238CE2D0>]}
[0m19:56:17.428590 [info ] [MainThread]: 
[0m19:56:17.429814 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:56:17.429814 [info ] [MainThread]: 
[0m19:56:17.430813 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:56:17.431822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m19:56:17.504664 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m19:56:17.504664 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m19:56:17.505674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:19.570378 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.065 seconds
[0m19:56:19.576627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m19:56:19.587347 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m19:56:19.588351 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m19:56:19.588351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:20.592836 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.005 seconds
[0m19:56:20.598376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb4a12f-63f2-44b6-9ec0-d23ac77471cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591FCD32C0>]}
[0m19:56:20.603102 [debug] [Thread-1 (]: Began running node seed.data_pipeline.customers
[0m19:56:20.604206 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.customers .................................... [RUN]
[0m19:56:20.605207 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m19:56:20.605207 [debug] [Thread-1 (]: Began compiling node seed.data_pipeline.customers
[0m19:56:20.605207 [debug] [Thread-1 (]: Began executing node seed.data_pipeline.customers
[0m19:56:20.633349 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m19:56:20.633349 [debug] [Thread-1 (]: On seed.data_pipeline.customers: create table dbt_db.dbt_schema.customers (customer_id integer,customer_name text,customer_status text,updated_at timestamp without time zone)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m19:56:20.634353 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:21.548492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m19:56:21.561499 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m19:56:21.561499 [debug] [Thread-1 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m19:56:22.028766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m19:56:22.029827 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m19:56:22.029827 [debug] [Thread-1 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m19:56:22.496578 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.480 seconds
[0m19:56:22.511060 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m19:56:22.511060 [debug] [Thread-1 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m19:56:22.903310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m19:56:22.903310 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m19:56:22.928067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb4a12f-63f2-44b6-9ec0-d23ac77471cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591DE4A4B0>]}
[0m19:56:22.929068 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.customers ................................ [[32mINSERT 3[0m in 2.32s]
[0m19:56:22.930066 [debug] [Thread-1 (]: Finished running node seed.data_pipeline.customers
[0m19:56:22.931146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:22.931146 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m19:56:22.932321 [debug] [MainThread]: On list_dbt_db: Close
[0m19:56:23.167039 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m19:56:23.167039 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m19:56:23.564579 [debug] [MainThread]: Connection 'seed.data_pipeline.customers' was left open.
[0m19:56:23.564579 [debug] [MainThread]: On seed.data_pipeline.customers: Close
[0m19:56:23.742523 [info ] [MainThread]: 
[0m19:56:23.742523 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m19:56:23.742523 [debug] [MainThread]: Command end result
[0m19:56:23.757220 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m19:56:23.757220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m19:56:23.773206 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m19:56:23.773206 [info ] [MainThread]: 
[0m19:56:23.773206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:23.777835 [info ] [MainThread]: 
[0m19:56:23.777835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:56:23.777835 [debug] [MainThread]: Command `dbt seed` succeeded at 19:56:23.777835 after 9.26 seconds
[0m19:56:23.777835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025920227740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025920226270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591DC37980>]}
[0m19:56:23.777835 [debug] [MainThread]: Flushing usage events
[0m19:56:26.279971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:41.755668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174DD22A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174DF7DEC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174DF7DEC90>]}


============================== 19:57:41.761676 | 9b2024cd-971e-4dfc-907f-df785ac0dffd ==============================
[0m19:57:41.761676 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:57:41.761676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:42.245243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b2024cd-971e-4dfc-907f-df785ac0dffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E2242D20>]}
[0m19:57:42.293226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b2024cd-971e-4dfc-907f-df785ac0dffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E25931D0>]}
[0m19:57:42.293226 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:57:42.595172 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:57:42.841965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:57:42.841965 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\customer_snapshot.sql
[0m19:57:43.014932 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot customer_snapshot (snapshots\customer_snapshot.sql)
  invalid syntax for function call expression
    line 3
      {{ config(
[0m19:57:43.016539 [debug] [MainThread]: Command `dbt snapshot` failed at 19:57:43.016539 after 1.38 seconds
[0m19:57:43.016539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174DD114DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E0347A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E156F5F0>]}
[0m19:57:43.016539 [debug] [MainThread]: Flushing usage events
[0m19:57:44.716482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:58:56.668015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247ECEF2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247ECEFBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247C2A8CB0>]}


============================== 19:58:56.669325 | 8d3a3cb8-9b58-48e8-9785-d6283e2a9e67 ==============================
[0m19:58:56.669325 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:58:56.669325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:58:57.118647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d3a3cb8-9b58-48e8-9785-d6283e2a9e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022401532900>]}
[0m19:58:57.174083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d3a3cb8-9b58-48e8-9785-d6283e2a9e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224014E8B90>]}
[0m19:58:57.176091 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:58:57.461276 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:58:57.694514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:58:57.695514 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\customer_snapshot.sql
[0m19:58:57.862362 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot customer_snapshot (snapshots\customer_snapshot.sql)
  invalid syntax for function call expression
    line 3
      {{ config(
[0m19:58:57.862362 [debug] [MainThread]: Command `dbt snapshot` failed at 19:58:57.862362 after 1.32 seconds
[0m19:58:57.868149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247F19F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022478BD5AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002247E67F530>]}
[0m19:58:57.868149 [debug] [MainThread]: Flushing usage events
[0m19:59:00.093265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:41.644018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018491D9E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018491D9D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018491D9F710>]}


============================== 19:59:41.649017 | 71aad480-4147-4434-97ad-12c9a18005ff ==============================
[0m19:59:41.649017 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:59:41.650018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:59:42.106994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71aad480-4147-4434-97ad-12c9a18005ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184945CD670>]}
[0m19:59:42.157654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71aad480-4147-4434-97ad-12c9a18005ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184923D21B0>]}
[0m19:59:42.159655 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:59:42.437781 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:59:42.648543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:59:42.648543 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\customer_snapshot.sql
[0m19:59:42.837397 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot customer_snapshot (snapshots\customer_snapshot.sql)
  invalid syntax for function call expression
    line 4
      {{ config(
[0m19:59:42.838403 [debug] [MainThread]: Command `dbt snapshot` failed at 19:59:42.838403 after 1.30 seconds
[0m19:59:42.838403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001849224D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184948B3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018494854590>]}
[0m19:59:42.839801 [debug] [MainThread]: Flushing usage events
[0m19:59:45.235701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:24.556669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284ED7FA240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F065D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F03E46B0>]}


============================== 20:00:24.561877 | 6be729d2-a3a5-4e60-8bbb-c9954a036eb3 ==============================
[0m20:00:24.561877 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:00:24.561877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:00:24.997360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6be729d2-a3a5-4e60-8bbb-c9954a036eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F24EE390>]}
[0m20:00:25.045443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6be729d2-a3a5-4e60-8bbb-c9954a036eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F2A8BD70>]}
[0m20:00:25.045443 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:00:25.327988 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:00:25.553178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:00:25.555183 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\customer_snapshot.sql
[0m20:00:25.731094 [error] [MainThread]: Encountered an error:
Snapshots must be configured with a 'strategy' and 'unique_key'.
[0m20:00:25.755237 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 479, in load
    self.check_valid_snapshot_config()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 1418, in check_valid_snapshot_config
    node.config.final_validate()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 46, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Snapshots must be configured with a 'strategy' and 'unique_key'.

[0m20:00:25.755237 [debug] [MainThread]: Command `dbt snapshot` failed at 20:00:25.755237 after 1.31 seconds
[0m20:00:25.757239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EFD56AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F2A8A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284F2E60CB0>]}
[0m20:00:25.757239 [debug] [MainThread]: Flushing usage events
[0m20:00:27.152102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:10.741574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B55153170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B55153350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B55153770>]}


============================== 20:01:10.746573 | 251f4028-3af6-45f5-b424-6ae0f847eafd ==============================
[0m20:01:10.746573 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:01:10.747573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:01:11.218814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '251f4028-3af6-45f5-b424-6ae0f847eafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B57953320>]}
[0m20:01:11.273812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '251f4028-3af6-45f5-b424-6ae0f847eafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B527E9310>]}
[0m20:01:11.275812 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:01:11.553402 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:01:11.789584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:01:11.790584 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\customer_snapshot.sql
[0m20:01:11.958425 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot customer_snapshot (snapshots\customer_snapshot.sql)
  invalid syntax for function call expression
    line 3
      {{ config(
[0m20:01:11.959681 [debug] [MainThread]: Command `dbt snapshot` failed at 20:01:11.959681 after 1.33 seconds
[0m20:01:11.959681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B556970B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B57A874A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B57A87650>]}
[0m20:01:11.960689 [debug] [MainThread]: Flushing usage events
[0m20:01:13.264744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:53.897631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FE7393A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FFDC8A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019781ED1760>]}


============================== 20:04:53.905414 | 1260965a-4563-47d9-9c61-9a73137fee31 ==============================
[0m20:04:53.905414 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:04:53.906353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:55.186289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1260965a-4563-47d9-9c61-9a73137fee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197835228D0>]}
[0m20:04:55.277473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1260965a-4563-47d9-9c61-9a73137fee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197FF84B0B0>]}
[0m20:04:55.279484 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:04:55.893519 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:04:56.624607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:04:56.625617 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\customer_snapshot.sql
[0m20:04:56.901257 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot customer_snapshot (snapshots\customer_snapshot.sql)
  invalid syntax for function call expression
    line 3
      {{ config(
[0m20:04:56.904097 [debug] [MainThread]: Command `dbt snapshot` failed at 20:04:56.902901 after 3.26 seconds
[0m20:04:56.904610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197835224E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019784787650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197847B3A10>]}
[0m20:04:56.904610 [debug] [MainThread]: Flushing usage events
[0m20:04:59.394176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:41.136270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123BCB0A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123BEF5D430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123BEF5D460>]}


============================== 20:05:41.144270 | 0589dee8-1abf-4d86-bc71-158daa1832fc ==============================
[0m20:05:41.144270 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:05:41.146270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:05:42.028762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0589dee8-1abf-4d86-bc71-158daa1832fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C1AB0E30>]}
[0m20:05:42.119699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0589dee8-1abf-4d86-bc71-158daa1832fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C1D56750>]}
[0m20:05:42.119699 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:05:42.572702 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:05:42.916488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:05:42.916488 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\customer_snapshot.sql
[0m20:05:43.216415 [error] [MainThread]: Encountered an error:
Snapshots must be configured with a 'strategy' and 'unique_key'.
[0m20:05:43.222082 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 479, in load
    self.check_valid_snapshot_config()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 1418, in check_valid_snapshot_config
    node.config.final_validate()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 46, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Snapshots must be configured with a 'strategy' and 'unique_key'.

[0m20:05:43.225186 [debug] [MainThread]: Command `dbt snapshot` failed at 20:05:43.225186 after 2.27 seconds
[0m20:05:43.226197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123BFC26930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C2164260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C1FB42F0>]}
[0m20:05:43.228207 [debug] [MainThread]: Flushing usage events
[0m20:05:44.532016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:15.363374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733BB10BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733BB13CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733BB11910>]}


============================== 20:07:15.370996 | 8009306d-901b-40b4-8ac6-9025e374b513 ==============================
[0m20:07:15.370996 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:07:15.372983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m20:07:16.155454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8009306d-901b-40b4-8ac6-9025e374b513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733B46E420>]}
[0m20:07:16.266174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8009306d-901b-40b4-8ac6-9025e374b513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733E27A750>]}
[0m20:07:16.268158 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:07:16.711459 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:07:16.967399 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:07:16.969044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8009306d-901b-40b4-8ac6-9025e374b513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733E7BA120>]}
[0m20:07:19.741102 [error] [MainThread]: Encountered an error:
Snapshots must be configured with a 'strategy' and 'unique_key'.
[0m20:07:19.742923 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 479, in load
    self.check_valid_snapshot_config()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 1418, in check_valid_snapshot_config
    node.config.final_validate()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\artifacts\resources\v1\snapshot.py", line 46, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Snapshots must be configured with a 'strategy' and 'unique_key'.

[0m20:07:19.742923 [debug] [MainThread]: Command `dbt seed` failed at 20:07:19.742923 after 4.66 seconds
[0m20:07:19.742923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733BB75730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733E9C3CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733E854B00>]}
[0m20:07:19.746689 [debug] [MainThread]: Flushing usage events
[0m20:07:21.381064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:42.843283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4A9F0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4A9F2A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB47537C50>]}


============================== 20:07:42.850139 | b2432300-5b67-4626-84c0-a31b9d4f32e3 ==============================
[0m20:07:42.850139 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:07:42.852160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:07:43.622357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2432300-5b67-4626-84c0-a31b9d4f32e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4D1D2870>]}
[0m20:07:43.712146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2432300-5b67-4626-84c0-a31b9d4f32e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB481ECC50>]}
[0m20:07:43.714146 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:07:44.172145 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:07:44.412823 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:07:44.413823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2432300-5b67-4626-84c0-a31b9d4f32e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4D5D64E0>]}
[0m20:07:47.139961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2432300-5b67-4626-84c0-a31b9d4f32e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4D4A2180>]}
[0m20:07:47.298617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m20:07:47.314315 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m20:07:47.346205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2432300-5b67-4626-84c0-a31b9d4f32e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4DAE16A0>]}
[0m20:07:47.346205 [info ] [MainThread]: Found 5 models, 1 snapshot, 9 data tests, 1 seed, 3 sources, 594 macros
[0m20:07:47.346205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2432300-5b67-4626-84c0-a31b9d4f32e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4D8E2A50>]}
[0m20:07:47.346205 [info ] [MainThread]: 
[0m20:07:47.346205 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:07:47.346205 [info ] [MainThread]: 
[0m20:07:47.346205 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:07:47.361652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m20:07:48.616308 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m20:07:48.616308 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m20:07:48.617444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:49.833543 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.216 seconds
[0m20:07:49.842539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m20:07:49.854736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m20:07:49.859934 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m20:07:49.863013 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m20:07:49.864018 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m20:07:49.864722 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m20:07:49.865165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:49.865165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:50.352277 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.487 seconds
[0m20:07:51.305299 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bfd0ed-3202-06bd-0010-8a120003006a
[0m20:07:51.306290 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:07:51.307291 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:07:51.307291 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:07:51.308291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2432300-5b67-4626-84c0-a31b9d4f32e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4DAE31D0>]}
[0m20:07:51.317983 [debug] [Thread-1 (]: Began running node seed.data_pipeline.customers
[0m20:07:51.319008 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.customers .................................... [RUN]
[0m20:07:51.319982 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m20:07:51.321091 [debug] [Thread-1 (]: Began compiling node seed.data_pipeline.customers
[0m20:07:51.321091 [debug] [Thread-1 (]: Began executing node seed.data_pipeline.customers
[0m20:07:51.376082 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:07:51.377108 [debug] [Thread-1 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m20:07:51.377108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:07:52.143741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m20:07:52.144742 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:07:52.145744 [debug] [Thread-1 (]: On seed.data_pipeline.customers: truncate table "DBT_DB"."DBT_SCHEMA"."CUSTOMERS"
  
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */;
[0m20:07:52.392054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m20:07:52.393054 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:07:52.394053 [debug] [Thread-1 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m20:07:52.719889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m20:07:52.739054 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:07:52.740054 [debug] [Thread-1 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m20:07:52.884345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m20:07:52.885350 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:07:52.886350 [debug] [Thread-1 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m20:07:53.625262 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.739 seconds
[0m20:07:53.626264 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:07:53.627290 [debug] [Thread-1 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m20:07:53.873769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m20:07:53.882265 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m20:07:53.912279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2432300-5b67-4626-84c0-a31b9d4f32e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB47F4A4B0>]}
[0m20:07:53.913264 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.customers ................................ [[32mINSERT 3[0m in 2.59s]
[0m20:07:53.914179 [debug] [Thread-1 (]: Finished running node seed.data_pipeline.customers
[0m20:07:53.917620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:53.917620 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m20:07:53.918623 [debug] [MainThread]: On list_dbt_db: Close
[0m20:07:54.086491 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m20:07:54.087493 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m20:07:54.294077 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m20:07:54.295456 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m20:07:54.535986 [debug] [MainThread]: Connection 'seed.data_pipeline.customers' was left open.
[0m20:07:54.537020 [debug] [MainThread]: On seed.data_pipeline.customers: Close
[0m20:07:54.959132 [info ] [MainThread]: 
[0m20:07:54.960169 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m20:07:54.961641 [debug] [MainThread]: Command end result
[0m20:07:55.011123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m20:07:55.016440 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m20:07:55.027540 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m20:07:55.028540 [info ] [MainThread]: 
[0m20:07:55.029543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:55.030854 [info ] [MainThread]: 
[0m20:07:55.031853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:07:55.033861 [debug] [MainThread]: Command `dbt seed` succeeded at 20:07:55.032863 after 12.36 seconds
[0m20:07:55.034861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB49E61340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4B051040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4B051BB0>]}
[0m20:07:55.034861 [debug] [MainThread]: Flushing usage events
[0m20:07:57.432150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:09:01.578115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E6D9E840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E714C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E714E2D0>]}


============================== 20:09:01.587113 | 0db096b7-add5-45fd-9cdb-000eb3a09c2e ==============================
[0m20:09:01.587113 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:09:01.588113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:09:02.367553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0db096b7-add5-45fd-9cdb-000eb3a09c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E9BF5F70>]}
[0m20:09:02.453543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0db096b7-add5-45fd-9cdb-000eb3a09c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E9972480>]}
[0m20:09:02.455525 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:09:02.911255 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:09:03.306446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:03.307445 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\generic_tests.yml
[0m20:09:03.589815 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.data_pipeline.customer_snapshot' (snapshots\customer_snapshot.sql) depends on a source named 'raw.customers' which was not found
[0m20:09:03.590815 [debug] [MainThread]: Command `dbt seed` failed at 20:09:03.590815 after 2.25 seconds
[0m20:09:03.592136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E7A10590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EA05BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EA06A720>]}
[0m20:09:03.592136 [debug] [MainThread]: Flushing usage events
[0m20:09:06.580325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:39.356122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001607F048E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001607F04B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001607B747D40>]}


============================== 20:10:39.363598 | d43a4924-0829-46f1-88b7-ce7db323a692 ==============================
[0m20:10:39.363598 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:10:39.364751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:40.116764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd43a4924-0829-46f1-88b7-ce7db323a692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001607FC1B0E0>]}
[0m20:10:40.204012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd43a4924-0829-46f1-88b7-ce7db323a692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016001387CB0>]}
[0m20:10:40.206024 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:10:40.646499 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:10:41.008018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:41.008018 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\generic_tests.yml
[0m20:10:41.303742 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.data_pipeline.customer_snapshot' (snapshots\customer_snapshot.sql) depends on a source named 'raw.customers' which was not found
[0m20:10:41.303742 [debug] [MainThread]: Command `dbt seed` failed at 20:10:41.303742 after 2.20 seconds
[0m20:10:41.309284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001607DDF0B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160014A4B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001607F38ECC0>]}
[0m20:10:41.309284 [debug] [MainThread]: Flushing usage events
[0m20:10:43.780460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:11.820462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEDF23290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF19718E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF3C3B60>]}


============================== 20:11:11.823156 | 24e4206e-e308-4bf5-80da-3a5e0f97f9c8 ==============================
[0m20:11:11.823156 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:11:11.823156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:11:12.653286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24e4206e-e308-4bf5-80da-3a5e0f97f9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF3D22BD0>]}
[0m20:11:12.753714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24e4206e-e308-4bf5-80da-3a5e0f97f9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF15F27E0>]}
[0m20:11:12.753714 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:11:13.221671 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:11:13.629371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:11:13.629371 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\generic_tests.yml
[0m20:11:13.629371 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://snapshots\customer_snapshot.sql
[0m20:11:13.935449 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.data_pipeline.customer_snapshot' (snapshots\customer_snapshot.sql) depends on a source named 'dbt_schema.customers' which was not found
[0m20:11:13.937503 [debug] [MainThread]: Command `dbt seed` failed at 20:11:13.937503 after 2.29 seconds
[0m20:11:13.937503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEDF23290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF0ECECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF41FBFE0>]}
[0m20:11:13.938507 [debug] [MainThread]: Flushing usage events
[0m20:11:15.531425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:48.821282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F94E25F170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F94EA0D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F94EA0E1E0>]}


============================== 20:12:48.831538 | 283fa043-f0df-43ac-bda5-5519ba4a61db ==============================
[0m20:12:48.831538 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:12:48.832568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:12:49.599506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283fa043-f0df-43ac-bda5-5519ba4a61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F94BE5B530>]}
[0m20:12:49.687009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '283fa043-f0df-43ac-bda5-5519ba4a61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F951001CA0>]}
[0m20:12:49.689007 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:12:50.125950 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:12:50.506520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m20:12:50.507520 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\sources.yml
[0m20:12:50.508520 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\generic_tests.yml
[0m20:12:50.509520 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://snapshots\customer_snapshot.sql
[0m20:12:51.075807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '283fa043-f0df-43ac-bda5-5519ba4a61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F951444350>]}
[0m20:12:51.230474 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m20:12:51.234474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m20:12:51.271681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '283fa043-f0df-43ac-bda5-5519ba4a61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F95151A330>]}
[0m20:12:51.273172 [info ] [MainThread]: Found 5 models, 9 data tests, 1 seed, 1 snapshot, 3 sources, 594 macros
[0m20:12:51.274192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283fa043-f0df-43ac-bda5-5519ba4a61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F9517DFE30>]}
[0m20:12:51.276270 [info ] [MainThread]: 
[0m20:12:51.277270 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:12:51.278249 [info ] [MainThread]: 
[0m20:12:51.279273 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:12:51.281273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m20:12:51.392196 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m20:12:51.393193 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m20:12:51.393193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:52.943391 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.550 seconds
[0m20:12:52.952396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m20:12:52.969479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m20:12:52.972706 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m20:12:52.977058 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m20:12:52.978321 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m20:12:52.978321 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m20:12:52.979317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:52.979317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:53.760352 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bfd0f2-3202-06bd-0010-8a1200030126
[0m20:12:53.775079 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:12:53.775079 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:12:53.776279 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:12:53.930004 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.950 seconds
[0m20:12:53.930004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283fa043-f0df-43ac-bda5-5519ba4a61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F95167C950>]}
[0m20:12:53.943962 [debug] [Thread-1 (]: Began running node seed.data_pipeline.customers
[0m20:12:53.943962 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.customers .................................... [RUN]
[0m20:12:53.943962 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m20:12:53.946567 [debug] [Thread-1 (]: Began compiling node seed.data_pipeline.customers
[0m20:12:53.946567 [debug] [Thread-1 (]: Began executing node seed.data_pipeline.customers
[0m20:12:54.002166 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:12:54.002166 [debug] [Thread-1 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m20:12:54.002166 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:12:54.671411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m20:12:54.671411 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:12:54.671411 [debug] [Thread-1 (]: On seed.data_pipeline.customers: truncate table "DBT_DB"."DBT_SCHEMA"."CUSTOMERS"
  
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */;
[0m20:12:55.000121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m20:12:55.000121 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:12:55.002131 [debug] [Thread-1 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m20:12:55.251067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m20:12:55.279410 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:12:55.280521 [debug] [Thread-1 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m20:12:55.412604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m20:12:55.412604 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:12:55.412604 [debug] [Thread-1 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m20:12:56.083016 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.668 seconds
[0m20:12:56.084041 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m20:12:56.085043 [debug] [Thread-1 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m20:12:56.470466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m20:12:56.478471 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m20:12:56.510816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283fa043-f0df-43ac-bda5-5519ba4a61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F94BE5A750>]}
[0m20:12:56.511815 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.customers ................................ [[32mINSERT 3[0m in 2.56s]
[0m20:12:56.512548 [debug] [Thread-1 (]: Finished running node seed.data_pipeline.customers
[0m20:12:56.516294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:56.516294 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m20:12:56.517295 [debug] [MainThread]: On list_dbt_db: Close
[0m20:12:56.759417 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m20:12:56.759417 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m20:12:57.031898 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m20:12:57.032898 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m20:12:57.212551 [debug] [MainThread]: Connection 'seed.data_pipeline.customers' was left open.
[0m20:12:57.213060 [debug] [MainThread]: On seed.data_pipeline.customers: Close
[0m20:12:57.443262 [info ] [MainThread]: 
[0m20:12:57.444278 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m20:12:57.446261 [debug] [MainThread]: Command end result
[0m20:12:57.499358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m20:12:57.504356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m20:12:57.516414 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m20:12:57.517505 [info ] [MainThread]: 
[0m20:12:57.518626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:57.519691 [info ] [MainThread]: 
[0m20:12:57.520222 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:12:57.521313 [debug] [MainThread]: Command `dbt seed` succeeded at 20:12:57.521313 after 8.95 seconds
[0m20:12:57.522311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F94DAF0B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F94EB2FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F94C8326C0>]}
[0m20:12:57.522311 [debug] [MainThread]: Flushing usage events
[0m20:12:58.792246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:05.793580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C3EAFBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C38979E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C3896B10>]}


============================== 20:13:05.801335 | a35487ea-d2d6-4416-9d58-a6205c999277 ==============================
[0m20:13:05.801335 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:13:05.802372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:06.582975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a35487ea-d2d6-4416-9d58-a6205c999277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C37BA090>]}
[0m20:13:06.676584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a35487ea-d2d6-4416-9d58-a6205c999277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C60DE2A0>]}
[0m20:13:06.678587 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:13:07.120633 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:13:07.531893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:07.531893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:07.631169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a35487ea-d2d6-4416-9d58-a6205c999277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C6984290>]}
[0m20:13:07.793634 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m20:13:07.796772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m20:13:07.849476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a35487ea-d2d6-4416-9d58-a6205c999277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C6A7FA70>]}
[0m20:13:07.850478 [info ] [MainThread]: Found 5 models, 9 data tests, 1 seed, 1 snapshot, 3 sources, 594 macros
[0m20:13:07.850478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a35487ea-d2d6-4416-9d58-a6205c999277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C43F63C0>]}
[0m20:13:07.853774 [info ] [MainThread]: 
[0m20:13:07.854808 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:13:07.856305 [info ] [MainThread]: 
[0m20:13:07.856305 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:07.857769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m20:13:07.983298 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m20:13:07.984311 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m20:13:07.984311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:10.664270 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.688 seconds
[0m20:13:10.675099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now create_dbt_db_snapshots)
[0m20:13:10.677598 [debug] [ThreadPool]: Creating schema "database: "dbt_db"
schema: "snapshots"
"
[0m20:13:10.688425 [debug] [ThreadPool]: Using snowflake connection "create_dbt_db_snapshots"
[0m20:13:10.689523 [debug] [ThreadPool]: On create_dbt_db_snapshots: create schema if not exists dbt_db.snapshots
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "create_dbt_db_snapshots"} */
[0m20:13:10.938731 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.261 seconds
[0m20:13:10.959713 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m20:13:10.968389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m20:13:10.977613 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m20:13:10.977613 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m20:13:10.977613 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m20:13:10.977613 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m20:13:10.977613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:10.984038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:11.855192 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.872 seconds
[0m20:13:11.866861 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.883 seconds
[0m20:13:11.871900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a35487ea-d2d6-4416-9d58-a6205c999277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C70E4470>]}
[0m20:13:11.882269 [debug] [Thread-1 (]: Began running node snapshot.data_pipeline.customer_snapshot
[0m20:13:11.882269 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customer_snapshot .............................. [RUN]
[0m20:13:11.883449 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.data_pipeline.customer_snapshot'
[0m20:13:11.884876 [debug] [Thread-1 (]: Began compiling node snapshot.data_pipeline.customer_snapshot
[0m20:13:11.895135 [debug] [Thread-1 (]: Began executing node snapshot.data_pipeline.customer_snapshot
[0m20:13:12.005963 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m20:13:12.007980 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m20:13:12.009124 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:13:12.800941 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.792 seconds
[0m20:13:12.808941 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m20:13:12.808941 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m20:13:13.027629 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.217 seconds
[0m20:13:13.028629 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot"
[0m20:13:13.032630 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m20:13:13.033138 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: create or replace transient table dbt_db.snapshots.customer_snapshot
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name

    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m20:13:13.601691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m20:13:13.639722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a35487ea-d2d6-4416-9d58-a6205c999277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C3810920>]}
[0m20:13:13.640735 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customer_snapshot .............................. [[32mSUCCESS 1[0m in 1.75s]
[0m20:13:13.641728 [debug] [Thread-1 (]: Finished running node snapshot.data_pipeline.customer_snapshot
[0m20:13:13.644644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:13.645706 [debug] [MainThread]: Connection 'create_dbt_db_snapshots' was left open.
[0m20:13:13.645706 [debug] [MainThread]: On create_dbt_db_snapshots: Close
[0m20:13:13.840292 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m20:13:13.840292 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m20:13:14.180869 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m20:13:14.182879 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m20:13:14.570391 [debug] [MainThread]: Connection 'snapshot.data_pipeline.customer_snapshot' was left open.
[0m20:13:14.570391 [debug] [MainThread]: On snapshot.data_pipeline.customer_snapshot: Close
[0m20:13:14.878529 [info ] [MainThread]: 
[0m20:13:14.878529 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m20:13:14.878529 [debug] [MainThread]: Command end result
[0m20:13:14.916695 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m20:13:14.929114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m20:13:14.940829 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m20:13:14.940829 [info ] [MainThread]: 
[0m20:13:14.943556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:14.943556 [info ] [MainThread]: 
[0m20:13:14.943556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:13:14.947288 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:13:14.947288 after 9.31 seconds
[0m20:13:14.948302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C3D60DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C3D63860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C3D62030>]}
[0m20:13:14.948302 [debug] [MainThread]: Flushing usage events
[0m20:13:16.605799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:01.195330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68B67A810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68AD77E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68AD76F00>]}


============================== 10:29:01.195330 | dc56789d-477a-478d-9053-4203c1f3f9f5 ==============================
[0m10:29:01.195330 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:29:01.195330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:02.026923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc56789d-477a-478d-9053-4203c1f3f9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68F97E390>]}
[0m10:29:02.115629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc56789d-477a-478d-9053-4203c1f3f9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A690B132F0>]}
[0m10:29:02.117648 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:29:02.577184 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:29:02.980937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:02.980937 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://seeds\customers.csv
[0m10:29:03.344596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc56789d-477a-478d-9053-4203c1f3f9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A690B6F440>]}
[0m10:29:03.511002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:29:03.512875 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:29:03.551972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc56789d-477a-478d-9053-4203c1f3f9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A690F8E960>]}
[0m10:29:03.551972 [info ] [MainThread]: Found 5 models, 9 data tests, 1 snapshot, 1 seed, 3 sources, 594 macros
[0m10:29:03.554875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc56789d-477a-478d-9053-4203c1f3f9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A690B9D7F0>]}
[0m10:29:03.556122 [info ] [MainThread]: 
[0m10:29:03.556122 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:29:03.556122 [info ] [MainThread]: 
[0m10:29:03.556122 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:29:03.560968 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:29:03.684053 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:29:03.684053 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:29:03.684053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:06.416325 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.732 seconds
[0m10:29:06.427333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:29:06.434090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:29:06.449415 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:29:06.453887 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:29:06.453887 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:29:06.454887 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:29:06.454887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:06.455888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:07.484936 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.029 seconds
[0m10:29:07.485935 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.031 seconds
[0m10:29:07.493949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc56789d-477a-478d-9053-4203c1f3f9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6910D5DF0>]}
[0m10:29:07.500797 [debug] [Thread-1 (]: Began running node seed.data_pipeline.customers
[0m10:29:07.501817 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.customers .................................... [RUN]
[0m10:29:07.502818 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m10:29:07.503816 [debug] [Thread-1 (]: Began compiling node seed.data_pipeline.customers
[0m10:29:07.503816 [debug] [Thread-1 (]: Began executing node seed.data_pipeline.customers
[0m10:29:07.550897 [debug] [Thread-1 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."CUSTOMERS"
[0m10:29:07.556897 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:29:07.557899 [debug] [Thread-1 (]: On seed.data_pipeline.customers: drop table if exists "DBT_DB"."DBT_SCHEMA"."CUSTOMERS" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:29:07.558902 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:08.308999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m10:29:08.318469 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:29:08.318469 [debug] [Thread-1 (]: On seed.data_pipeline.customers: create table dbt_db.dbt_schema.customers (customer_id integer,customer_name text,customer_status text,updated_at timestamp without time zone)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:29:08.554907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m10:29:08.583482 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:29:08.584485 [debug] [Thread-1 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:29:08.720932 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m10:29:08.722100 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:29:08.723133 [debug] [Thread-1 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m10:29:09.625518 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.901 seconds
[0m10:29:09.626523 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:29:09.626523 [debug] [Thread-1 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:29:09.884347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m10:29:09.894348 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m10:29:09.936783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc56789d-477a-478d-9053-4203c1f3f9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68B77A900>]}
[0m10:29:09.937943 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.customers ................................ [[32mCREATE 3[0m in 2.43s]
[0m10:29:09.940078 [debug] [Thread-1 (]: Finished running node seed.data_pipeline.customers
[0m10:29:09.943608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:09.943608 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:29:09.943608 [debug] [MainThread]: On list_dbt_db: Close
[0m10:29:10.213487 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:29:10.214995 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:29:10.409479 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:29:10.410484 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:29:10.712580 [debug] [MainThread]: Connection 'seed.data_pipeline.customers' was left open.
[0m10:29:10.713584 [debug] [MainThread]: On seed.data_pipeline.customers: Close
[0m10:29:11.026506 [info ] [MainThread]: 
[0m10:29:11.037707 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m10:29:11.040073 [debug] [MainThread]: Command end result
[0m10:29:11.091705 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:29:11.096290 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:29:11.104324 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:29:11.104324 [info ] [MainThread]: 
[0m10:29:11.106689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:11.108167 [info ] [MainThread]: 
[0m10:29:11.108167 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:29:11.108167 [debug] [MainThread]: Command `dbt seed` succeeded at 10:29:11.108167 after 10.12 seconds
[0m10:29:11.111746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68B67A810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68F8518E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68F8516D0>]}
[0m10:29:11.111746 [debug] [MainThread]: Flushing usage events
[0m10:29:12.427038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:21.897697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A011D640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249FA6D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249FCE47A0>]}


============================== 10:29:21.897697 | 04c9f994-570a-4b85-9ca5-1e433ca8d07e ==============================
[0m10:29:21.897697 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:29:21.897697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:22.803892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04c9f994-570a-4b85-9ca5-1e433ca8d07e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A02A13A0>]}
[0m10:29:22.903779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04c9f994-570a-4b85-9ca5-1e433ca8d07e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249FE6FEF0>]}
[0m10:29:22.903779 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:29:23.384566 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:29:23.821222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:23.821846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:23.932430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04c9f994-570a-4b85-9ca5-1e433ca8d07e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A251CF20>]}
[0m10:29:24.102338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:29:24.105587 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:29:24.148294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04c9f994-570a-4b85-9ca5-1e433ca8d07e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A27B40B0>]}
[0m10:29:24.148294 [info ] [MainThread]: Found 5 models, 9 data tests, 1 snapshot, 1 seed, 3 sources, 594 macros
[0m10:29:24.149685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04c9f994-570a-4b85-9ca5-1e433ca8d07e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A234BCB0>]}
[0m10:29:24.152716 [info ] [MainThread]: 
[0m10:29:24.153714 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:29:24.155197 [info ] [MainThread]: 
[0m10:29:24.156200 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:29:24.158199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:29:24.293596 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:29:24.294596 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:29:24.294596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:25.928245 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.633 seconds
[0m10:29:25.937322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:29:25.958370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:29:25.959370 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:29:25.962375 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:29:25.962375 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:29:25.963371 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:29:25.963371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:25.964539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:26.757538 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.794 seconds
[0m10:29:26.762607 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.799 seconds
[0m10:29:26.767605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04c9f994-570a-4b85-9ca5-1e433ca8d07e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A26ED6D0>]}
[0m10:29:26.776469 [debug] [Thread-1 (]: Began running node snapshot.data_pipeline.customer_snapshot
[0m10:29:26.777469 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customer_snapshot .............................. [RUN]
[0m10:29:26.779469 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.data_pipeline.customer_snapshot'
[0m10:29:26.779469 [debug] [Thread-1 (]: Began compiling node snapshot.data_pipeline.customer_snapshot
[0m10:29:26.797471 [debug] [Thread-1 (]: Began executing node snapshot.data_pipeline.customer_snapshot
[0m10:29:26.892322 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:26.892322 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:26.893322 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:27.668187 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.777 seconds
[0m10:29:27.751261 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:27.753787 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m10:29:28.578364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m10:29:28.581316 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:28.583840 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:28.732916 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.148 seconds
[0m10:29:28.741548 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:28.743556 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:28.980175 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.236 seconds
[0m10:29:28.986247 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:28.986247 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:29.144868 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.158 seconds
[0m10:29:29.150894 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:29.151896 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:29.311166 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.159 seconds
[0m10:29:29.321208 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:29.322208 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:29.560038 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.238 seconds
[0m10:29:29.591542 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:29.591542 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:29.804990 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.213 seconds
[0m10:29:29.816007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:29.817007 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:29.969849 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m10:29:29.970887 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot"
[0m10:29:29.973870 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:29.973870 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:30.134645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m10:29:30.135644 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:30.135644 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m10:29:30.959747 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.823 seconds
[0m10:29:30.959747 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:29:30.961774 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:29:31.207292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m10:29:31.236636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04c9f994-570a-4b85-9ca5-1e433ca8d07e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A405A330>]}
[0m10:29:31.236636 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customer_snapshot .............................. [[32mSUCCESS 2[0m in 4.46s]
[0m10:29:31.236636 [debug] [Thread-1 (]: Finished running node snapshot.data_pipeline.customer_snapshot
[0m10:29:31.236636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:31.244980 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:29:31.244980 [debug] [MainThread]: On list_dbt_db: Close
[0m10:29:31.458771 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:29:31.458771 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:29:31.700024 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:29:31.700024 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:29:31.866367 [debug] [MainThread]: Connection 'snapshot.data_pipeline.customer_snapshot' was left open.
[0m10:29:31.866367 [debug] [MainThread]: On snapshot.data_pipeline.customer_snapshot: Close
[0m10:29:32.276736 [info ] [MainThread]: 
[0m10:29:32.276736 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.12 seconds (8.12s).
[0m10:29:32.278804 [debug] [MainThread]: Command end result
[0m10:29:32.324604 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:29:32.329544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:29:32.335295 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:29:32.335295 [info ] [MainThread]: 
[0m10:29:32.341826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:32.341826 [info ] [MainThread]: 
[0m10:29:32.341826 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:29:32.341826 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:29:32.341826 after 10.62 seconds
[0m10:29:32.341826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249F96A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249FC73290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249FC73C20>]}
[0m10:29:32.346470 [debug] [MainThread]: Flushing usage events
[0m10:29:33.398654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:06.147316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DFCF3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DF99B770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DF99BD10>]}


============================== 10:32:06.151353 | 342087a6-c2c4-406a-aeab-c506e08a1294 ==============================
[0m10:32:06.151353 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:32:06.151353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:32:07.050369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E22A2A20>]}
[0m10:32:07.135273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E1B356A0>]}
[0m10:32:07.135273 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:32:07.735726 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:32:08.156720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:32:08.156720 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\customer_activity.sql
[0m10:32:08.610536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E2933440>]}
[0m10:32:08.801888 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:32:08.801888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:32:08.851078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E2604110>]}
[0m10:32:08.851078 [info ] [MainThread]: Found 6 models, 9 data tests, 1 snapshot, 1 seed, 3 sources, 594 macros
[0m10:32:08.856854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E292FD40>]}
[0m10:32:08.858882 [info ] [MainThread]: 
[0m10:32:08.858882 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:32:08.858882 [info ] [MainThread]: 
[0m10:32:08.858882 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:32:08.867931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:32:09.034069 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:32:09.034069 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:32:09.034069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:10.597252 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.563 seconds
[0m10:32:10.602252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:32:10.620663 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:32:10.621678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:32:10.622729 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:32:10.626398 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:32:10.627792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:10.627792 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:32:10.628818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:11.600783 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.973 seconds
[0m10:32:11.704042 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.078 seconds
[0m10:32:11.710147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DD0A4F20>]}
[0m10:32:11.716758 [debug] [Thread-1 (]: Began running node model.data_pipeline.customer_activity
[0m10:32:11.719968 [debug] [Thread-2 (]: Began running node model.data_pipeline.int_order_items
[0m10:32:11.719968 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_schema.customer_activity ...................... [RUN]
[0m10:32:11.722448 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.customer_activity'
[0m10:32:11.719968 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m10:32:11.724445 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.customer_activity
[0m10:32:11.724445 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m10:32:11.742193 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m10:32:11.743516 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.int_order_items
[0m10:32:11.751973 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m10:32:11.753657 [debug] [Thread-1 (]: Began executing node model.data_pipeline.customer_activity
[0m10:32:11.807479 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m10:32:11.809940 [debug] [Thread-2 (]: Began executing node model.data_pipeline.int_order_items
[0m10:32:11.813096 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m10:32:11.818820 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m10:32:11.818820 [debug] [Thread-1 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m10:32:11.818820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:32:11.824149 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m10:32:11.826364 [debug] [Thread-2 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m10:32:11.826364 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:32:12.490645 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfd44e-3202-0770-0010-8a120003105e
[0m10:32:12.492654 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 152 unexpected ';'.
[0m10:32:12.508461 [debug] [Thread-1 (]: Database Error in model customer_activity (models\marts\customer_activity.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 152 unexpected ';'.
  compiled code at target\run\data_pipeline\models\marts\customer_activity.sql
[0m10:32:12.518496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E3F7D100>]}
[0m10:32:12.518496 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_schema.customer_activity ............. [[31mERROR[0m in 0.79s]
[0m10:32:12.522526 [debug] [Thread-1 (]: Finished running node model.data_pipeline.customer_activity
[0m10:32:12.522526 [debug] [Thread-13 ]: Marking all children of 'model.data_pipeline.customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model customer_activity (models\marts\customer_activity.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 152 unexpected ';'.
  compiled code at target\run\data_pipeline\models\marts\customer_activity.sql.
[0m10:32:17.168111 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 5.341 seconds
[0m10:32:17.212108 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DCFBA8A0>]}
[0m10:32:17.213108 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 5.49s]
[0m10:32:17.215112 [debug] [Thread-2 (]: Finished running node model.data_pipeline.int_order_items
[0m10:32:17.216109 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items_summary
[0m10:32:17.216109 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m10:32:17.218271 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m10:32:17.218271 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m10:32:17.224631 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m10:32:17.226628 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m10:32:17.231637 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m10:32:17.234639 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m10:32:17.234639 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m10:32:17.235640 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:32:18.652720 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.417 seconds
[0m10:32:18.655747 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E3F7A2A0>]}
[0m10:32:18.656748 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 1.44s]
[0m10:32:18.658234 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m10:32:18.659230 [debug] [Thread-6 (]: Began running node model.data_pipeline.fct_orders
[0m10:32:18.660228 [info ] [Thread-6 (]: 4 of 4 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m10:32:18.661229 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m10:32:18.662230 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.fct_orders
[0m10:32:18.667254 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m10:32:18.668315 [debug] [Thread-6 (]: Began executing node model.data_pipeline.fct_orders
[0m10:32:18.672340 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m10:32:18.675340 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m10:32:18.676642 [debug] [Thread-6 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m10:32:18.676642 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m10:32:20.377448 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.700 seconds
[0m10:32:20.380452 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342087a6-c2c4-406a-aeab-c506e08a1294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E2EDAE70>]}
[0m10:32:20.381452 [info ] [Thread-6 (]: 4 of 4 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 1.72s]
[0m10:32:20.382460 [debug] [Thread-6 (]: Finished running node model.data_pipeline.fct_orders
[0m10:32:20.386208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:20.386208 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:32:20.387234 [debug] [MainThread]: On list_dbt_db: Close
[0m10:32:20.637058 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:32:20.638040 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:32:20.818942 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:32:20.819944 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:32:21.045740 [debug] [MainThread]: Connection 'model.data_pipeline.customer_activity' was left open.
[0m10:32:21.046750 [debug] [MainThread]: On model.data_pipeline.customer_activity: Close
[0m10:32:21.285235 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m10:32:21.285235 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m10:32:21.473978 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m10:32:21.474978 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m10:32:21.697101 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m10:32:21.698101 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m10:32:21.916487 [info ] [MainThread]: 
[0m10:32:21.918468 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.06 seconds (13.06s).
[0m10:32:21.919892 [debug] [MainThread]: Command end result
[0m10:32:21.960830 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:32:21.966114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:32:21.974575 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:32:21.975590 [info ] [MainThread]: 
[0m10:32:21.976577 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:32:21.976577 [info ] [MainThread]: 
[0m10:32:21.977579 [error] [MainThread]: [31mFailure in model customer_activity (models\marts\customer_activity.sql)[0m
[0m10:32:21.978575 [error] [MainThread]:   Database Error in model customer_activity (models\marts\customer_activity.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 152 unexpected ';'.
  compiled code at target\run\data_pipeline\models\marts\customer_activity.sql
[0m10:32:21.979574 [info ] [MainThread]: 
[0m10:32:21.980576 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\customer_activity.sql
[0m10:32:21.981975 [info ] [MainThread]: 
[0m10:32:21.981975 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m10:32:21.984468 [debug] [MainThread]: Command `dbt run` failed at 10:32:21.982991 after 16.09 seconds
[0m10:32:21.984468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DFFD6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DF6646B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221E26A6270>]}
[0m10:32:21.985486 [debug] [MainThread]: Flushing usage events
[0m10:32:23.260267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:38.954827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7DA97410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7DECEB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7E19B770>]}


============================== 10:32:38.968465 | df116ada-5f6d-4ca1-9bed-9172efb59f6b ==============================
[0m10:32:38.968465 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:32:38.969571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:32:39.839780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F00D9E990>]}
[0m10:32:39.926540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0059BE60>]}
[0m10:32:39.928526 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:32:40.376694 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:32:40.796529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:32:40.797528 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\customer_activity.sql
[0m10:32:41.184217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7AE918E0>]}
[0m10:32:41.338214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:32:41.346544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:32:41.382956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F010FA330>]}
[0m10:32:41.382956 [info ] [MainThread]: Found 6 models, 9 data tests, 1 snapshot, 1 seed, 3 sources, 594 macros
[0m10:32:41.384511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7D8CDEB0>]}
[0m10:32:41.385862 [info ] [MainThread]: 
[0m10:32:41.385862 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:32:41.388848 [info ] [MainThread]: 
[0m10:32:41.388848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:32:41.398026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:32:41.508428 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:32:41.508428 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:32:41.510206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:42.728905 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.219 seconds
[0m10:32:42.733757 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:32:42.754433 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:32:42.754433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:32:42.754433 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:32:42.767560 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:32:42.767560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:42.769575 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:32:42.769575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:43.509861 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.741 seconds
[0m10:32:43.706076 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.937 seconds
[0m10:32:43.708089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0118C170>]}
[0m10:32:43.722122 [debug] [Thread-1 (]: Began running node model.data_pipeline.customer_activity
[0m10:32:43.722122 [debug] [Thread-2 (]: Began running node model.data_pipeline.int_order_items
[0m10:32:43.722122 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_schema.customer_activity ...................... [RUN]
[0m10:32:43.726006 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.customer_activity'
[0m10:32:43.724632 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m10:32:43.727128 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.customer_activity
[0m10:32:43.727128 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m10:32:43.738241 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m10:32:43.739799 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.int_order_items
[0m10:32:43.750094 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m10:32:43.752104 [debug] [Thread-2 (]: Began executing node model.data_pipeline.int_order_items
[0m10:32:43.811431 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m10:32:43.813441 [debug] [Thread-1 (]: Began executing node model.data_pipeline.customer_activity
[0m10:32:43.822205 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m10:32:43.826090 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m10:32:43.826090 [debug] [Thread-2 (]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m10:32:43.827099 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:32:43.830264 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m10:32:43.833417 [debug] [Thread-1 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m10:32:43.833417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:32:45.066833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.232 seconds
[0m10:32:45.105328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7DE50B00>]}
[0m10:32:45.107092 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_schema.customer_activity ................. [[32mSUCCESS 1[0m in 1.38s]
[0m10:32:45.108106 [debug] [Thread-1 (]: Finished running node model.data_pipeline.customer_activity
[0m10:32:48.714709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.898 seconds
[0m10:32:48.731974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F02B01460>]}
[0m10:32:48.733985 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 5.00s]
[0m10:32:48.735997 [debug] [Thread-2 (]: Finished running node model.data_pipeline.int_order_items
[0m10:32:48.735997 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items_summary
[0m10:32:48.738005 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m10:32:48.738005 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m10:32:48.740015 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m10:32:48.744037 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m10:32:48.746047 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m10:32:48.751654 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m10:32:48.754720 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m10:32:48.754720 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m10:32:48.754720 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:32:50.460584 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.710 seconds
[0m10:32:50.460584 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F02AD9A30>]}
[0m10:32:50.460584 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 1.72s]
[0m10:32:50.460584 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m10:32:50.472956 [debug] [Thread-6 (]: Began running node model.data_pipeline.fct_orders
[0m10:32:50.472956 [info ] [Thread-6 (]: 4 of 4 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m10:32:50.472956 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_orders'
[0m10:32:50.472956 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.fct_orders
[0m10:32:50.477428 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m10:32:50.477428 [debug] [Thread-6 (]: Began executing node model.data_pipeline.fct_orders
[0m10:32:50.484503 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m10:32:50.484503 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m10:32:50.484503 [debug] [Thread-6 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m10:32:50.488683 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m10:32:52.647886 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.167 seconds
[0m10:32:52.658477 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df116ada-5f6d-4ca1-9bed-9172efb59f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F02AE31D0>]}
[0m10:32:52.658477 [info ] [Thread-6 (]: 4 of 4 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 2.19s]
[0m10:32:52.658477 [debug] [Thread-6 (]: Finished running node model.data_pipeline.fct_orders
[0m10:32:52.663786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:52.663786 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:32:52.663786 [debug] [MainThread]: On list_dbt_db: Close
[0m10:32:52.909054 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:32:52.909054 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:32:53.074524 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:32:53.074524 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:32:53.308941 [debug] [MainThread]: Connection 'model.data_pipeline.customer_activity' was left open.
[0m10:32:53.312405 [debug] [MainThread]: On model.data_pipeline.customer_activity: Close
[0m10:32:53.627660 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m10:32:53.627660 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m10:32:53.855298 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m10:32:53.855298 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m10:32:54.123459 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m10:32:54.123459 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m10:32:54.356964 [info ] [MainThread]: 
[0m10:32:54.356964 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.97 seconds (12.97s).
[0m10:32:54.373886 [debug] [MainThread]: Command end result
[0m10:32:54.425297 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:32:54.431966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:32:54.441545 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:32:54.441545 [info ] [MainThread]: 
[0m10:32:54.441545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:32:54.441545 [info ] [MainThread]: 
[0m10:32:54.441545 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m10:32:54.441545 [debug] [MainThread]: Command `dbt run` succeeded at 10:32:54.441545 after 15.66 seconds
[0m10:32:54.441545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7FB10560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7FB10DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F7B837CB0>]}
[0m10:32:54.441545 [debug] [MainThread]: Flushing usage events
[0m10:32:55.439339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:45.887578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A4AE34D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A4A478F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A748FFB0>]}


============================== 10:34:45.896081 | 93cbec0a-cb2b-4e9d-b06e-81bf696e7b56 ==============================
[0m10:34:45.896081 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:34:45.896680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:34:46.661279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93cbec0a-cb2b-4e9d-b06e-81bf696e7b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A9973FE0>]}
[0m10:34:46.751899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93cbec0a-cb2b-4e9d-b06e-81bf696e7b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A98D18B0>]}
[0m10:34:46.753902 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:34:47.186732 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:34:47.592663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:34:47.594573 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://seeds\customers.csv
[0m10:34:47.947452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93cbec0a-cb2b-4e9d-b06e-81bf696e7b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AA541190>]}
[0m10:34:48.097701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:34:48.101105 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:34:48.153360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93cbec0a-cb2b-4e9d-b06e-81bf696e7b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AA24F800>]}
[0m10:34:48.155382 [info ] [MainThread]: Found 6 models, 9 data tests, 1 snapshot, 1 seed, 3 sources, 594 macros
[0m10:34:48.155382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93cbec0a-cb2b-4e9d-b06e-81bf696e7b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AA238710>]}
[0m10:34:48.157389 [info ] [MainThread]: 
[0m10:34:48.157389 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:34:48.157389 [info ] [MainThread]: 
[0m10:34:48.160893 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:34:48.161748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:34:48.271811 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:34:48.273820 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:34:48.273820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:49.762541 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.488 seconds
[0m10:34:49.773947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:34:49.781775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:34:49.803012 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:34:49.808012 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:34:49.809010 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:34:49.810009 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:34:49.811009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:49.811517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:50.329538 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.519 seconds
[0m10:34:50.584252 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.773 seconds
[0m10:34:50.588244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93cbec0a-cb2b-4e9d-b06e-81bf696e7b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AA5992E0>]}
[0m10:34:50.597590 [debug] [Thread-1 (]: Began running node seed.data_pipeline.customers
[0m10:34:50.598790 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.customers .................................... [RUN]
[0m10:34:50.599926 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m10:34:50.599926 [debug] [Thread-1 (]: Began compiling node seed.data_pipeline.customers
[0m10:34:50.600930 [debug] [Thread-1 (]: Began executing node seed.data_pipeline.customers
[0m10:34:50.668416 [debug] [Thread-1 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."CUSTOMERS"
[0m10:34:50.679292 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:34:50.679916 [debug] [Thread-1 (]: On seed.data_pipeline.customers: drop table if exists "DBT_DB"."DBT_SCHEMA"."CUSTOMERS" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:34:50.680898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:34:51.644986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m10:34:51.675002 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:34:51.675002 [debug] [Thread-1 (]: On seed.data_pipeline.customers: create table dbt_db.dbt_schema.customers (customer_id integer,customer_name text,customer_status text,updated_at timestamp without time zone)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:34:51.873245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m10:34:51.892975 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:34:51.892975 [debug] [Thread-1 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:34:52.072949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m10:34:52.074022 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:34:52.074557 [debug] [Thread-1 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m10:34:52.482972 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.407 seconds
[0m10:34:52.482972 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:34:52.482972 [debug] [Thread-1 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:34:52.970697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m10:34:52.978697 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m10:34:53.014790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93cbec0a-cb2b-4e9d-b06e-81bf696e7b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AAB2A210>]}
[0m10:34:53.015887 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.customers ................................ [[32mCREATE 4[0m in 2.41s]
[0m10:34:53.016927 [debug] [Thread-1 (]: Finished running node seed.data_pipeline.customers
[0m10:34:53.019601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:53.020739 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:34:53.020739 [debug] [MainThread]: On list_dbt_db: Close
[0m10:34:53.218461 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:34:53.219581 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:34:53.399263 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:34:53.400263 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:34:53.631464 [debug] [MainThread]: Connection 'seed.data_pipeline.customers' was left open.
[0m10:34:53.631464 [debug] [MainThread]: On seed.data_pipeline.customers: Close
[0m10:34:53.882283 [info ] [MainThread]: 
[0m10:34:53.884286 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m10:34:53.885519 [debug] [MainThread]: Command end result
[0m10:34:53.934206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:34:53.939215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:34:53.948695 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:34:53.949711 [info ] [MainThread]: 
[0m10:34:53.950705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:34:53.951705 [info ] [MainThread]: 
[0m10:34:53.953190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:34:53.954187 [debug] [MainThread]: Command `dbt seed` succeeded at 10:34:53.954187 after 8.34 seconds
[0m10:34:53.955188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A7A1CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A705CC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A705F890>]}
[0m10:34:53.956206 [debug] [MainThread]: Flushing usage events
[0m10:34:55.270362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:03.961655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156B76993A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BB048320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BAAB30B0>]}


============================== 10:35:03.970978 | 2491ee08-9777-44c1-be86-ded071c6fade ==============================
[0m10:35:03.970978 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:35:03.970978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:35:04.752030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2491ee08-9777-44c1-be86-ded071c6fade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BD62EA50>]}
[0m10:35:04.850328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2491ee08-9777-44c1-be86-ded071c6fade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BD491130>]}
[0m10:35:04.850328 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:35:05.288462 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:35:05.707166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:05.707166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:05.820588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2491ee08-9777-44c1-be86-ded071c6fade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BD7DADE0>]}
[0m10:35:05.981628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:35:05.983430 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:35:06.033490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2491ee08-9777-44c1-be86-ded071c6fade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BDBF9340>]}
[0m10:35:06.033490 [info ] [MainThread]: Found 6 models, 9 data tests, 1 snapshot, 1 seed, 3 sources, 594 macros
[0m10:35:06.038642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2491ee08-9777-44c1-be86-ded071c6fade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BD9443B0>]}
[0m10:35:06.042111 [info ] [MainThread]: 
[0m10:35:06.042111 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:35:06.043606 [info ] [MainThread]: 
[0m10:35:06.043606 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:35:06.046184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:35:06.159348 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:35:06.162953 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:35:06.162953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:07.651187 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.488 seconds
[0m10:35:07.660668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:35:07.661680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:35:07.680263 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:35:07.683962 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:35:07.683962 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:35:07.684978 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:35:07.685717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:07.686312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:08.549775 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.864 seconds
[0m10:35:08.714761 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.028 seconds
[0m10:35:08.720442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2491ee08-9777-44c1-be86-ded071c6fade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BDB737A0>]}
[0m10:35:08.729158 [debug] [Thread-1 (]: Began running node snapshot.data_pipeline.customer_snapshot
[0m10:35:08.730170 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customer_snapshot .............................. [RUN]
[0m10:35:08.731171 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.data_pipeline.customer_snapshot'
[0m10:35:08.732399 [debug] [Thread-1 (]: Began compiling node snapshot.data_pipeline.customer_snapshot
[0m10:35:08.746418 [debug] [Thread-1 (]: Began executing node snapshot.data_pipeline.customer_snapshot
[0m10:35:08.832017 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:08.833014 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:08.833014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:35:09.402938 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.569 seconds
[0m10:35:09.475292 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:09.476292 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m10:35:10.230322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m10:35:10.235338 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:10.236338 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:10.667083 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.430 seconds
[0m10:35:10.673091 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:10.674093 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:11.006946 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.332 seconds
[0m10:35:11.011944 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:11.012946 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:11.170045 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.156 seconds
[0m10:35:11.176369 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:11.176369 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:11.301037 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.124 seconds
[0m10:35:11.312006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:11.312006 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:11.465531 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.152 seconds
[0m10:35:11.495922 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:11.496925 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:11.795395 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.297 seconds
[0m10:35:11.803521 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:11.804524 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:11.913516 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m10:35:11.914516 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot"
[0m10:35:11.916515 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:11.917516 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:12.122059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m10:35:12.123446 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:12.124472 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m10:35:12.698923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m10:35:12.699923 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m10:35:12.700923 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m10:35:12.945774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m10:35:12.978701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2491ee08-9777-44c1-be86-ded071c6fade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BE1B1220>]}
[0m10:35:12.979688 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customer_snapshot .............................. [[32mSUCCESS 1[0m in 4.24s]
[0m10:35:12.980750 [debug] [Thread-1 (]: Finished running node snapshot.data_pipeline.customer_snapshot
[0m10:35:12.982933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:12.984409 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:35:12.984409 [debug] [MainThread]: On list_dbt_db: Close
[0m10:35:13.208353 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:35:13.209359 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:35:13.455624 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:35:13.456902 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:35:13.689458 [debug] [MainThread]: Connection 'snapshot.data_pipeline.customer_snapshot' was left open.
[0m10:35:13.689458 [debug] [MainThread]: On snapshot.data_pipeline.customer_snapshot: Close
[0m10:35:13.935268 [info ] [MainThread]: 
[0m10:35:13.937268 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m10:35:13.938160 [debug] [MainThread]: Command end result
[0m10:35:13.979187 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:35:13.983185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:35:13.992190 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:35:13.992190 [info ] [MainThread]: 
[0m10:35:13.993194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:13.994451 [info ] [MainThread]: 
[0m10:35:13.994916 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:35:13.996273 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:35:13.996273 after 10.19 seconds
[0m10:35:13.997339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156B8147EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BA69D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BA69D580>]}
[0m10:35:13.997339 [debug] [MainThread]: Flushing usage events
[0m10:35:15.167275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:31.692481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FC0C3F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FCB80320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FC974200>]}


============================== 10:35:31.700066 | 6bcf3f1e-4658-4aab-85c4-79ab9e1dcfe2 ==============================
[0m10:35:31.700066 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:35:31.700066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select customer_activity', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:32.495861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bcf3f1e-4658-4aab-85c4-79ab9e1dcfe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FDF45BB0>]}
[0m10:35:32.592775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bcf3f1e-4658-4aab-85c4-79ab9e1dcfe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FE7DBE60>]}
[0m10:35:32.592775 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:35:33.047993 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:35:33.409152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:33.411158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:33.501698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bcf3f1e-4658-4aab-85c4-79ab9e1dcfe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FF016900>]}
[0m10:35:33.664881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:35:33.675950 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:35:33.713760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bcf3f1e-4658-4aab-85c4-79ab9e1dcfe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FF516B40>]}
[0m10:35:33.715508 [info ] [MainThread]: Found 6 models, 9 data tests, 1 snapshot, 1 seed, 3 sources, 594 macros
[0m10:35:33.715508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bcf3f1e-4658-4aab-85c4-79ab9e1dcfe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FF25C500>]}
[0m10:35:33.718304 [info ] [MainThread]: 
[0m10:35:33.718304 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:35:33.718304 [info ] [MainThread]: 
[0m10:35:33.720966 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:35:33.722224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:35:33.857921 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:35:33.857921 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:35:33.857921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:35.214366 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.356 seconds
[0m10:35:35.222432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:35:35.230859 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:35:35.247407 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:35:35.253781 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:35:35.255533 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:35:35.255988 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:35:35.255988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:35.255988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:36.032260 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.781 seconds
[0m10:35:36.113243 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.863 seconds
[0m10:35:36.125735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bcf3f1e-4658-4aab-85c4-79ab9e1dcfe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F9DD49B0>]}
[0m10:35:36.135806 [debug] [Thread-1 (]: Began running node model.data_pipeline.customer_activity
[0m10:35:36.137004 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.customer_activity ...................... [RUN]
[0m10:35:36.139538 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.customer_activity'
[0m10:35:36.139538 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.customer_activity
[0m10:35:36.151653 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m10:35:36.153661 [debug] [Thread-1 (]: Began executing node model.data_pipeline.customer_activity
[0m10:35:36.200542 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m10:35:36.204390 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m10:35:36.204390 [debug] [Thread-1 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m10:35:36.204390 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:35:37.586788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.381 seconds
[0m10:35:37.618312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bcf3f1e-4658-4aab-85c4-79ab9e1dcfe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F9CEA210>]}
[0m10:35:37.619667 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_schema.customer_activity ................. [[32mSUCCESS 1[0m in 1.48s]
[0m10:35:37.620689 [debug] [Thread-1 (]: Finished running node model.data_pipeline.customer_activity
[0m10:35:37.622817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:37.623878 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:35:37.623878 [debug] [MainThread]: On list_dbt_db: Close
[0m10:35:37.854174 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:35:37.855178 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:35:38.180772 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:35:38.181776 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:35:38.437936 [debug] [MainThread]: Connection 'model.data_pipeline.customer_activity' was left open.
[0m10:35:38.438936 [debug] [MainThread]: On model.data_pipeline.customer_activity: Close
[0m10:35:38.612981 [info ] [MainThread]: 
[0m10:35:38.613981 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m10:35:38.615993 [debug] [MainThread]: Command end result
[0m10:35:38.663589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:35:38.669298 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:35:38.681189 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:35:38.682188 [info ] [MainThread]: 
[0m10:35:38.683576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:38.685576 [info ] [MainThread]: 
[0m10:35:38.686596 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:35:38.689598 [debug] [MainThread]: Command `dbt run` succeeded at 10:35:38.689598 after 7.16 seconds
[0m10:35:38.690598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FCCA5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FEF160F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FEF176E0>]}
[0m10:35:38.692609 [debug] [MainThread]: Flushing usage events
[0m10:35:39.818388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:50.187830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D099A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D04D0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171CDD07980>]}


============================== 10:37:50.195654 | 358daf49-11ec-4020-bf40-22f5f211e036 ==============================
[0m10:37:50.195654 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:37:50.196635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select customer_snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:37:50.985849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '358daf49-11ec-4020-bf40-22f5f211e036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D31B6660>]}
[0m10:37:51.076956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '358daf49-11ec-4020-bf40-22f5f211e036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D24BF860>]}
[0m10:37:51.078960 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:37:51.586397 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:37:51.962121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:37:51.963121 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\snapshot_schema.yml
[0m10:37:51.963121 [debug] [MainThread]: Partial parsing: added file: data_pipeline://tests\unique_current_customer.sql
[0m10:37:52.385585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '358daf49-11ec-4020-bf40-22f5f211e036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D37C7AD0>]}
[0m10:37:52.543688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:37:52.547688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:37:52.612278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '358daf49-11ec-4020-bf40-22f5f211e036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D3971370>]}
[0m10:37:52.612278 [info ] [MainThread]: Found 6 models, 13 data tests, 1 snapshot, 1 seed, 3 sources, 594 macros
[0m10:37:52.613751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358daf49-11ec-4020-bf40-22f5f211e036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D3723E30>]}
[0m10:37:52.616029 [info ] [MainThread]: 
[0m10:37:52.617030 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:37:52.618025 [info ] [MainThread]: 
[0m10:37:52.619240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:37:52.628554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:37:52.652030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:37:52.798003 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:37:52.798003 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:37:52.799001 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:37:52.800001 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:37:52.800001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:52.801102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:54.026432 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.226 seconds
[0m10:37:54.044528 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.244 seconds
[0m10:37:54.048828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358daf49-11ec-4020-bf40-22f5f211e036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D329B4A0>]}
[0m10:37:54.061497 [debug] [Thread-1 (]: Began running node test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd
[0m10:37:54.061497 [debug] [Thread-2 (]: Began running node test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82
[0m10:37:54.063565 [debug] [Thread-3 (]: Began running node test.data_pipeline.unique_current_customer
[0m10:37:54.064422 [debug] [Thread-4 (]: Began running node test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93
[0m10:37:54.063565 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_not_null_customer_snapshot_customer_id ............. [RUN]
[0m10:37:54.065028 [info ] [Thread-2 (]: 2 of 4 START test dbt_utils_unique_customer_snapshot_customer_id ............... [RUN]
[0m10:37:54.068407 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd'
[0m10:37:54.065028 [info ] [Thread-3 (]: 3 of 4 START test unique_current_customer ...................................... [RUN]
[0m10:37:54.068407 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82'
[0m10:37:54.067227 [info ] [Thread-4 (]: 4 of 4 START test unique_current_customer_customer_snapshot_ ................... [RUN]
[0m10:37:54.069913 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd
[0m10:37:54.069913 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_current_customer'
[0m10:37:54.071921 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82
[0m10:37:54.071921 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93'
[0m10:37:54.086154 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.unique_current_customer
[0m10:37:54.094730 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93
[0m10:37:54.099216 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.unique_current_customer"
[0m10:37:54.111599 [debug] [Thread-3 (]: Began executing node test.data_pipeline.unique_current_customer
[0m10:37:54.180157 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.unique_current_customer"
[0m10:37:54.183923 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.unique_current_customer"
[0m10:37:54.199348 [debug] [Thread-3 (]: On test.data_pipeline.unique_current_customer: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Ensure there is only one current record per customer in the snapshot

SELECT 
    customer_id
FROM dbt_db.snapshots.customer_snapshot
WHERE dbt_valid_to IS NULL
GROUP BY customer_id
HAVING COUNT(*) > 1
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_current_customer"} */
[0m10:37:54.199348 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:37:54.271590 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_not_null_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_not_null'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:37:54.272802 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_unique'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:37:54.272802 [error] [Thread-1 (]: 1 of 4 ERROR dbt_utils_not_null_customer_snapshot_customer_id .................. [[31mERROR[0m in 0.21s]
[0m10:37:54.277129 [debug] [Thread-1 (]: Finished running node test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd
[0m10:37:54.278461 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_not_null'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:37:54.275768 [error] [Thread-2 (]: 2 of 4 ERROR dbt_utils_unique_customer_snapshot_customer_id .................... [[31mERROR[0m in 0.20s]
[0m10:37:54.280734 [debug] [Thread-4 (]: Compilation Error in test unique_current_customer_customer_snapshot_ (snapshots\snapshot_schema.yml)
  'test_unique_current_customer' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:37:54.280734 [debug] [Thread-2 (]: Finished running node test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82
[0m10:37:54.284771 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_unique'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:37:54.283362 [error] [Thread-4 (]: 4 of 4 ERROR unique_current_customer_customer_snapshot_ ........................ [[31mERROR[0m in 0.21s]
[0m10:37:54.286112 [debug] [Thread-4 (]: Finished running node test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93
[0m10:37:54.286112 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_current_customer_customer_snapshot_ (snapshots\snapshot_schema.yml)
  'test_unique_current_customer' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:37:54.965214 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m10:37:54.977214 [info ] [Thread-3 (]: 3 of 4 PASS unique_current_customer ............................................ [[32mPASS[0m in 0.91s]
[0m10:37:54.978665 [debug] [Thread-3 (]: Finished running node test.data_pipeline.unique_current_customer
[0m10:37:54.982072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:54.982072 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:37:54.983102 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:37:55.164345 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:37:55.165348 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:37:55.624175 [debug] [MainThread]: Connection 'test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd' was properly closed.
[0m10:37:55.625213 [debug] [MainThread]: Connection 'test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82' was properly closed.
[0m10:37:55.625213 [debug] [MainThread]: Connection 'test.data_pipeline.unique_current_customer' was left open.
[0m10:37:55.626213 [debug] [MainThread]: On test.data_pipeline.unique_current_customer: Close
[0m10:37:55.880634 [debug] [MainThread]: Connection 'test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93' was properly closed.
[0m10:37:55.881672 [info ] [MainThread]: 
[0m10:37:55.882652 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m10:37:55.884765 [debug] [MainThread]: Command end result
[0m10:37:55.930342 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:37:55.934344 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:37:55.944751 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:37:55.945752 [info ] [MainThread]: 
[0m10:37:55.945752 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m10:37:55.946906 [info ] [MainThread]: 
[0m10:37:55.947923 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)[0m
[0m10:37:55.948946 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_not_null'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:37:55.949942 [info ] [MainThread]: 
[0m10:37:55.950961 [error] [MainThread]: [31mFailure in test dbt_utils_unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)[0m
[0m10:37:55.951947 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_unique'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:37:55.952970 [info ] [MainThread]: 
[0m10:37:55.953971 [error] [MainThread]: [31mFailure in test unique_current_customer_customer_snapshot_ (snapshots\snapshot_schema.yml)[0m
[0m10:37:55.955307 [error] [MainThread]:   Compilation Error in test unique_current_customer_customer_snapshot_ (snapshots\snapshot_schema.yml)
  'test_unique_current_customer' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:37:55.956303 [info ] [MainThread]: 
[0m10:37:55.956647 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=4
[0m10:37:55.958541 [debug] [MainThread]: Command `dbt test` failed at 10:37:55.958541 after 6.01 seconds
[0m10:37:55.959580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D04D0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D0FE1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D0FE1F10>]}
[0m10:37:55.960560 [debug] [MainThread]: Flushing usage events
[0m10:37:57.412029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:51.245900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042D01A300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204300A57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042DAC88C0>]}


============================== 10:38:51.245900 | a519e3c6-120f-494b-b63b-46ea9c01de4c ==============================
[0m10:38:51.245900 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:38:51.245900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:38:51.463359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a519e3c6-120f-494b-b63b-46ea9c01de4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042D11B320>]}
[0m10:38:51.592185 [debug] [MainThread]: Set downloads directory='C:\Users\lenovo\AppData\Local\Temp\dbt-downloads-degiof01'
[0m10:38:51.595584 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:38:52.258241 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:38:52.258241 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:38:52.505796 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:38:52.511825 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:38:53.523550 [info ] [MainThread]: Installed from version 1.3.1
[0m10:38:53.523550 [info ] [MainThread]: Up to date!
[0m10:38:53.524551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a519e3c6-120f-494b-b63b-46ea9c01de4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020431411340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204314459D0>]}
[0m10:38:53.527559 [debug] [MainThread]: Command `dbt deps` succeeded at 10:38:53.527559 after 2.47 seconds
[0m10:38:53.528559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204301F1A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042D410B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042D11B320>]}
[0m10:38:53.528559 [debug] [MainThread]: Flushing usage events
[0m10:38:54.672054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:16.419725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BC17A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE99B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BE5CFCE0>]}


============================== 10:39:16.426750 | 752a1a58-ee46-450d-a8ee-10fe690dfaa8 ==============================
[0m10:39:16.426750 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:39:16.427750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:39:17.232300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '752a1a58-ee46-450d-a8ee-10fe690dfaa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C1436DE0>]}
[0m10:39:17.315385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '752a1a58-ee46-450d-a8ee-10fe690dfaa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C1416CF0>]}
[0m10:39:17.317394 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:39:17.760623 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:39:18.040290 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:39:18.042299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '752a1a58-ee46-450d-a8ee-10fe690dfaa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BED4ECC0>]}
[0m10:39:21.337082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '752a1a58-ee46-450d-a8ee-10fe690dfaa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C158C710>]}
[0m10:39:21.510357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:39:21.514932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:39:21.563333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '752a1a58-ee46-450d-a8ee-10fe690dfaa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C1C231D0>]}
[0m10:39:21.563985 [info ] [MainThread]: Found 6 models, 1 snapshot, 13 data tests, 1 seed, 3 sources, 594 macros
[0m10:39:21.564993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '752a1a58-ee46-450d-a8ee-10fe690dfaa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C19EA540>]}
[0m10:39:21.568004 [info ] [MainThread]: 
[0m10:39:21.568004 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:39:21.569019 [info ] [MainThread]: 
[0m10:39:21.570019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:39:21.580378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:39:21.608378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:39:21.703826 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:39:21.703826 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:39:21.704827 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:39:21.705820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:21.706824 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:39:21.707825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:23.302925 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.607 seconds
[0m10:39:23.318672 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.611 seconds
[0m10:39:23.326256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '752a1a58-ee46-450d-a8ee-10fe690dfaa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C1A9DA00>]}
[0m10:39:23.335481 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m10:39:23.335481 [debug] [Thread-2 (]: Began running node test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd
[0m10:39:23.335481 [debug] [Thread-3 (]: Began running node test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82
[0m10:39:23.338969 [debug] [Thread-4 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m10:39:23.338969 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_fct_orders_status_code__P__O__F ............. [RUN]
[0m10:39:23.340474 [debug] [Thread-5 (]: Began running node test.data_pipeline.fct_orders_discount
[0m10:39:23.341901 [debug] [Thread-6 (]: Began running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m10:39:23.341157 [info ] [Thread-2 (]: 2 of 13 START test dbt_utils_not_null_customer_snapshot_customer_id ............ [RUN]
[0m10:39:23.341901 [debug] [Thread-7 (]: Began running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m10:39:23.341901 [debug] [Thread-8 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m10:39:23.341901 [info ] [Thread-3 (]: 3 of 13 START test dbt_utils_unique_customer_snapshot_customer_id .............. [RUN]
[0m10:39:23.341901 [debug] [Thread-9 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m10:39:23.347049 [debug] [Thread-10 ]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m10:39:23.347049 [info ] [Thread-4 (]: 4 of 13 START test fct_orders_date_valid ....................................... [RUN]
[0m10:39:23.348749 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048'
[0m10:39:23.348749 [info ] [Thread-5 (]: 5 of 13 START test fct_orders_discount ......................................... [RUN]
[0m10:39:23.348749 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd'
[0m10:39:23.348749 [info ] [Thread-6 (]: 6 of 13 START test not_null_fct_orders_order_key ............................... [RUN]
[0m10:39:23.352453 [info ] [Thread-7 (]: 7 of 13 START test relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m10:39:23.354683 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82'
[0m10:39:23.352963 [info ] [Thread-8 (]: 8 of 13 START test source_not_null_tpch_orders_o_orderkey ...................... [RUN]
[0m10:39:23.356662 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_date_valid'
[0m10:39:23.355837 [info ] [Thread-9 (]: 9 of 13 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m10:39:23.358568 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m10:39:23.359591 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m10:39:23.356662 [info ] [Thread-10 ]: 10 of 13 START test source_unique_tpch_orders_o_orderkey ....................... [RUN]
[0m10:39:23.359591 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd
[0m10:39:23.361601 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15'
[0m10:39:23.363110 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce'
[0m10:39:23.363110 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82
[0m10:39:23.363110 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m10:39:23.365119 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m10:39:23.365119 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m10:39:23.378591 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m10:39:23.383628 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m10:39:23.383628 [debug] [Thread-10 ]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m10:39:23.386849 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m10:39:23.386849 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m10:39:23.396665 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m10:39:23.405152 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m10:39:23.407175 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m10:39:23.413580 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m10:39:23.413580 [debug] [Thread-10 ]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m10:39:23.413580 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m10:39:23.425278 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m10:39:23.436693 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m10:39:23.442547 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m10:39:23.450389 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m10:39:23.460601 [debug] [Thread-10 ]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m10:39:23.485674 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m10:39:23.485674 [debug] [Thread-5 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m10:39:23.485674 [debug] [Thread-4 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m10:39:23.485674 [debug] [Thread-6 (]: Began executing node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m10:39:23.497729 [debug] [Thread-7 (]: Began executing node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m10:39:23.498737 [debug] [Thread-8 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m10:39:23.505369 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m10:39:23.508384 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m10:39:23.508384 [debug] [Thread-10 ]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m10:39:23.514804 [debug] [Thread-9 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m10:39:23.516813 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m10:39:23.518819 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m10:39:23.518819 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m10:39:23.518819 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m10:39:23.526398 [debug] [Thread-10 ]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m10:39:23.530739 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m10:39:23.532635 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m10:39:23.534648 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m10:39:23.535981 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_orders
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"} */
[0m10:39:23.537497 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m10:39:23.541402 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_unique'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:39:23.541402 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_not_null_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_not_null'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:39:23.541402 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m10:39:23.541402 [debug] [Thread-5 (]: On test.data_pipeline.fct_orders_discount: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    item_discount_amount > 0
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
[0m10:39:23.545468 [debug] [Thread-4 (]: On test.data_pipeline.fct_orders_date_valid: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
[0m10:39:23.546476 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m10:39:23.546476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:39:23.546476 [debug] [Thread-10 ]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m10:39:23.546476 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m10:39:23.546476 [debug] [Thread-7 (]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_orders
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"} */
[0m10:39:23.546476 [error] [Thread-3 (]: 3 of 13 ERROR dbt_utils_unique_customer_snapshot_customer_id ................... [[31mERROR[0m in 0.19s]
[0m10:39:23.554411 [debug] [Thread-6 (]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_key
from dbt_db.dbt_schema.fct_orders
where order_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"} */
[0m10:39:23.554411 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m10:39:23.546476 [error] [Thread-2 (]: 2 of 13 ERROR dbt_utils_not_null_customer_snapshot_customer_id ................. [[31mERROR[0m in 0.20s]
[0m10:39:23.554411 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:39:23.556830 [debug] [Thread-8 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
[0m10:39:23.556830 [debug] [Thread-10 ]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
[0m10:39:23.559874 [debug] [Thread-9 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
[0m10:39:23.561700 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m10:39:23.563165 [debug] [Thread-3 (]: Finished running node test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82
[0m10:39:23.564416 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m10:39:23.566223 [debug] [Thread-2 (]: Finished running node test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd
[0m10:39:23.568933 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m10:39:23.571346 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m10:39:23.573938 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m10:39:23.575947 [debug] [Thread-3 (]: Began running node test.data_pipeline.unique_current_customer
[0m10:39:23.575947 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_unique'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:39:23.575947 [debug] [Thread-2 (]: Began running node test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93
[0m10:39:23.586055 [info ] [Thread-3 (]: 11 of 13 START test unique_current_customer .................................... [RUN]
[0m10:39:23.588065 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_not_null_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_not_null'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:39:23.592978 [info ] [Thread-2 (]: 12 of 13 START test unique_current_customer_customer_snapshot_ ................. [RUN]
[0m10:39:23.594833 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_pipeline.dbt_utils_unique_customer_snapshot_customer_id.d80775ed82, now test.data_pipeline.unique_current_customer)
[0m10:39:23.594833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_pipeline.dbt_utils_not_null_customer_snapshot_customer_id.db34e7dddd, now test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93)
[0m10:39:23.594833 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.unique_current_customer
[0m10:39:23.598471 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93
[0m10:39:23.606002 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.unique_current_customer"
[0m10:39:23.613696 [debug] [Thread-2 (]: Compilation Error in test unique_current_customer_customer_snapshot_ (snapshots\snapshot_schema.yml)
  'test_unique_current_customer' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:39:23.615707 [error] [Thread-2 (]: 12 of 13 ERROR unique_current_customer_customer_snapshot_ ...................... [[31mERROR[0m in 0.02s]
[0m10:39:23.616627 [debug] [Thread-2 (]: Finished running node test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93
[0m10:39:23.616627 [debug] [Thread-3 (]: Began executing node test.data_pipeline.unique_current_customer
[0m10:39:23.616627 [debug] [Thread-2 (]: Began running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m10:39:23.616627 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_current_customer_customer_snapshot_ (snapshots\snapshot_schema.yml)
  'test_unique_current_customer' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:39:23.637890 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.unique_current_customer"
[0m10:39:23.655911 [info ] [Thread-2 (]: 13 of 13 START test unique_fct_orders_order_key ................................ [RUN]
[0m10:39:23.670253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_pipeline.unique_current_customer_customer_snapshot_.e2f933bf93, now test.data_pipeline.unique_fct_orders_order_key.f5e7a90273)
[0m10:39:23.670253 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m10:39:23.679107 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m10:39:23.683873 [debug] [Thread-2 (]: Began executing node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m10:39:23.688598 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m10:39:23.693942 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m10:39:23.694305 [debug] [Thread-2 (]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_orders
where order_key is not null
group by order_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"} */
[0m10:39:23.696340 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:39:23.702376 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.unique_current_customer"
[0m10:39:23.703887 [debug] [Thread-3 (]: On test.data_pipeline.unique_current_customer: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Ensure there is only one current record per customer in the snapshot

SELECT 
    customer_id
FROM dbt_db.snapshots.customer_snapshot
WHERE dbt_valid_to IS NULL
GROUP BY customer_id
HAVING COUNT(*) > 1
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_current_customer"} */
[0m10:39:23.703887 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:39:24.278736 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m10:39:24.290065 [info ] [Thread-6 (]: 6 of 13 PASS not_null_fct_orders_order_key ..................................... [[32mPASS[0m in 0.93s]
[0m10:39:24.294467 [debug] [Thread-6 (]: Finished running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m10:39:24.361064 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.806 seconds
[0m10:39:24.361064 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m10:39:24.363256 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.794 seconds
[0m10:39:24.363256 [info ] [Thread-5 (]: 5 of 13 PASS fct_orders_discount ............................................... [[32mPASS[0m in 1.00s]
[0m10:39:24.370628 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m10:39:24.368620 [info ] [Thread-4 (]: 4 of 13 PASS fct_orders_date_valid ............................................. [[32mPASS[0m in 1.01s]
[0m10:39:24.374779 [debug] [Thread-5 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m10:39:24.370628 [info ] [Thread-10 ]: 10 of 13 PASS source_unique_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 0.99s]
[0m10:39:24.381206 [debug] [Thread-4 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m10:39:24.381206 [info ] [Thread-8 (]: 8 of 13 PASS source_not_null_tpch_orders_o_orderkey ............................ [[32mPASS[0m in 1.02s]
[0m10:39:24.385466 [debug] [Thread-10 ]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m10:39:24.385466 [debug] [Thread-8 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m10:39:24.689196 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 1.115 seconds
[0m10:39:24.689196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.143 seconds
[0m10:39:24.699338 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m10:39:24.699338 [info ] [Thread-9 (]: 9 of 13 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 1.33s]
[0m10:39:24.703735 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_fct_orders_status_code__P__O__F ................... [[32mPASS[0m in 1.36s]
[0m10:39:24.708810 [debug] [Thread-9 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m10:39:24.710638 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m10:39:24.706251 [info ] [Thread-3 (]: 11 of 13 PASS unique_current_customer .......................................... [[32mPASS[0m in 1.11s]
[0m10:39:24.712682 [debug] [Thread-3 (]: Finished running node test.data_pipeline.unique_current_customer
[0m10:39:24.928187 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.232 seconds
[0m10:39:24.932208 [info ] [Thread-2 (]: 13 of 13 PASS unique_fct_orders_order_key ...................................... [[32mPASS[0m in 1.26s]
[0m10:39:24.932208 [debug] [Thread-2 (]: Finished running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m10:39:25.428561 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.866 seconds
[0m10:39:25.431713 [info ] [Thread-7 (]: 7 of 13 PASS relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [[32mPASS[0m in 2.07s]
[0m10:39:25.433699 [debug] [Thread-7 (]: Finished running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m10:39:25.435744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:25.437005 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:39:25.437005 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:39:25.639630 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:39:25.640636 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:39:25.843883 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048' was left open.
[0m10:39:25.844876 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: Close
[0m10:39:26.015545 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273' was left open.
[0m10:39:26.016083 [debug] [MainThread]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: Close
[0m10:39:26.276186 [debug] [MainThread]: Connection 'test.data_pipeline.unique_current_customer' was left open.
[0m10:39:26.276186 [debug] [MainThread]: On test.data_pipeline.unique_current_customer: Close
[0m10:39:26.448010 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m10:39:26.449015 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m10:39:26.665482 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m10:39:26.666488 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m10:39:26.993831 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15' was left open.
[0m10:39:26.993831 [debug] [MainThread]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: Close
[0m10:39:27.165134 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' was left open.
[0m10:39:27.165134 [debug] [MainThread]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: Close
[0m10:39:27.406014 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m10:39:27.408024 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m10:39:27.583463 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m10:39:27.583463 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m10:39:27.829963 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m10:39:27.829963 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m10:39:28.064303 [info ] [MainThread]: 
[0m10:39:28.064303 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m10:39:28.070778 [debug] [MainThread]: Command end result
[0m10:39:28.355366 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:39:28.359381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:39:28.369601 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:39:28.369601 [info ] [MainThread]: 
[0m10:39:28.372044 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m10:39:28.373256 [info ] [MainThread]: 
[0m10:39:28.373987 [error] [MainThread]: [31mFailure in test dbt_utils_unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)[0m
[0m10:39:28.375561 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_unique'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:39:28.375561 [info ] [MainThread]: 
[0m10:39:28.377231 [error] [MainThread]: [31mFailure in test dbt_utils_not_null_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)[0m
[0m10:39:28.377642 [error] [MainThread]:   Compilation Error in test dbt_utils_not_null_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)
  'dict object' has no attribute 'test_not_null'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:39:28.378758 [info ] [MainThread]: 
[0m10:39:28.378758 [error] [MainThread]: [31mFailure in test unique_current_customer_customer_snapshot_ (snapshots\snapshot_schema.yml)[0m
[0m10:39:28.380086 [error] [MainThread]:   Compilation Error in test unique_current_customer_customer_snapshot_ (snapshots\snapshot_schema.yml)
  'test_unique_current_customer' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:39:28.380898 [info ] [MainThread]: 
[0m10:39:28.380898 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=13
[0m10:39:28.380898 [debug] [MainThread]: Command `dbt test` failed at 10:39:28.380898 after 12.12 seconds
[0m10:39:28.383992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BDE74DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BDF10B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BF0D70B0>]}
[0m10:39:28.383992 [debug] [MainThread]: Flushing usage events
[0m10:39:29.626960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:20.346366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E90E5A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E93A66330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9382B530>]}


============================== 10:40:20.353681 | dc485e90-dc5e-484d-9323-ab14320bdaba ==============================
[0m10:40:20.353681 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:40:20.354907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select customer_snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:21.114041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc485e90-dc5e-484d-9323-ab14320bdaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9340F290>]}
[0m10:40:21.199314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc485e90-dc5e-484d-9323-ab14320bdaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E93E177A0>]}
[0m10:40:21.201319 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:40:21.674166 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:40:22.089201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:40:22.090202 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://snapshots\snapshot_schema.yml
[0m10:40:22.641269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc485e90-dc5e-484d-9323-ab14320bdaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E967BAC60>]}
[0m10:40:22.803116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:40:22.807120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:40:22.854824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc485e90-dc5e-484d-9323-ab14320bdaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E96AC8110>]}
[0m10:40:22.856235 [info ] [MainThread]: Found 6 models, 12 data tests, 1 seed, 1 snapshot, 3 sources, 594 macros
[0m10:40:22.857239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc485e90-dc5e-484d-9323-ab14320bdaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E96A6A960>]}
[0m10:40:22.859640 [info ] [MainThread]: 
[0m10:40:22.860630 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:40:22.861629 [info ] [MainThread]: 
[0m10:40:22.862914 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:40:22.868791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:40:22.889331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:40:22.990079 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:40:22.991078 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:40:22.991078 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:40:22.992078 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:40:22.993078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:22.993078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:24.446104 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.453 seconds
[0m10:40:24.452104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.459 seconds
[0m10:40:24.458290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc485e90-dc5e-484d-9323-ab14320bdaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E96968140>]}
[0m10:40:24.467366 [debug] [Thread-1 (]: Began running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m10:40:24.468361 [debug] [Thread-2 (]: Began running node test.data_pipeline.unique_current_customer
[0m10:40:24.469475 [debug] [Thread-3 (]: Began running node test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32
[0m10:40:24.469475 [info ] [Thread-1 (]: 1 of 3 START test not_null_customer_snapshot_customer_id ....................... [RUN]
[0m10:40:24.472481 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414'
[0m10:40:24.470608 [info ] [Thread-2 (]: 2 of 3 START test unique_current_customer ...................................... [RUN]
[0m10:40:24.473480 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m10:40:24.474477 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_current_customer'
[0m10:40:24.471483 [info ] [Thread-3 (]: 3 of 3 START test unique_customer_snapshot_customer_id ......................... [RUN]
[0m10:40:24.500463 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.unique_current_customer
[0m10:40:24.501458 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m10:40:24.502463 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32'
[0m10:40:24.508472 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.unique_current_customer"
[0m10:40:24.509968 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32
[0m10:40:24.519357 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32"
[0m10:40:24.521359 [debug] [Thread-2 (]: Began executing node test.data_pipeline.unique_current_customer
[0m10:40:24.549181 [debug] [Thread-1 (]: Began executing node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m10:40:24.557673 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.unique_current_customer"
[0m10:40:24.562678 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m10:40:24.563972 [debug] [Thread-3 (]: Began executing node test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32
[0m10:40:24.568335 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32"
[0m10:40:24.569855 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.unique_current_customer"
[0m10:40:24.570855 [debug] [Thread-2 (]: On test.data_pipeline.unique_current_customer: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Ensure there is only one current record per customer in the snapshot

SELECT 
    customer_id
FROM dbt_db.snapshots.customer_snapshot
WHERE dbt_valid_to IS NULL
GROUP BY customer_id
HAVING COUNT(*) > 1
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_current_customer"} */
[0m10:40:24.571854 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:40:24.573187 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32"
[0m10:40:24.574186 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m10:40:24.575190 [debug] [Thread-3 (]: On test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dbt_db.snapshots.customer_snapshot
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32"} */
[0m10:40:24.577193 [debug] [Thread-1 (]: On test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dbt_db.snapshots.customer_snapshot
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"} */
[0m10:40:24.579191 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:40:24.580191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:40:25.520728 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m10:40:25.531816 [info ] [Thread-2 (]: 2 of 3 PASS unique_current_customer ............................................ [[32mPASS[0m in 1.06s]
[0m10:40:25.531816 [debug] [Thread-2 (]: Finished running node test.data_pipeline.unique_current_customer
[0m10:40:25.619223 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.041 seconds
[0m10:40:25.619223 [error] [Thread-3 (]: 3 of 3 FAIL 1 unique_customer_snapshot_customer_id ............................. [[31mFAIL 1[0m in 1.12s]
[0m10:40:25.625035 [debug] [Thread-3 (]: Finished running node test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32
[0m10:40:25.918542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.343 seconds
[0m10:40:25.924814 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customer_snapshot_customer_id ............................. [[32mPASS[0m in 1.45s]
[0m10:40:25.927831 [debug] [Thread-1 (]: Finished running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m10:40:25.927831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:25.931737 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:40:25.931737 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:40:26.242078 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:40:26.255607 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:40:26.499065 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414' was left open.
[0m10:40:26.499065 [debug] [MainThread]: On test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414: Close
[0m10:40:26.676838 [debug] [MainThread]: Connection 'test.data_pipeline.unique_current_customer' was left open.
[0m10:40:26.676838 [debug] [MainThread]: On test.data_pipeline.unique_current_customer: Close
[0m10:40:26.863228 [debug] [MainThread]: Connection 'test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32' was left open.
[0m10:40:26.864422 [debug] [MainThread]: On test.data_pipeline.unique_customer_snapshot_customer_id.e2c3b67e32: Close
[0m10:40:27.085501 [info ] [MainThread]: 
[0m10:40:27.086538 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m10:40:27.088745 [debug] [MainThread]: Command end result
[0m10:40:27.128615 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:40:27.131616 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:40:27.141614 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:40:27.141614 [info ] [MainThread]: 
[0m10:40:27.142621 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:40:27.143701 [info ] [MainThread]: 
[0m10:40:27.144695 [error] [MainThread]: [31mFailure in test unique_customer_snapshot_customer_id (snapshots\snapshot_schema.yml)[0m
[0m10:40:27.145693 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:40:27.145693 [info ] [MainThread]: 
[0m10:40:27.146711 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\snapshots\snapshot_schema.yml\unique_customer_snapshot_customer_id.sql
[0m10:40:27.147707 [info ] [MainThread]: 
[0m10:40:27.149000 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m10:40:27.150015 [debug] [MainThread]: Command `dbt test` failed at 10:40:27.150015 after 6.99 seconds
[0m10:40:27.151015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E96D06390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E969B6BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E969B69C0>]}
[0m10:40:27.152018 [debug] [MainThread]: Flushing usage events
[0m10:40:28.154515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:32.622203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EFC60230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EFCC6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EFCC6570>]}


============================== 10:41:32.638159 | 43831a29-92b3-42c2-a25a-db28786f923e ==============================
[0m10:41:32.638159 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:41:32.638159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select customer_snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:41:33.408332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43831a29-92b3-42c2-a25a-db28786f923e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163F02E2CC0>]}
[0m10:41:33.496903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43831a29-92b3-42c2-a25a-db28786f923e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EFC601D0>]}
[0m10:41:33.499287 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:41:33.990499 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:41:34.383706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:41:34.384706 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://snapshots\snapshot_schema.yml
[0m10:41:34.961678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43831a29-92b3-42c2-a25a-db28786f923e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163F2597650>]}
[0m10:41:35.119916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:41:35.119916 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:41:35.170872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43831a29-92b3-42c2-a25a-db28786f923e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163F2C46060>]}
[0m10:41:35.170872 [info ] [MainThread]: Found 6 models, 11 data tests, 1 seed, 1 snapshot, 3 sources, 594 macros
[0m10:41:35.170872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43831a29-92b3-42c2-a25a-db28786f923e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163F2D42960>]}
[0m10:41:35.183579 [info ] [MainThread]: 
[0m10:41:35.183579 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:41:35.183579 [info ] [MainThread]: 
[0m10:41:35.183579 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:41:35.194018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:41:35.200319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:41:35.326892 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:41:35.326892 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:41:35.326892 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:41:35.333912 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:41:35.333912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:35.333912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:36.647092 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.318 seconds
[0m10:41:36.647092 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.318 seconds
[0m10:41:36.663080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43831a29-92b3-42c2-a25a-db28786f923e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163F23F0E90>]}
[0m10:41:36.674233 [debug] [Thread-1 (]: Began running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m10:41:36.674233 [debug] [Thread-2 (]: Began running node test.data_pipeline.unique_current_customer
[0m10:41:36.674233 [info ] [Thread-1 (]: 1 of 2 START test not_null_customer_snapshot_customer_id ....................... [RUN]
[0m10:41:36.674233 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414'
[0m10:41:36.674233 [info ] [Thread-2 (]: 2 of 2 START test unique_current_customer ...................................... [RUN]
[0m10:41:36.674233 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m10:41:36.674233 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_current_customer'
[0m10:41:36.696004 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.unique_current_customer
[0m10:41:36.704625 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m10:41:36.707555 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.unique_current_customer"
[0m10:41:36.710488 [debug] [Thread-2 (]: Began executing node test.data_pipeline.unique_current_customer
[0m10:41:36.710488 [debug] [Thread-1 (]: Began executing node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m10:41:36.741289 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.unique_current_customer"
[0m10:41:36.747800 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m10:41:36.747800 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m10:41:36.747800 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.unique_current_customer"
[0m10:41:36.752558 [debug] [Thread-1 (]: On test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dbt_db.snapshots.customer_snapshot
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"} */
[0m10:41:36.752558 [debug] [Thread-2 (]: On test.data_pipeline.unique_current_customer: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Ensure there is only one current record per customer in the snapshot

SELECT 
    customer_id
FROM dbt_db.snapshots.customer_snapshot
WHERE dbt_valid_to IS NULL
GROUP BY customer_id
HAVING COUNT(*) > 1
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_current_customer"} */
[0m10:41:36.752558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:41:36.754913 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:41:37.401614 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m10:41:37.414403 [info ] [Thread-2 (]: 2 of 2 PASS unique_current_customer ............................................ [[32mPASS[0m in 0.74s]
[0m10:41:37.416404 [debug] [Thread-2 (]: Finished running node test.data_pipeline.unique_current_customer
[0m10:41:37.825220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.071 seconds
[0m10:41:37.828246 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customer_snapshot_customer_id ............................. [[32mPASS[0m in 1.15s]
[0m10:41:37.830243 [debug] [Thread-1 (]: Finished running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m10:41:37.832493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:37.833602 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:41:37.833602 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:41:38.137485 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:41:38.137485 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:41:38.410272 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414' was left open.
[0m10:41:38.411310 [debug] [MainThread]: On test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414: Close
[0m10:41:38.684448 [debug] [MainThread]: Connection 'test.data_pipeline.unique_current_customer' was left open.
[0m10:41:38.685470 [debug] [MainThread]: On test.data_pipeline.unique_current_customer: Close
[0m10:41:38.921162 [info ] [MainThread]: 
[0m10:41:38.923165 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m10:41:38.924214 [debug] [MainThread]: Command end result
[0m10:41:38.983845 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:41:38.988189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:41:38.998722 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:41:38.998722 [info ] [MainThread]: 
[0m10:41:38.999721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:41:39.000724 [info ] [MainThread]: 
[0m10:41:39.001724 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:41:39.003187 [debug] [MainThread]: Command `dbt test` succeeded at 10:41:39.003187 after 6.55 seconds
[0m10:41:39.004665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EDB61F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EF58E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163EF58E270>]}
[0m10:41:39.004665 [debug] [MainThread]: Flushing usage events
[0m10:41:40.387077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:06.743845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BED88C01D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BED7E27E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BED7E27EF0>]}


============================== 10:47:06.753614 | a367b617-2743-440c-9ebc-7080b8206d05 ==============================
[0m10:47:06.753614 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:47:06.755623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select customer_snapshot_check', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:47:07.496343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a367b617-2743-440c-9ebc-7080b8206d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEDAF8ABD0>]}
[0m10:47:07.574100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a367b617-2743-440c-9ebc-7080b8206d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BED8B88770>]}
[0m10:47:07.574100 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:47:07.973602 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:47:08.390329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:47:08.390329 [debug] [MainThread]: Partial parsing: added file: data_pipeline://snapshots\customer_snapshot_check.sql
[0m10:47:08.390329 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://snapshots\snapshot_schema.yml
[0m10:47:08.895717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a367b617-2743-440c-9ebc-7080b8206d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEDB779C40>]}
[0m10:47:09.055001 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:47:09.059243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:47:09.091255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a367b617-2743-440c-9ebc-7080b8206d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEDB409010>]}
[0m10:47:09.092267 [info ] [MainThread]: Found 6 models, 13 data tests, 1 seed, 2 snapshots, 3 sources, 594 macros
[0m10:47:09.093266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a367b617-2743-440c-9ebc-7080b8206d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEDB42A690>]}
[0m10:47:09.095265 [info ] [MainThread]: 
[0m10:47:09.096268 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:47:09.096268 [info ] [MainThread]: 
[0m10:47:09.097269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:47:09.098339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:47:09.183464 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:47:09.183464 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:47:09.184877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:11.944424 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.760 seconds
[0m10:47:11.952805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:47:11.964954 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:47:11.964954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:47:11.965953 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:47:11.967954 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:47:11.968953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:11.968953 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:47:11.969953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:12.570875 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.602 seconds
[0m10:47:12.735477 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.766 seconds
[0m10:47:12.738488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a367b617-2743-440c-9ebc-7080b8206d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BED8F42CC0>]}
[0m10:47:12.745792 [debug] [Thread-1 (]: Began running node snapshot.data_pipeline.customer_snapshot_check
[0m10:47:12.746802 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customer_snapshot_check ........................ [RUN]
[0m10:47:12.747804 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.data_pipeline.customer_snapshot_check'
[0m10:47:12.748805 [debug] [Thread-1 (]: Began compiling node snapshot.data_pipeline.customer_snapshot_check
[0m10:47:12.756804 [debug] [Thread-1 (]: Began executing node snapshot.data_pipeline.customer_snapshot_check
[0m10:47:12.876295 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:47:12.877298 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:47:12.877298 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:47:13.643016 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.765 seconds
[0m10:47:13.643016 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:47:13.643016 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:47:13.762045 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.115 seconds
[0m10:47:13.764055 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot_check"
[0m10:47:13.764055 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:47:13.764055 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: create or replace transient table dbt_db.snapshots.customer_snapshot_check
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers

    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m10:47:14.542811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m10:47:14.570742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a367b617-2743-440c-9ebc-7080b8206d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BEDBE96B40>]}
[0m10:47:14.572293 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customer_snapshot_check ........................ [[32mSUCCESS 1[0m in 1.82s]
[0m10:47:14.572293 [debug] [Thread-1 (]: Finished running node snapshot.data_pipeline.customer_snapshot_check
[0m10:47:14.574586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:14.574586 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:47:14.574586 [debug] [MainThread]: On list_dbt_db: Close
[0m10:47:14.791674 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:47:14.791674 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:47:15.011845 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:47:15.012844 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:47:15.288276 [debug] [MainThread]: Connection 'snapshot.data_pipeline.customer_snapshot_check' was left open.
[0m10:47:15.288276 [debug] [MainThread]: On snapshot.data_pipeline.customer_snapshot_check: Close
[0m10:47:15.455036 [info ] [MainThread]: 
[0m10:47:15.456038 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m10:47:15.457034 [debug] [MainThread]: Command end result
[0m10:47:15.489471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:47:15.515332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:47:15.523332 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:47:15.523332 [info ] [MainThread]: 
[0m10:47:15.524333 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:47:15.524333 [info ] [MainThread]: 
[0m10:47:15.525334 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:47:15.526592 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:47:15.525334 after 8.97 seconds
[0m10:47:15.526592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BED8F41FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BED8F42210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BED8F41E50>]}
[0m10:47:15.527603 [debug] [MainThread]: Flushing usage events
[0m10:47:16.672341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:20.053600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C715A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C9637EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C9634E60>]}


============================== 10:49:20.070618 | 812338da-5ad6-411b-90cf-16e44b528502 ==============================
[0m10:49:20.070618 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:49:20.070618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:49:20.914783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '812338da-5ad6-411b-90cf-16e44b528502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C9716B70>]}
[0m10:49:20.968057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '812338da-5ad6-411b-90cf-16e44b528502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C5A013A0>]}
[0m10:49:20.970063 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:49:21.404178 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:49:23.229063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:49:23.229063 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://seeds\customers.csv
[0m10:49:23.437021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812338da-5ad6-411b-90cf-16e44b528502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4CCB62570>]}
[0m10:49:23.531225 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:49:23.531225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:49:23.563296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '812338da-5ad6-411b-90cf-16e44b528502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4CCB167E0>]}
[0m10:49:23.563296 [info ] [MainThread]: Found 6 models, 13 data tests, 2 snapshots, 1 seed, 3 sources, 594 macros
[0m10:49:23.563296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812338da-5ad6-411b-90cf-16e44b528502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4CCB58770>]}
[0m10:49:23.563296 [info ] [MainThread]: 
[0m10:49:23.563296 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:49:23.563296 [info ] [MainThread]: 
[0m10:49:23.563296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:49:23.573310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:49:25.951714 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:49:25.951714 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:49:25.960659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:28.125205 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.165 seconds
[0m10:49:28.132208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:49:28.144640 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:49:28.145640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:49:28.145640 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:49:28.148640 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:49:28.148640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:28.149640 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:49:28.149640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:28.865306 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.716 seconds
[0m10:49:28.947725 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.799 seconds
[0m10:49:28.950239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812338da-5ad6-411b-90cf-16e44b528502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4CC5A4A10>]}
[0m10:49:28.956018 [debug] [Thread-1 (]: Began running node seed.data_pipeline.customers
[0m10:49:28.956018 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.customers .................................... [RUN]
[0m10:49:28.958536 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m10:49:28.958536 [debug] [Thread-1 (]: Began compiling node seed.data_pipeline.customers
[0m10:49:28.959533 [debug] [Thread-1 (]: Began executing node seed.data_pipeline.customers
[0m10:49:28.996701 [debug] [Thread-1 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."CUSTOMERS"
[0m10:49:29.001701 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:49:29.001701 [debug] [Thread-1 (]: On seed.data_pipeline.customers: drop table if exists "DBT_DB"."DBT_SCHEMA"."CUSTOMERS" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:49:29.002701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:49:29.606322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m10:49:29.614331 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:49:29.614331 [debug] [Thread-1 (]: On seed.data_pipeline.customers: create table dbt_db.dbt_schema.customers (customer_id integer,customer_name text,customer_status text,updated_at timestamp without time zone)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:49:29.935599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m10:49:29.949611 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:49:29.950612 [debug] [Thread-1 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:49:30.099684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m10:49:30.100946 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:49:30.100946 [debug] [Thread-1 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m10:49:30.511381 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.409 seconds
[0m10:49:30.512373 [debug] [Thread-1 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m10:49:30.512373 [debug] [Thread-1 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m10:49:30.758221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m10:49:30.764533 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m10:49:30.796058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812338da-5ad6-411b-90cf-16e44b528502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C725A420>]}
[0m10:49:30.796058 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.customers ................................ [[32mCREATE 4[0m in 1.84s]
[0m10:49:30.797052 [debug] [Thread-1 (]: Finished running node seed.data_pipeline.customers
[0m10:49:30.799055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:30.799055 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:49:30.800054 [debug] [MainThread]: On list_dbt_db: Close
[0m10:49:31.011467 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:49:31.011467 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:49:31.187607 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:49:31.189461 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:49:31.347457 [debug] [MainThread]: Connection 'seed.data_pipeline.customers' was left open.
[0m10:49:31.347457 [debug] [MainThread]: On seed.data_pipeline.customers: Close
[0m10:49:31.582473 [info ] [MainThread]: 
[0m10:49:31.582473 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m10:49:31.582473 [debug] [MainThread]: Command end result
[0m10:49:31.605801 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:49:31.605801 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:49:31.623261 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:49:31.623261 [info ] [MainThread]: 
[0m10:49:31.623261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:31.623261 [info ] [MainThread]: 
[0m10:49:31.623261 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:49:31.623261 [debug] [MainThread]: Command `dbt seed` succeeded at 10:49:31.623261 after 11.78 seconds
[0m10:49:31.623261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C9BE0FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4CA1B14C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4CA1B0260>]}
[0m10:49:31.623261 [debug] [MainThread]: Flushing usage events
[0m10:49:32.814323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:40.031462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586F2EE510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258723C5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258723C4BC0>]}


============================== 10:49:40.036538 | 90d4d3b8-614c-46f7-975f-47933d5a3562 ==============================
[0m10:49:40.036538 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:49:40.036538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select customer_snapshot_check', 'send_anonymous_usage_stats': 'True'}
[0m10:49:40.471763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90d4d3b8-614c-46f7-975f-47933d5a3562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587457A900>]}
[0m10:49:40.519113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90d4d3b8-614c-46f7-975f-47933d5a3562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025873595070>]}
[0m10:49:40.520860 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:49:40.767294 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:49:41.029272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:49:41.029804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:49:41.085781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90d4d3b8-614c-46f7-975f-47933d5a3562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587446E510>]}
[0m10:49:41.181175 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:49:41.181175 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:49:41.212296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90d4d3b8-614c-46f7-975f-47933d5a3562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025874ABF260>]}
[0m10:49:41.212296 [info ] [MainThread]: Found 6 models, 13 data tests, 2 snapshots, 1 seed, 3 sources, 594 macros
[0m10:49:41.212296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90d4d3b8-614c-46f7-975f-47933d5a3562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025870E4E0F0>]}
[0m10:49:41.214130 [info ] [MainThread]: 
[0m10:49:41.214130 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:49:41.214130 [info ] [MainThread]: 
[0m10:49:41.214130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:49:41.214130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:49:41.295684 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:49:41.296685 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:49:41.297686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:43.277687 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.980 seconds
[0m10:49:43.283687 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:49:43.295684 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:49:43.295684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:49:43.296687 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:49:43.298671 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:49:43.299810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:43.300196 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:49:43.300536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:44.060506 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.761 seconds
[0m10:49:44.063542 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.764 seconds
[0m10:49:44.067559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90d4d3b8-614c-46f7-975f-47933d5a3562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025874BB37A0>]}
[0m10:49:44.072253 [debug] [Thread-1 (]: Began running node snapshot.data_pipeline.customer_snapshot_check
[0m10:49:44.072253 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customer_snapshot_check ........................ [RUN]
[0m10:49:44.073347 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.data_pipeline.customer_snapshot_check'
[0m10:49:44.074347 [debug] [Thread-1 (]: Began compiling node snapshot.data_pipeline.customer_snapshot_check
[0m10:49:44.081351 [debug] [Thread-1 (]: Began executing node snapshot.data_pipeline.customer_snapshot_check
[0m10:49:44.130114 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:44.131113 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select customer_name, customer_status from (
                
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:44.131113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:49:44.934912 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.803 seconds
[0m10:49:44.943912 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:44.946386 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:45.061124 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.114 seconds
[0m10:49:45.069149 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:45.069149 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:45.189768 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.124 seconds
[0m10:49:45.233879 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:45.234879 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
as (
    
    
    with snapshot_query as (

        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m10:49:46.303355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.070 seconds
[0m10:49:46.303355 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:46.303355 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:46.468874 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.169 seconds
[0m10:49:46.480553 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:46.480553 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:46.579989 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.106 seconds
[0m10:49:46.579989 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:46.579989 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:46.723027 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.133 seconds
[0m10:49:46.723027 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:46.723027 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:46.886897 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.156 seconds
[0m10:49:46.890487 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:46.890487 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:47.025583 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.129 seconds
[0m10:49:47.044140 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:47.044140 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        
    
    with snapshot_query as (

        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:47.381613 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.337 seconds
[0m10:49:47.385618 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:47.385618 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:47.498273 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.112 seconds
[0m10:49:47.498273 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:47.500741 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:47.500741 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:47.628569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m10:49:47.629569 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:47.629569 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m10:49:48.129934 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.499 seconds
[0m10:49:48.130934 [debug] [Thread-1 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m10:49:48.130934 [debug] [Thread-1 (]: On snapshot.data_pipeline.customer_snapshot_check: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m10:49:48.406594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m10:49:48.427264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d4d3b8-614c-46f7-975f-47933d5a3562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587183CFB0>]}
[0m10:49:48.427264 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customer_snapshot_check ........................ [[32mSUCCESS 2[0m in 4.35s]
[0m10:49:48.428264 [debug] [Thread-1 (]: Finished running node snapshot.data_pipeline.customer_snapshot_check
[0m10:49:48.429587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:48.430689 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:49:48.430689 [debug] [MainThread]: On list_dbt_db: Close
[0m10:49:48.781229 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:49:48.781229 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:49:48.972367 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:49:48.972367 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:49:49.182464 [debug] [MainThread]: Connection 'snapshot.data_pipeline.customer_snapshot_check' was left open.
[0m10:49:49.182464 [debug] [MainThread]: On snapshot.data_pipeline.customer_snapshot_check: Close
[0m10:49:49.523010 [info ] [MainThread]: 
[0m10:49:49.523010 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m10:49:49.523010 [debug] [MainThread]: Command end result
[0m10:49:49.541436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:49:49.541436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:49:49.556330 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:49:49.556330 [info ] [MainThread]: 
[0m10:49:49.556330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:49.556330 [info ] [MainThread]: 
[0m10:49:49.556330 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:49:49.556330 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:49:49.556330 after 9.63 seconds
[0m10:49:49.556330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587252D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258723F13D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025874BB1310>]}
[0m10:49:49.556330 [debug] [MainThread]: Flushing usage events
[0m10:49:50.836098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:49.852338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8791F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC87C82660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC84317F20>]}


============================== 10:52:49.857482 | 12460486-ae23-4ef3-a71a-ca0f1f914668 ==============================
[0m10:52:49.857482 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:52:49.858482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select current_customers historical_customers', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:52:50.339410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12460486-ae23-4ef3-a71a-ca0f1f914668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC87E52900>]}
[0m10:52:50.390920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12460486-ae23-4ef3-a71a-ca0f1f914668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC89D9E930>]}
[0m10:52:50.392459 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:52:50.673866 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:52:50.925392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:52:50.925392 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\current_customers.sql
[0m10:52:50.926391 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\historical_customers.sql
[0m10:52:51.169631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12460486-ae23-4ef3-a71a-ca0f1f914668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8A2C4290>]}
[0m10:52:51.264669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:52:51.277693 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:52:51.299890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12460486-ae23-4ef3-a71a-ca0f1f914668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8A7056D0>]}
[0m10:52:51.299890 [info ] [MainThread]: Found 8 models, 13 data tests, 2 snapshots, 1 seed, 3 sources, 594 macros
[0m10:52:51.299890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12460486-ae23-4ef3-a71a-ca0f1f914668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8A6ABF50>]}
[0m10:52:51.301796 [info ] [MainThread]: 
[0m10:52:51.301796 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:52:51.301796 [info ] [MainThread]: 
[0m10:52:51.301796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:52:51.301796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:52:51.378854 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:52:51.378854 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:52:51.378854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:53.521319 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.142 seconds
[0m10:52:53.521319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:52:53.521319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:52:53.537001 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:52:53.537001 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:52:53.537001 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:52:53.537001 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:52:53.537001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:53.537001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:54.248628 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.715 seconds
[0m10:52:54.248628 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.720 seconds
[0m10:52:54.260321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12460486-ae23-4ef3-a71a-ca0f1f914668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8A6A7410>]}
[0m10:52:54.263954 [debug] [Thread-1 (]: Began running node model.data_pipeline.current_customers
[0m10:52:54.263954 [debug] [Thread-2 (]: Began running node model.data_pipeline.historical_customers
[0m10:52:54.263954 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_schema.current_customers ...................... [RUN]
[0m10:52:54.263954 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.current_customers'
[0m10:52:54.263954 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_schema.historical_customers ................... [RUN]
[0m10:52:54.263954 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.current_customers
[0m10:52:54.263954 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.historical_customers'
[0m10:52:54.263954 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.current_customers"
[0m10:52:54.263954 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.historical_customers
[0m10:52:54.263954 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.historical_customers"
[0m10:52:54.278856 [debug] [Thread-1 (]: Began executing node model.data_pipeline.current_customers
[0m10:52:54.284897 [debug] [Thread-2 (]: Began executing node model.data_pipeline.historical_customers
[0m10:52:54.306406 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.historical_customers"
[0m10:52:54.315165 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.current_customers"
[0m10:52:54.316826 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m10:52:54.316826 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m10:52:54.318071 [debug] [Thread-1 (]: On model.data_pipeline.current_customers: create or replace transient table dbt_db.dbt_schema.current_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NULL
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */;
[0m10:52:54.318071 [debug] [Thread-2 (]: On model.data_pipeline.historical_customers: create or replace transient table dbt_db.dbt_schema.historical_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NOT NULL
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */;
[0m10:52:54.318071 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:52:54.318071 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:52:55.289112 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.970 seconds
[0m10:52:55.309318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m10:52:55.311518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12460486-ae23-4ef3-a71a-ca0f1f914668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC84D2A6C0>]}
[0m10:52:55.311518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12460486-ae23-4ef3-a71a-ca0f1f914668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8715C710>]}
[0m10:52:55.312757 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dbt_schema.historical_customers .............. [[32mSUCCESS 1[0m in 1.04s]
[0m10:52:55.312757 [debug] [Thread-2 (]: Finished running node model.data_pipeline.historical_customers
[0m10:52:55.312757 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_schema.current_customers ................. [[32mSUCCESS 1[0m in 1.05s]
[0m10:52:55.314058 [debug] [Thread-1 (]: Finished running node model.data_pipeline.current_customers
[0m10:52:55.314058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:55.316132 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:52:55.316132 [debug] [MainThread]: On list_dbt_db: Close
[0m10:52:55.493192 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:52:55.493192 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:52:55.688448 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:52:55.688448 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:52:55.958429 [debug] [MainThread]: Connection 'model.data_pipeline.current_customers' was left open.
[0m10:52:55.958429 [debug] [MainThread]: On model.data_pipeline.current_customers: Close
[0m10:52:56.128634 [debug] [MainThread]: Connection 'model.data_pipeline.historical_customers' was left open.
[0m10:52:56.128634 [debug] [MainThread]: On model.data_pipeline.historical_customers: Close
[0m10:52:56.306568 [info ] [MainThread]: 
[0m10:52:56.306568 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m10:52:56.306568 [debug] [MainThread]: Command end result
[0m10:52:56.339874 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:52:56.339874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:52:56.347000 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:52:56.347000 [info ] [MainThread]: 
[0m10:52:56.347000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:56.347000 [info ] [MainThread]: 
[0m10:52:56.347000 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:52:56.351709 [debug] [MainThread]: Command `dbt run` succeeded at 10:52:56.347000 after 6.67 seconds
[0m10:52:56.351709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC87749730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC87103680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC871036B0>]}
[0m10:52:56.351709 [debug] [MainThread]: Flushing usage events
[0m10:52:57.706662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:52.768833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E290C22750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E290B6A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E290C21580>]}


============================== 10:58:52.775669 | fb82aabd-d9de-4f5a-ac10-85a6e3a7f423 ==============================
[0m10:58:52.775669 [info ] [MainThread]: Running with dbt=1.10.5
[0m10:58:52.775669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select snapshot_check_data', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:58:53.282020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E29327A810>]}
[0m10:58:53.335891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E28E450C80>]}
[0m10:58:53.336891 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:58:53.621625 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m10:58:53.895212 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m10:58:53.896212 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\snapshot_check_data\customer_activity.sql
[0m10:58:53.896212 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\snapshot_check_data\historical_customers.sql
[0m10:58:53.896212 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\snapshot_check_data\current_customers.sql
[0m10:58:53.897212 [debug] [MainThread]: Partial parsing: deleted file: data_pipeline://models\marts\customer_activity.sql
[0m10:58:53.897212 [debug] [MainThread]: Partial parsing: deleted file: data_pipeline://models\marts\historical_customers.sql
[0m10:58:53.897212 [debug] [MainThread]: Partial parsing: deleted file: data_pipeline://models\marts\current_customers.sql
[0m10:58:54.145216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E293907080>]}
[0m10:58:54.245123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:58:54.247124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:58:54.268123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2937671A0>]}
[0m10:58:54.269124 [info ] [MainThread]: Found 8 models, 13 data tests, 2 snapshots, 1 seed, 3 sources, 594 macros
[0m10:58:54.269124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2937BCEC0>]}
[0m10:58:54.271120 [info ] [MainThread]: 
[0m10:58:54.272123 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:58:54.272123 [info ] [MainThread]: 
[0m10:58:54.273120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:58:54.277452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m10:58:54.349719 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m10:58:54.349719 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m10:58:54.349719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:56.509668 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.167 seconds
[0m10:58:56.509668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m10:58:56.525352 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m10:58:56.532008 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m10:58:56.532008 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m10:58:56.532008 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m10:58:56.532008 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m10:58:56.532008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:56.537831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:57.095450 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.558 seconds
[0m10:58:57.333937 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.806 seconds
[0m10:58:57.348058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2938C9430>]}
[0m10:58:57.352596 [debug] [Thread-1 (]: Began running node model.data_pipeline.current_customers
[0m10:58:57.352596 [debug] [Thread-2 (]: Began running node model.data_pipeline.customer_activity
[0m10:58:57.352596 [debug] [Thread-3 (]: Began running node model.data_pipeline.historical_customers
[0m10:58:57.352596 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_schema.current_customers ....................... [RUN]
[0m10:58:57.352596 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_schema.customer_activity ....................... [RUN]
[0m10:58:57.352596 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.current_customers'
[0m10:58:57.352596 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.customer_activity'
[0m10:58:57.352596 [info ] [Thread-3 (]: 3 of 3 START sql view model dbt_schema.historical_customers .................... [RUN]
[0m10:58:57.352596 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.current_customers
[0m10:58:57.352596 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.customer_activity
[0m10:58:57.352596 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_pipeline.historical_customers'
[0m10:58:57.364426 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.current_customers"
[0m10:58:57.367964 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m10:58:57.367964 [debug] [Thread-3 (]: Began compiling node model.data_pipeline.historical_customers
[0m10:58:57.371977 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_pipeline.historical_customers"
[0m10:58:57.372978 [debug] [Thread-1 (]: Began executing node model.data_pipeline.current_customers
[0m10:58:57.383525 [debug] [Thread-1 (]: Dropping relation "DBT_DB"."DBT_SCHEMA"."CURRENT_CUSTOMERS" because it is of type table
[0m10:58:57.383525 [debug] [Thread-3 (]: Began executing node model.data_pipeline.historical_customers
[0m10:58:57.400070 [debug] [Thread-1 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."CURRENT_CUSTOMERS"
[0m10:58:57.400571 [debug] [Thread-3 (]: Dropping relation "DBT_DB"."DBT_SCHEMA"."HISTORICAL_CUSTOMERS" because it is of type table
[0m10:58:57.400571 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m10:58:57.400571 [debug] [Thread-2 (]: Began executing node model.data_pipeline.customer_activity
[0m10:58:57.400571 [debug] [Thread-3 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."HISTORICAL_CUSTOMERS"
[0m10:58:57.400571 [debug] [Thread-1 (]: On model.data_pipeline.current_customers: drop table if exists "DBT_DB"."DBT_SCHEMA"."CURRENT_CUSTOMERS" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */
[0m10:58:57.400571 [debug] [Thread-2 (]: Dropping relation "DBT_DB"."DBT_SCHEMA"."CUSTOMER_ACTIVITY" because it is of type table
[0m10:58:57.400571 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m10:58:57.400571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:58:57.417910 [debug] [Thread-2 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."CUSTOMER_ACTIVITY"
[0m10:58:57.417910 [debug] [Thread-3 (]: On model.data_pipeline.historical_customers: drop table if exists "DBT_DB"."DBT_SCHEMA"."HISTORICAL_CUSTOMERS" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */
[0m10:58:57.417910 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m10:58:57.417910 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:58:57.420053 [debug] [Thread-2 (]: On model.data_pipeline.customer_activity: drop table if exists "DBT_DB"."DBT_SCHEMA"."CUSTOMER_ACTIVITY" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */
[0m10:58:57.421413 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:58:58.084761 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m10:58:58.084761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m10:58:58.086427 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m10:58:58.098062 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_pipeline.historical_customers"
[0m10:58:58.098062 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.current_customers"
[0m10:58:58.098062 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m10:58:58.109045 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m10:58:58.109045 [debug] [Thread-1 (]: On model.data_pipeline.current_customers: create or replace   view dbt_db.dbt_schema.current_customers
  
  
  
  
  as (
    SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NULL
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */;
[0m10:58:58.109045 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m10:58:58.112305 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m10:58:58.112305 [debug] [Thread-2 (]: On model.data_pipeline.customer_activity: create or replace   view dbt_db.dbt_schema.customer_activity
  
  
  
  
  as (
    -- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m10:58:58.112305 [debug] [Thread-3 (]: On model.data_pipeline.historical_customers: create or replace   view dbt_db.dbt_schema.historical_customers
  
  
  
  
  as (
    SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NOT NULL
ORDER BY customer_id, dbt_valid_from
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */;
[0m10:58:58.321696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m10:58:58.321696 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m10:58:58.321696 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m10:58:58.351895 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E294045E20>]}
[0m10:58:58.351895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2950DF320>]}
[0m10:58:58.351895 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb82aabd-d9de-4f5a-ac10-85a6e3a7f423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2950C7EF0>]}
[0m10:58:58.351895 [info ] [Thread-3 (]: 3 of 3 OK created sql view model dbt_schema.historical_customers ............... [[32mSUCCESS 1[0m in 1.00s]
[0m10:58:58.351895 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_schema.current_customers .................. [[32mSUCCESS 1[0m in 1.00s]
[0m10:58:58.358172 [debug] [Thread-3 (]: Finished running node model.data_pipeline.historical_customers
[0m10:58:58.358172 [debug] [Thread-1 (]: Finished running node model.data_pipeline.current_customers
[0m10:58:58.358172 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dbt_schema.customer_activity .................. [[32mSUCCESS 1[0m in 1.00s]
[0m10:58:58.358172 [debug] [Thread-2 (]: Finished running node model.data_pipeline.customer_activity
[0m10:58:58.358172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:58.358172 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m10:58:58.362190 [debug] [MainThread]: On list_dbt_db: Close
[0m10:58:58.578138 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m10:58:58.578138 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m10:58:58.770503 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m10:58:58.770503 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m10:58:58.998117 [debug] [MainThread]: Connection 'model.data_pipeline.current_customers' was left open.
[0m10:58:58.999109 [debug] [MainThread]: On model.data_pipeline.current_customers: Close
[0m10:58:59.168157 [debug] [MainThread]: Connection 'model.data_pipeline.customer_activity' was left open.
[0m10:58:59.168157 [debug] [MainThread]: On model.data_pipeline.customer_activity: Close
[0m10:58:59.404996 [debug] [MainThread]: Connection 'model.data_pipeline.historical_customers' was left open.
[0m10:58:59.404996 [debug] [MainThread]: On model.data_pipeline.historical_customers: Close
[0m10:58:59.570581 [info ] [MainThread]: 
[0m10:58:59.571677 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m10:58:59.572634 [debug] [MainThread]: Command end result
[0m10:58:59.597017 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m10:58:59.599017 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m10:58:59.604339 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m10:58:59.605340 [info ] [MainThread]: 
[0m10:58:59.605340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:58:59.606343 [info ] [MainThread]: 
[0m10:58:59.606343 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m10:58:59.607341 [debug] [MainThread]: Command `dbt run` succeeded at 10:58:59.607341 after 7.01 seconds
[0m10:58:59.607341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E29124E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E28DF37B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E290C679E0>]}
[0m10:58:59.607341 [debug] [MainThread]: Flushing usage events
[0m10:59:00.961772 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:06.591563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199CB3EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021999F9A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021999E87D10>]}


============================== 11:02:06.596955 | 4b880c21-1beb-4055-8b19-4739ac4c8e7a ==============================
[0m11:02:06.596955 [info ] [MainThread]: Running with dbt=1.10.5
[0m11:02:06.597956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select snapshot_check_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:02:07.058458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199CB6FC80>]}
[0m11:02:07.104756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199CABB080>]}
[0m11:02:07.104756 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:02:07.383991 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m11:02:07.575736 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:02:07.575736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199F803290>]}
[0m11:02:09.438259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199FD62780>]}
[0m11:02:09.544687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:02:09.546687 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:02:09.570201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199FC93620>]}
[0m11:02:09.570201 [info ] [MainThread]: Found 8 models, 2 snapshots, 13 data tests, 1 seed, 3 sources, 594 macros
[0m11:02:09.571497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199F6E9940>]}
[0m11:02:09.573121 [info ] [MainThread]: 
[0m11:02:09.573121 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:02:09.574154 [info ] [MainThread]: 
[0m11:02:09.574750 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:02:09.578850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:02:09.647106 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:02:09.647106 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:02:09.647106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:11.984381 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.333 seconds
[0m11:02:11.988632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m11:02:12.000999 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m11:02:12.000999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m11:02:12.000999 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m11:02:12.003132 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m11:02:12.003916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:12.004232 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m11:02:12.004232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:12.558394 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.555 seconds
[0m11:02:12.566359 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.562 seconds
[0m11:02:12.569359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199F344E00>]}
[0m11:02:12.573769 [debug] [Thread-1 (]: Began running node model.data_pipeline.current_customers
[0m11:02:12.575041 [debug] [Thread-2 (]: Began running node model.data_pipeline.customer_activity
[0m11:02:12.575041 [debug] [Thread-3 (]: Began running node model.data_pipeline.historical_customers
[0m11:02:12.576161 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_schema.current_customers ...................... [RUN]
[0m11:02:12.577307 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.current_customers'
[0m11:02:12.576161 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_schema.customer_activity ...................... [RUN]
[0m11:02:12.577307 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.current_customers
[0m11:02:12.578421 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.customer_activity'
[0m11:02:12.576161 [info ] [Thread-3 (]: 3 of 3 START sql table model dbt_schema.historical_customers ................... [RUN]
[0m11:02:12.586106 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.current_customers"
[0m11:02:12.586628 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.customer_activity
[0m11:02:12.587152 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_pipeline.historical_customers'
[0m11:02:12.589763 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m11:02:12.590281 [debug] [Thread-3 (]: Began compiling node model.data_pipeline.historical_customers
[0m11:02:12.592893 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_pipeline.historical_customers"
[0m11:02:12.593412 [debug] [Thread-1 (]: Began executing node model.data_pipeline.current_customers
[0m11:02:12.609072 [debug] [Thread-1 (]:  adapter: Dropping relation "DBT_DB"."DBT_SCHEMA"."CURRENT_CUSTOMERS" because it is a view and target relation dbt_db.dbt_schema.current_customers is of type table.
[0m11:02:12.615186 [debug] [Thread-1 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."CURRENT_CUSTOMERS"
[0m11:02:12.616186 [debug] [Thread-2 (]: Began executing node model.data_pipeline.customer_activity
[0m11:02:12.621186 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m11:02:12.623186 [debug] [Thread-2 (]:  adapter: Dropping relation "DBT_DB"."DBT_SCHEMA"."CUSTOMER_ACTIVITY" because it is a view and target relation dbt_db.dbt_schema.customer_activity is of type table.
[0m11:02:12.624186 [debug] [Thread-3 (]: Began executing node model.data_pipeline.historical_customers
[0m11:02:12.624186 [debug] [Thread-1 (]: On model.data_pipeline.current_customers: drop view if exists "DBT_DB"."DBT_SCHEMA"."CURRENT_CUSTOMERS" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */
[0m11:02:12.626186 [debug] [Thread-2 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."CUSTOMER_ACTIVITY"
[0m11:02:12.628186 [debug] [Thread-3 (]:  adapter: Dropping relation "DBT_DB"."DBT_SCHEMA"."HISTORICAL_CUSTOMERS" because it is a view and target relation dbt_db.dbt_schema.historical_customers is of type table.
[0m11:02:12.628186 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:12.629187 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m11:02:12.631186 [debug] [Thread-3 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."HISTORICAL_CUSTOMERS"
[0m11:02:12.631186 [debug] [Thread-2 (]: On model.data_pipeline.customer_activity: drop view if exists "DBT_DB"."DBT_SCHEMA"."CUSTOMER_ACTIVITY" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */
[0m11:02:12.632186 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m11:02:12.633186 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:02:12.633186 [debug] [Thread-3 (]: On model.data_pipeline.historical_customers: drop view if exists "DBT_DB"."DBT_SCHEMA"."HISTORICAL_CUSTOMERS" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */
[0m11:02:12.635186 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:02:13.218129 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m11:02:13.233798 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m11:02:13.233798 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m11:02:13.233798 [debug] [Thread-2 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m11:02:13.238721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m11:02:13.249876 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.current_customers"
[0m11:02:13.249876 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m11:02:13.249876 [debug] [Thread-1 (]: On model.data_pipeline.current_customers: create or replace transient table dbt_db.dbt_schema.current_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NULL
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */;
[0m11:02:14.222735 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.588 seconds
[0m11:02:14.224745 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_pipeline.historical_customers"
[0m11:02:14.224745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.972 seconds
[0m11:02:14.237860 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.008 seconds
[0m11:02:14.237860 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m11:02:14.237860 [debug] [Thread-3 (]: On model.data_pipeline.historical_customers: create or replace transient table dbt_db.dbt_schema.historical_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NOT NULL
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */;
[0m11:02:14.237860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199A09A5D0>]}
[0m11:02:14.237860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A12850D0>]}
[0m11:02:14.237860 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_schema.current_customers ................. [[32mSUCCESS 1[0m in 1.66s]
[0m11:02:14.237860 [debug] [Thread-1 (]: Finished running node model.data_pipeline.current_customers
[0m11:02:14.237860 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_schema.customer_activity ................. [[32mSUCCESS 1[0m in 1.66s]
[0m11:02:14.237860 [debug] [Thread-2 (]: Finished running node model.data_pipeline.customer_activity
[0m11:02:15.647365 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m11:02:15.649858 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b880c21-1beb-4055-8b19-4739ac4c8e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A128FC50>]}
[0m11:02:15.649858 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dbt_schema.historical_customers .............. [[32mSUCCESS 1[0m in 3.06s]
[0m11:02:15.650879 [debug] [Thread-3 (]: Finished running node model.data_pipeline.historical_customers
[0m11:02:15.652865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:15.653863 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:02:15.653863 [debug] [MainThread]: On list_dbt_db: Close
[0m11:02:15.831388 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m11:02:15.832384 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m11:02:16.121070 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m11:02:16.121070 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m11:02:16.449784 [debug] [MainThread]: Connection 'model.data_pipeline.current_customers' was left open.
[0m11:02:16.449784 [debug] [MainThread]: On model.data_pipeline.current_customers: Close
[0m11:02:16.643950 [debug] [MainThread]: Connection 'model.data_pipeline.customer_activity' was left open.
[0m11:02:16.644905 [debug] [MainThread]: On model.data_pipeline.customer_activity: Close
[0m11:02:17.030111 [debug] [MainThread]: Connection 'model.data_pipeline.historical_customers' was left open.
[0m11:02:17.030111 [debug] [MainThread]: On model.data_pipeline.historical_customers: Close
[0m11:02:17.354870 [info ] [MainThread]: 
[0m11:02:17.354870 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.78 seconds (7.78s).
[0m11:02:17.357373 [debug] [MainThread]: Command end result
[0m11:02:17.382060 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:02:17.383606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:02:17.383606 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m11:02:17.383606 [info ] [MainThread]: 
[0m11:02:17.383606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:17.383606 [info ] [MainThread]: 
[0m11:02:17.383606 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:02:17.383606 [debug] [MainThread]: Command `dbt run` succeeded at 11:02:17.383606 after 10.95 seconds
[0m11:02:17.383606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199C46D640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199C46FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199FD62060>]}
[0m11:02:17.383606 [debug] [MainThread]: Flushing usage events
[0m11:02:18.823105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:08.835898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD6E4EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD6E4DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD685EC90>]}


============================== 11:06:08.841892 | 2eadcfdf-1f6a-4113-b409-ed5bd881bf89 ==============================
[0m11:06:08.841892 [info ] [MainThread]: Running with dbt=1.10.5
[0m11:06:08.841892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select snapshot_check_data', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:06:09.306472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD9549D90>]}
[0m11:06:09.359416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD9012030>]}
[0m11:06:09.359416 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:06:09.628933 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m11:06:09.825057 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:06:09.825057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD9A632F0>]}
[0m11:06:11.571771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD9E5F4A0>]}
[0m11:06:11.670954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:06:11.670954 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:06:11.686681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD9E532C0>]}
[0m11:06:11.686681 [info ] [MainThread]: Found 8 models, 2 snapshots, 13 data tests, 1 seed, 3 sources, 594 macros
[0m11:06:11.702659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD9DAAA20>]}
[0m11:06:11.702659 [info ] [MainThread]: 
[0m11:06:11.702659 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:06:11.702659 [info ] [MainThread]: 
[0m11:06:11.702659 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:06:11.702659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:06:11.775103 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:06:11.775103 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:06:11.775103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:13.984192 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.198 seconds
[0m11:06:13.986219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now create_dbt_db_dbt_schema_snapshot_data)
[0m11:06:13.986219 [debug] [ThreadPool]: Creating schema "database: "dbt_db"
schema: "dbt_schema_snapshot_data"
"
[0m11:06:13.991219 [debug] [ThreadPool]: Using snowflake connection "create_dbt_db_dbt_schema_snapshot_data"
[0m11:06:13.991219 [debug] [ThreadPool]: On create_dbt_db_dbt_schema_snapshot_data: create schema if not exists dbt_db.dbt_schema_snapshot_data
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "create_dbt_db_dbt_schema_snapshot_data"} */
[0m11:06:14.158256 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.167 seconds
[0m11:06:14.161708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m11:06:14.172805 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m11:06:14.173805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema_snapshot_data'
[0m11:06:14.174808 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m11:06:14.175683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m11:06:14.176693 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema_snapshot_data"
[0m11:06:14.176693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:14.178693 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m11:06:14.178693 [debug] [ThreadPool]: On list_dbt_db_dbt_schema_snapshot_data: show objects in dbt_db.dbt_schema_snapshot_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema_snapshot_data"} */;
[0m11:06:14.179702 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m11:06:14.179702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:14.180693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:14.962426 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.797 seconds
[0m11:06:14.978228 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.797 seconds
[0m11:06:15.123490 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.952 seconds
[0m11:06:15.123490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CDA33CD40>]}
[0m11:06:15.139179 [debug] [Thread-1 (]: Began running node model.data_pipeline.current_customers
[0m11:06:15.139179 [debug] [Thread-2 (]: Began running node model.data_pipeline.customer_activity
[0m11:06:15.139179 [debug] [Thread-3 (]: Began running node model.data_pipeline.historical_customers
[0m11:06:15.139179 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_schema_snapshot_data.current_customers ........ [RUN]
[0m11:06:15.139179 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_schema_snapshot_data.customer_activity ........ [RUN]
[0m11:06:15.143403 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.current_customers'
[0m11:06:15.143403 [info ] [Thread-3 (]: 3 of 3 START sql table model dbt_schema_snapshot_data.historical_customers ..... [RUN]
[0m11:06:15.143403 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.customer_activity'
[0m11:06:15.143403 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.current_customers
[0m11:06:15.143403 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_pipeline.historical_customers'
[0m11:06:15.143403 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.customer_activity
[0m11:06:15.143403 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.current_customers"
[0m11:06:15.143403 [debug] [Thread-3 (]: Began compiling node model.data_pipeline.historical_customers
[0m11:06:15.155035 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m11:06:15.158458 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_pipeline.historical_customers"
[0m11:06:15.160447 [debug] [Thread-1 (]: Began executing node model.data_pipeline.current_customers
[0m11:06:15.176464 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.current_customers"
[0m11:06:15.176464 [debug] [Thread-2 (]: Began executing node model.data_pipeline.customer_activity
[0m11:06:15.188599 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m11:06:15.188599 [debug] [Thread-3 (]: Began executing node model.data_pipeline.historical_customers
[0m11:06:15.191689 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_pipeline.historical_customers"
[0m11:06:15.192692 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m11:06:15.192692 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m11:06:15.194826 [debug] [Thread-2 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema_snapshot_data.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m11:06:15.194826 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m11:06:15.194826 [debug] [Thread-1 (]: On model.data_pipeline.current_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.current_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NULL
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */;
[0m11:06:15.194826 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:06:15.194826 [debug] [Thread-3 (]: On model.data_pipeline.historical_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.historical_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NOT NULL
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */;
[0m11:06:15.194826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:06:15.194826 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:06:16.449400 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.253 seconds
[0m11:06:16.468410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.273 seconds
[0m11:06:16.472868 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD43AA5D0>]}
[0m11:06:16.472868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CDB550230>]}
[0m11:06:16.472868 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_schema_snapshot_data.customer_activity ... [[32mSUCCESS 1[0m in 1.32s]
[0m11:06:16.472868 [debug] [Thread-2 (]: Finished running node model.data_pipeline.customer_activity
[0m11:06:16.472868 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_schema_snapshot_data.current_customers ... [[32mSUCCESS 1[0m in 1.33s]
[0m11:06:16.472868 [debug] [Thread-1 (]: Finished running node model.data_pipeline.current_customers
[0m11:06:16.860909 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.665 seconds
[0m11:06:16.860909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eadcfdf-1f6a-4113-b409-ed5bd881bf89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CDB5AA150>]}
[0m11:06:16.860909 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dbt_schema_snapshot_data.historical_customers  [[32mSUCCESS 1[0m in 1.72s]
[0m11:06:16.860909 [debug] [Thread-3 (]: Finished running node model.data_pipeline.historical_customers
[0m11:06:16.860909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:16.860909 [debug] [MainThread]: Connection 'create_dbt_db_dbt_schema_snapshot_data' was left open.
[0m11:06:16.860909 [debug] [MainThread]: On create_dbt_db_dbt_schema_snapshot_data: Close
[0m11:06:17.273604 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m11:06:17.273604 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m11:06:17.522848 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema_snapshot_data' was left open.
[0m11:06:17.522848 [debug] [MainThread]: On list_dbt_db_dbt_schema_snapshot_data: Close
[0m11:06:17.929813 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m11:06:17.930903 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m11:06:18.269348 [debug] [MainThread]: Connection 'model.data_pipeline.current_customers' was left open.
[0m11:06:18.270351 [debug] [MainThread]: On model.data_pipeline.current_customers: Close
[0m11:06:18.509012 [debug] [MainThread]: Connection 'model.data_pipeline.customer_activity' was left open.
[0m11:06:18.509012 [debug] [MainThread]: On model.data_pipeline.customer_activity: Close
[0m11:06:19.000724 [debug] [MainThread]: Connection 'model.data_pipeline.historical_customers' was left open.
[0m11:06:19.000724 [debug] [MainThread]: On model.data_pipeline.historical_customers: Close
[0m11:06:19.182941 [info ] [MainThread]: 
[0m11:06:19.184325 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m11:06:19.185351 [debug] [MainThread]: Command end result
[0m11:06:19.210364 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:06:19.212364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:06:19.217364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m11:06:19.218364 [info ] [MainThread]: 
[0m11:06:19.218364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:19.219364 [info ] [MainThread]: 
[0m11:06:19.219364 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:06:19.220366 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:19.220366 after 10.55 seconds
[0m11:06:19.220366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD707DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD732D370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD4D52B70>]}
[0m11:06:19.221364 [debug] [MainThread]: Flushing usage events
[0m11:06:20.635736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:35.490537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F0B37EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F148F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F1674C80>]}


============================== 11:08:35.496142 | 2a1a1d95-7764-4915-aad3-52c4c6f22e43 ==============================
[0m11:08:35.496142 [info ] [MainThread]: Running with dbt=1.10.5
[0m11:08:35.496142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select snapshot_check_data', 'send_anonymous_usage_stats': 'True'}
[0m11:08:35.982664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a1a1d95-7764-4915-aad3-52c4c6f22e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F0B37EC0>]}
[0m11:08:36.034031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a1a1d95-7764-4915-aad3-52c4c6f22e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F38321B0>]}
[0m11:08:36.034031 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:08:36.329969 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m11:08:36.518060 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:08:36.518060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a1a1d95-7764-4915-aad3-52c4c6f22e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F15FEFC0>]}
[0m11:08:38.220608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a1a1d95-7764-4915-aad3-52c4c6f22e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F43F3620>]}
[0m11:08:38.316684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:08:38.318682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:08:38.339682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a1a1d95-7764-4915-aad3-52c4c6f22e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F47FF9E0>]}
[0m11:08:38.339682 [info ] [MainThread]: Found 8 models, 2 snapshots, 13 data tests, 1 seed, 3 sources, 594 macros
[0m11:08:38.340686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1a1d95-7764-4915-aad3-52c4c6f22e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F3E768A0>]}
[0m11:08:38.341682 [info ] [MainThread]: 
[0m11:08:38.342682 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:08:38.342682 [info ] [MainThread]: 
[0m11:08:38.343688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:08:38.347688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_your_snowflake_database_name'
[0m11:08:38.419039 [debug] [ThreadPool]: Using snowflake connection "list_your_snowflake_database_name"
[0m11:08:38.420039 [debug] [ThreadPool]: On list_your_snowflake_database_name: show terse schemas in database your_snowflake_database_name
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_your_snowflake_database_name"} */
[0m11:08:38.420039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:40.870824 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bfd472-3202-0771-0010-8a1200033342
[0m11:08:40.870824 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:08:40.871944 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:08:40.871944 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:08:40.872957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:40.872957 [debug] [MainThread]: Connection 'list_your_snowflake_database_name' was left open.
[0m11:08:40.873954 [debug] [MainThread]: On list_your_snowflake_database_name: Close
[0m11:08:41.054713 [info ] [MainThread]: 
[0m11:08:41.054713 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m11:08:41.055728 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "your_snowflake_database_name"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m11:08:41.057714 [debug] [MainThread]: Command `dbt run` failed at 11:08:41.056712 after 5.73 seconds
[0m11:08:41.057714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F1702360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F4566CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174F4316690>]}
[0m11:08:41.057714 [debug] [MainThread]: Flushing usage events
[0m11:08:42.256505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:06.813544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBE7133E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBE44FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBE44EED0>]}


============================== 11:09:06.818228 | f66c9d35-1b48-4931-bce0-639f62ca9698 ==============================
[0m11:09:06.818228 [info ] [MainThread]: Running with dbt=1.10.5
[0m11:09:06.818228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select snapshot_check_data', 'send_anonymous_usage_stats': 'True'}
[0m11:09:07.275464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBED8E990>]}
[0m11:09:07.327152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC09F2180>]}
[0m11:09:07.328155 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:09:07.591835 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m11:09:07.791484 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:09:07.791865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC0DA75F0>]}
[0m11:09:09.520509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC14EFB90>]}
[0m11:09:09.613055 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:09:09.613055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:09:09.629020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC1680110>]}
[0m11:09:09.629020 [info ] [MainThread]: Found 8 models, 2 snapshots, 13 data tests, 1 seed, 3 sources, 594 macros
[0m11:09:09.629020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC1437CB0>]}
[0m11:09:09.629020 [info ] [MainThread]: 
[0m11:09:09.629020 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:09:09.629020 [info ] [MainThread]: 
[0m11:09:09.629020 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:09.646138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:09:09.704762 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:09:09.717922 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:09:09.717922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:12.013058 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.300 seconds
[0m11:09:12.019244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m11:09:12.028838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m11:09:12.028838 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m11:09:12.028838 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m11:09:12.037415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema_snapshot_data'
[0m11:09:12.037415 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m11:09:12.037415 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m11:09:12.038939 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema_snapshot_data"
[0m11:09:12.038939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:12.038939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:12.038939 [debug] [ThreadPool]: On list_dbt_db_dbt_schema_snapshot_data: show objects in dbt_db.dbt_schema_snapshot_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema_snapshot_data"} */;
[0m11:09:12.041089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:12.788151 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.753 seconds
[0m11:09:12.956474 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.914 seconds
[0m11:09:12.978108 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.939 seconds
[0m11:09:12.981582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC174B6E0>]}
[0m11:09:12.987089 [debug] [Thread-1 (]: Began running node model.data_pipeline.current_customers
[0m11:09:12.987089 [debug] [Thread-2 (]: Began running node model.data_pipeline.customer_activity
[0m11:09:12.988594 [debug] [Thread-3 (]: Began running node model.data_pipeline.historical_customers
[0m11:09:12.987089 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_schema_snapshot_data.current_customers ........ [RUN]
[0m11:09:12.988594 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_schema_snapshot_data.customer_activity ........ [RUN]
[0m11:09:12.989617 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.current_customers'
[0m11:09:12.989617 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.customer_activity'
[0m11:09:12.988594 [info ] [Thread-3 (]: 3 of 3 START sql table model dbt_schema_snapshot_data.historical_customers ..... [RUN]
[0m11:09:12.990615 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.current_customers
[0m11:09:12.990615 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.customer_activity
[0m11:09:12.991615 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_pipeline.historical_customers'
[0m11:09:12.996617 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.current_customers"
[0m11:09:12.999614 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m11:09:12.999614 [debug] [Thread-3 (]: Began compiling node model.data_pipeline.historical_customers
[0m11:09:13.001614 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_pipeline.historical_customers"
[0m11:09:13.002619 [debug] [Thread-2 (]: Began executing node model.data_pipeline.customer_activity
[0m11:09:13.008938 [debug] [Thread-1 (]: Began executing node model.data_pipeline.current_customers
[0m11:09:13.032594 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.current_customers"
[0m11:09:13.038594 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m11:09:13.039595 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m11:09:13.039595 [debug] [Thread-3 (]: Began executing node model.data_pipeline.historical_customers
[0m11:09:13.040734 [debug] [Thread-2 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema_snapshot_data.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m11:09:13.040734 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m11:09:13.043742 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_pipeline.historical_customers"
[0m11:09:13.043742 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:09:13.043742 [debug] [Thread-1 (]: On model.data_pipeline.current_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.current_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NULL
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */;
[0m11:09:13.045741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:13.046741 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m11:09:13.047742 [debug] [Thread-3 (]: On model.data_pipeline.historical_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.historical_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NOT NULL
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */;
[0m11:09:13.048741 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:09:14.192043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.147 seconds
[0m11:09:14.193043 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.150 seconds
[0m11:09:14.215968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBBC3A870>]}
[0m11:09:14.215968 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC15936B0>]}
[0m11:09:14.217077 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_schema_snapshot_data.current_customers ... [[32mSUCCESS 1[0m in 1.22s]
[0m11:09:14.217077 [debug] [Thread-1 (]: Finished running node model.data_pipeline.current_customers
[0m11:09:14.217077 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_schema_snapshot_data.customer_activity ... [[32mSUCCESS 1[0m in 1.23s]
[0m11:09:14.218388 [debug] [Thread-2 (]: Finished running node model.data_pipeline.customer_activity
[0m11:09:14.520163 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.472 seconds
[0m11:09:14.522161 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66c9d35-1b48-4931-bce0-639f62ca9698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC2E1A2A0>]}
[0m11:09:14.523172 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dbt_schema_snapshot_data.historical_customers  [[32mSUCCESS 1[0m in 1.53s]
[0m11:09:14.524234 [debug] [Thread-3 (]: Finished running node model.data_pipeline.historical_customers
[0m11:09:14.525251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:14.525251 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:09:14.526247 [debug] [MainThread]: On list_dbt_db: Close
[0m11:09:14.724727 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m11:09:14.724727 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m11:09:15.098502 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m11:09:15.099502 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m11:09:15.509951 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema_snapshot_data' was left open.
[0m11:09:15.510951 [debug] [MainThread]: On list_dbt_db_dbt_schema_snapshot_data: Close
[0m11:09:15.699679 [debug] [MainThread]: Connection 'model.data_pipeline.current_customers' was left open.
[0m11:09:15.700676 [debug] [MainThread]: On model.data_pipeline.current_customers: Close
[0m11:09:15.921902 [debug] [MainThread]: Connection 'model.data_pipeline.customer_activity' was left open.
[0m11:09:15.922429 [debug] [MainThread]: On model.data_pipeline.customer_activity: Close
[0m11:09:16.331422 [debug] [MainThread]: Connection 'model.data_pipeline.historical_customers' was left open.
[0m11:09:16.331422 [debug] [MainThread]: On model.data_pipeline.historical_customers: Close
[0m11:09:16.509056 [info ] [MainThread]: 
[0m11:09:16.510057 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m11:09:16.511059 [debug] [MainThread]: Command end result
[0m11:09:16.534565 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:09:16.537565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:09:16.542121 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m11:09:16.542121 [info ] [MainThread]: 
[0m11:09:16.543123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:16.543123 [info ] [MainThread]: 
[0m11:09:16.544121 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:09:16.545128 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:16.545128 after 9.86 seconds
[0m11:09:16.545128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBE4C4B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBEBBD6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC121F5C0>]}
[0m11:09:16.545128 [debug] [MainThread]: Flushing usage events
[0m11:09:18.142263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:39.356217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCF92CDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCF8A9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCFE71100>]}


============================== 11:09:39.361516 | a1394dc9-b2ff-42d3-b8da-6968ccc2e71d ==============================
[0m11:09:39.361516 [info ] [MainThread]: Running with dbt=1.10.5
[0m11:09:39.362526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select snapshot_check_data', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:09:39.860322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD1B3AF90>]}
[0m11:09:39.910893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2007290>]}
[0m11:09:39.912898 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:09:40.205732 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m11:09:40.393021 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:09:40.394556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD254BEC0>]}
[0m11:09:42.202490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD26EEB10>]}
[0m11:09:42.302357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:09:42.304761 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:09:42.324398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD2885700>]}
[0m11:09:42.324398 [info ] [MainThread]: Found 8 models, 2 snapshots, 13 data tests, 1 seed, 3 sources, 594 macros
[0m11:09:42.324398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD24C4740>]}
[0m11:09:42.324398 [info ] [MainThread]: 
[0m11:09:42.324398 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:09:42.324398 [info ] [MainThread]: 
[0m11:09:42.330400 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:42.330400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:09:42.404631 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:09:42.404631 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:09:42.404631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:45.236252 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.845 seconds
[0m11:09:45.252561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m11:09:45.252561 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m11:09:45.252561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema_snapshot_data'
[0m11:09:45.252561 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m11:09:45.268302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m11:09:45.268302 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema_snapshot_data"
[0m11:09:45.268302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:45.268302 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m11:09:45.268302 [debug] [ThreadPool]: On list_dbt_db_dbt_schema_snapshot_data: show objects in dbt_db.dbt_schema_snapshot_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema_snapshot_data"} */;
[0m11:09:45.268302 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m11:09:45.268302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:45.268302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:45.954118 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.696 seconds
[0m11:09:46.288990 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.016 seconds
[0m11:09:46.523957 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.260 seconds
[0m11:09:46.535008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD26EF350>]}
[0m11:09:46.535008 [debug] [Thread-1 (]: Began running node model.data_pipeline.current_customers
[0m11:09:46.535008 [debug] [Thread-2 (]: Began running node model.data_pipeline.customer_activity
[0m11:09:46.535008 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_schema_snapshot_data.current_customers ........ [RUN]
[0m11:09:46.535008 [debug] [Thread-3 (]: Began running node model.data_pipeline.historical_customers
[0m11:09:46.535008 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.current_customers'
[0m11:09:46.535008 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_schema_snapshot_data.customer_activity ........ [RUN]
[0m11:09:46.535008 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.current_customers
[0m11:09:46.535008 [info ] [Thread-3 (]: 3 of 3 START sql table model dbt_schema_snapshot_data.historical_customers ..... [RUN]
[0m11:09:46.535008 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.customer_activity'
[0m11:09:46.553818 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.current_customers"
[0m11:09:46.554817 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_pipeline.historical_customers'
[0m11:09:46.554817 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.customer_activity
[0m11:09:46.555814 [debug] [Thread-3 (]: Began compiling node model.data_pipeline.historical_customers
[0m11:09:46.558391 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m11:09:46.560389 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_pipeline.historical_customers"
[0m11:09:46.561390 [debug] [Thread-1 (]: Began executing node model.data_pipeline.current_customers
[0m11:09:46.586917 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.current_customers"
[0m11:09:46.586917 [debug] [Thread-3 (]: Began executing node model.data_pipeline.historical_customers
[0m11:09:46.586917 [debug] [Thread-2 (]: Began executing node model.data_pipeline.customer_activity
[0m11:09:46.593601 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_pipeline.historical_customers"
[0m11:09:46.597436 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m11:09:46.597436 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m11:09:46.597436 [debug] [Thread-1 (]: On model.data_pipeline.current_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.current_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NULL
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */;
[0m11:09:46.597436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:46.600269 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m11:09:46.600269 [debug] [Thread-2 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema_snapshot_data.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m11:09:46.602019 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m11:09:46.602019 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:09:46.602945 [debug] [Thread-3 (]: On model.data_pipeline.historical_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.historical_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NOT NULL
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */;
[0m11:09:46.603961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:09:47.606578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.007 seconds
[0m11:09:47.626595 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.022 seconds
[0m11:09:47.628590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCCE8A540>]}
[0m11:09:47.628590 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD40A7FB0>]}
[0m11:09:47.629729 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_schema_snapshot_data.current_customers ... [[32mSUCCESS 1[0m in 1.09s]
[0m11:09:47.630746 [debug] [Thread-1 (]: Finished running node model.data_pipeline.current_customers
[0m11:09:47.629729 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dbt_schema_snapshot_data.historical_customers  [[32mSUCCESS 1[0m in 1.07s]
[0m11:09:47.630746 [debug] [Thread-3 (]: Finished running node model.data_pipeline.historical_customers
[0m11:09:47.934327 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.332 seconds
[0m11:09:47.936481 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1394dc9-b2ff-42d3-b8da-6968ccc2e71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DD401E450>]}
[0m11:09:47.937481 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_schema_snapshot_data.customer_activity ... [[32mSUCCESS 1[0m in 1.40s]
[0m11:09:47.938169 [debug] [Thread-2 (]: Finished running node model.data_pipeline.customer_activity
[0m11:09:47.939655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:47.940742 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:09:47.940742 [debug] [MainThread]: On list_dbt_db: Close
[0m11:09:48.181844 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m11:09:48.182610 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m11:09:48.367468 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema_snapshot_data' was left open.
[0m11:09:48.368473 [debug] [MainThread]: On list_dbt_db_dbt_schema_snapshot_data: Close
[0m11:09:48.576862 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m11:09:48.577877 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m11:09:48.921853 [debug] [MainThread]: Connection 'model.data_pipeline.current_customers' was left open.
[0m11:09:48.921853 [debug] [MainThread]: On model.data_pipeline.current_customers: Close
[0m11:09:49.120136 [debug] [MainThread]: Connection 'model.data_pipeline.customer_activity' was left open.
[0m11:09:49.120136 [debug] [MainThread]: On model.data_pipeline.customer_activity: Close
[0m11:09:49.417463 [debug] [MainThread]: Connection 'model.data_pipeline.historical_customers' was left open.
[0m11:09:49.417463 [debug] [MainThread]: On model.data_pipeline.historical_customers: Close
[0m11:09:49.745437 [info ] [MainThread]: 
[0m11:09:49.745437 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.42 seconds (7.42s).
[0m11:09:49.746436 [debug] [MainThread]: Command end result
[0m11:09:49.770387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:09:49.775098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:09:49.775098 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m11:09:49.775098 [info ] [MainThread]: 
[0m11:09:49.775098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:49.775098 [info ] [MainThread]: 
[0m11:09:49.775098 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:09:49.775098 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:49.775098 after 10.54 seconds
[0m11:09:49.784133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCFFB0CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCF33ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCF2C1DF0>]}
[0m11:09:49.784133 [debug] [MainThread]: Flushing usage events
[0m11:09:52.132690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:39.009761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418F3FFB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418CE4C9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418F0027B0>]}


============================== 11:11:39.009761 | a6055105-f488-40d0-bb3a-9a05990d86a2 ==============================
[0m11:11:39.009761 [info ] [MainThread]: Running with dbt=1.10.5
[0m11:11:39.009761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m11:11:39.495735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418F5F8C20>]}
[0m11:11:39.558930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241913F7F80>]}
[0m11:11:39.558930 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:11:39.871502 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m11:11:40.132088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:40.132088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:40.188340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418EFC4890>]}
[0m11:11:40.285416 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:11:40.285416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:11:40.332665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024191C514C0>]}
[0m11:11:40.332665 [info ] [MainThread]: Found 8 models, 2 snapshots, 13 data tests, 1 seed, 3 sources, 594 macros
[0m11:11:40.340495 [info ] [MainThread]: 
[0m11:11:40.340495 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:11:40.341531 [info ] [MainThread]: 
[0m11:11:40.341531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:40.346598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:11:40.358136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:11:40.358136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:11:40.441450 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:11:40.441450 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:11:40.441450 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:11:40.441450 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:11:40.441450 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:11:40.441450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:40.441450 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:11:40.441450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:40.441450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:41.804705 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.352 seconds
[0m11:11:41.807184 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.353 seconds
[0m11:11:42.131262 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.676 seconds
[0m11:11:42.133259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m11:11:42.139760 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema_snapshot_data'
[0m11:11:42.144898 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m11:11:42.147899 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema_snapshot_data"
[0m11:11:42.147899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m11:11:42.148901 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m11:11:42.148901 [debug] [ThreadPool]: On list_dbt_db_dbt_schema_snapshot_data: show objects in dbt_db.dbt_schema_snapshot_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema_snapshot_data"} */;
[0m11:11:42.150899 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m11:11:42.150899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:42.150899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:42.150899 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m11:11:42.152900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:43.120040 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.967 seconds
[0m11:11:43.368374 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.217 seconds
[0m11:11:43.533100 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.382 seconds
[0m11:11:43.535101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241922FE450>]}
[0m11:11:43.541270 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m11:11:43.541270 [debug] [Thread-2 (]: Began running node seed.data_pipeline.customers
[0m11:11:43.542287 [debug] [Thread-3 (]: Began running node snapshot.data_pipeline.customer_snapshot
[0m11:11:43.542287 [debug] [Thread-4 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m11:11:43.543288 [debug] [Thread-5 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m11:11:43.542287 [info ] [Thread-1 (]: 1 of 24 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m11:11:43.543288 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m11:11:43.544287 [info ] [Thread-2 (]: 2 of 24 START seed file dbt_schema.customers ................................... [RUN]
[0m11:11:43.544287 [info ] [Thread-3 (]: 3 of 24 START snapshot snapshots.customer_snapshot ............................. [RUN]
[0m11:11:43.544287 [info ] [Thread-4 (]: 4 of 24 START test source_not_null_tpch_orders_o_orderkey ...................... [RUN]
[0m11:11:43.545288 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m11:11:43.545288 [info ] [Thread-5 (]: 5 of 24 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m11:11:43.546285 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m11:11:43.546285 [info ] [Thread-6 (]: 6 of 24 START test source_unique_tpch_orders_o_orderkey ........................ [RUN]
[0m11:11:43.547285 [debug] [Thread-3 (]: Acquiring new snowflake connection 'snapshot.data_pipeline.customer_snapshot'
[0m11:11:43.547285 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m11:11:43.548288 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m11:11:43.548288 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m11:11:43.548288 [debug] [Thread-2 (]: Began compiling node seed.data_pipeline.customers
[0m11:11:43.549288 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m11:11:43.549288 [debug] [Thread-3 (]: Began compiling node snapshot.data_pipeline.customer_snapshot
[0m11:11:43.549288 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m11:11:43.565727 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m11:11:43.565727 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m11:11:43.566727 [debug] [Thread-2 (]: Began executing node seed.data_pipeline.customers
[0m11:11:43.567232 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m11:11:43.569821 [debug] [Thread-3 (]: Began executing node snapshot.data_pipeline.customer_snapshot
[0m11:11:43.578827 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m11:11:43.584826 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m11:11:43.606829 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m11:11:43.631558 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m11:11:43.645658 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:43.655165 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:11:43.664384 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:43.674385 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m11:11:43.674385 [debug] [Thread-4 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m11:11:43.675399 [debug] [Thread-2 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m11:11:43.675399 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:11:43.675399 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m11:11:43.676395 [debug] [Thread-5 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m11:11:43.695285 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m11:11:43.695285 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:11:43.698388 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m11:11:43.699393 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m11:11:43.703686 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m11:11:43.706778 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m11:11:43.708799 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m11:11:43.708799 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:11:43.709797 [debug] [Thread-4 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
[0m11:11:43.710800 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m11:11:43.712818 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m11:11:43.712818 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:11:43.714824 [debug] [Thread-6 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
[0m11:11:43.715818 [debug] [Thread-5 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
[0m11:11:43.716819 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m11:11:43.717820 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m11:11:44.446215 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.770 seconds
[0m11:11:44.447215 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m11:11:44.490519 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:44.499526 [info ] [Thread-4 (]: 4 of 24 PASS source_not_null_tpch_orders_o_orderkey ............................ [[32mPASS[0m in 0.95s]
[0m11:11:44.500526 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m11:11:44.501526 [debug] [Thread-4 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m11:11:44.687613 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m11:11:44.688649 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.971 seconds
[0m11:11:44.689646 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:11:44.690655 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.974 seconds
[0m11:11:44.692656 [debug] [Thread-2 (]: On seed.data_pipeline.customers: truncate table "DBT_DB"."DBT_SCHEMA"."CUSTOMERS"
  
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */;
[0m11:11:44.691657 [info ] [Thread-5 (]: 5 of 24 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 1.14s]
[0m11:11:44.694655 [info ] [Thread-6 (]: 6 of 24 PASS source_unique_tpch_orders_o_orderkey .............................. [[32mPASS[0m in 1.14s]
[0m11:11:44.695656 [debug] [Thread-5 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m11:11:44.696654 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m11:11:44.697655 [debug] [Thread-8 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m11:11:44.697655 [info ] [Thread-8 (]: 7 of 24 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m11:11:44.698699 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m11:11:44.699655 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m11:11:44.701655 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m11:11:44.702655 [debug] [Thread-8 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m11:11:44.705655 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m11:11:44.707663 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m11:11:44.707663 [debug] [Thread-8 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m11:11:44.707663 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m11:11:44.711934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.003 seconds
[0m11:11:44.728153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418E8B0800>]}
[0m11:11:44.729150 [info ] [Thread-1 (]: 1 of 24 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 1.18s]
[0m11:11:44.729150 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m11:11:44.914020 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m11:11:44.915020 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:11:44.915020 [debug] [Thread-2 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m11:11:45.090891 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m11:11:45.090891 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:45.090891 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:45.139454 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m11:11:45.139454 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:11:45.154590 [debug] [Thread-2 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m11:11:45.340020 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.238 seconds
[0m11:11:45.340020 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:45.340020 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:45.340020 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m11:11:45.355322 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:11:45.356328 [debug] [Thread-2 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m11:11:45.510641 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.157 seconds
[0m11:11:45.514651 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:45.514651 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:45.604886 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.897 seconds
[0m11:11:45.604886 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419356A480>]}
[0m11:11:45.604886 [info ] [Thread-8 (]: 7 of 24 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 0.91s]
[0m11:11:45.604886 [debug] [Thread-8 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m11:11:45.604886 [debug] [Thread-10 ]: Began running node model.data_pipeline.int_order_items
[0m11:11:45.604886 [info ] [Thread-10 ]: 8 of 24 START sql table model dbt_schema.int_order_items ....................... [RUN]
[0m11:11:45.604886 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m11:11:45.604886 [debug] [Thread-10 ]: Began compiling node model.data_pipeline.int_order_items
[0m11:11:45.604886 [debug] [Thread-10 ]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m11:11:45.604886 [debug] [Thread-10 ]: Began executing node model.data_pipeline.int_order_items
[0m11:11:45.627602 [debug] [Thread-10 ]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m11:11:45.627602 [debug] [Thread-10 ]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m11:11:45.627602 [debug] [Thread-10 ]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m11:11:45.627602 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m11:11:45.627602 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m11:11:45.641806 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:45.641806 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:45.757372 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.115 seconds
[0m11:11:45.757372 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.402 seconds
[0m11:11:45.764779 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:45.764779 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:11:45.764779 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:45.766254 [debug] [Thread-2 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m11:11:45.913387 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.158 seconds
[0m11:11:45.930739 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:45.930739 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:46.169258 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m11:11:46.173457 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m11:11:46.173457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241935BEFC0>]}
[0m11:11:46.182643 [info ] [Thread-2 (]: 2 of 24 OK loaded seed file dbt_schema.customers ............................... [[32mINSERT 4[0m in 2.63s]
[0m11:11:46.182643 [debug] [Thread-2 (]: Finished running node seed.data_pipeline.customers
[0m11:11:46.182643 [debug] [Thread-4 (]: Began running node snapshot.data_pipeline.customer_snapshot_check
[0m11:11:46.182643 [info ] [Thread-4 (]: 9 of 24 START snapshot snapshots.customer_snapshot_check ....................... [RUN]
[0m11:11:46.182643 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b, now snapshot.data_pipeline.customer_snapshot_check)
[0m11:11:46.182643 [debug] [Thread-4 (]: Began compiling node snapshot.data_pipeline.customer_snapshot_check
[0m11:11:46.188175 [debug] [Thread-4 (]: Began executing node snapshot.data_pipeline.customer_snapshot_check
[0m11:11:46.207162 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:46.207162 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select customer_name, customer_status from (
                
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:46.207162 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.267 seconds
[0m11:11:46.207162 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:46.207162 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:46.499254 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.289 seconds
[0m11:11:46.499254 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.287 seconds
[0m11:11:46.499254 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:46.499254 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot"
[0m11:11:46.499254 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:46.511826 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:46.511826 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:46.662590 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.153 seconds
[0m11:11:46.662590 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m11:11:46.665203 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:46.665203 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:46.665203 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:46.665203 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m11:11:46.774395 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.108 seconds
[0m11:11:46.774395 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:46.774395 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
as (
    
    
    with snapshot_query as (

        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m11:11:47.156830 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.487 seconds
[0m11:11:47.157832 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:11:47.157832 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:11:47.417545 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m11:11:47.421573 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:47.421573 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:47.497831 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.339 seconds
[0m11:11:47.501995 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419229E150>]}
[0m11:11:47.502995 [info ] [Thread-3 (]: 3 of 24 OK snapshotted snapshots.customer_snapshot ............................. [[32mSUCCESS 0[0m in 3.96s]
[0m11:11:47.504227 [debug] [Thread-3 (]: Finished running node snapshot.data_pipeline.customer_snapshot
[0m11:11:47.504995 [debug] [Thread-6 (]: Began running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m11:11:47.506009 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_current_customer
[0m11:11:47.506995 [info ] [Thread-6 (]: 10 of 24 START test not_null_customer_snapshot_customer_id ..................... [RUN]
[0m11:11:47.507995 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2, now test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414)
[0m11:11:47.506995 [info ] [Thread-9 (]: 11 of 24 START test unique_current_customer .................................... [RUN]
[0m11:11:47.507995 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m11:11:47.508995 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_current_customer'
[0m11:11:47.511995 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m11:11:47.512995 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_current_customer
[0m11:11:47.516361 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_current_customer"
[0m11:11:47.517371 [debug] [Thread-6 (]: Began executing node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m11:11:47.518372 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_current_customer
[0m11:11:47.520669 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m11:11:47.522669 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_current_customer"
[0m11:11:47.523669 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_current_customer"
[0m11:11:47.523669 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m11:11:47.525051 [debug] [Thread-9 (]: On test.data_pipeline.unique_current_customer: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Ensure there is only one current record per customer in the snapshot

SELECT 
    customer_id
FROM dbt_db.snapshots.customer_snapshot
WHERE dbt_valid_to IS NULL
GROUP BY customer_id
HAVING COUNT(*) > 1
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_current_customer"} */
[0m11:11:47.525051 [debug] [Thread-6 (]: On test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dbt_db.snapshots.customer_snapshot
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"} */
[0m11:11:47.525051 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m11:11:47.538262 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.117 seconds
[0m11:11:47.541662 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:47.542662 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:47.744434 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.202 seconds
[0m11:11:47.748435 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:47.749434 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m11:11:47.749434 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:47.751434 [info ] [Thread-6 (]: 10 of 24 PASS not_null_customer_snapshot_customer_id ........................... [[32mPASS[0m in 0.24s]
[0m11:11:47.752425 [debug] [Thread-6 (]: Finished running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m11:11:47.993662 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.242 seconds
[0m11:11:47.996709 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:47.997721 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:48.164391 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.166 seconds
[0m11:11:48.167389 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:48.168389 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:48.306713 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.139 seconds
[0m11:11:48.311797 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:48.312796 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        
    
    with snapshot_query as (

        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:48.745646 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 1.220 seconds
[0m11:11:48.745646 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.433 seconds
[0m11:11:48.748892 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:48.747891 [info ] [Thread-9 (]: 11 of 24 PASS unique_current_customer .......................................... [[32mPASS[0m in 1.24s]
[0m11:11:48.749892 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:48.749892 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_current_customer
[0m11:11:48.750893 [debug] [Thread-8 (]: Began running node model.data_pipeline.customer_activity
[0m11:11:48.751892 [info ] [Thread-8 (]: 12 of 24 START sql table model dbt_schema_snapshot_data.customer_activity ...... [RUN]
[0m11:11:48.752891 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.data_pipeline.stg_tpch_orders, now model.data_pipeline.customer_activity)
[0m11:11:48.752891 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.customer_activity
[0m11:11:48.755889 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m11:11:48.756900 [debug] [Thread-8 (]: Began executing node model.data_pipeline.customer_activity
[0m11:11:48.760899 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m11:11:48.762899 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m11:11:48.762899 [debug] [Thread-8 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema_snapshot_data.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m11:11:48.979754 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.229 seconds
[0m11:11:48.979754 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:48.981922 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:48.981922 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:49.129196 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m11:11:49.129196 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:49.130196 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m11:11:49.634684 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.872 seconds
[0m11:11:49.718067 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418C5C90D0>]}
[0m11:11:49.719070 [info ] [Thread-8 (]: 12 of 24 OK created sql table model dbt_schema_snapshot_data.customer_activity . [[32mSUCCESS 1[0m in 0.97s]
[0m11:11:49.720072 [debug] [Thread-8 (]: Finished running node model.data_pipeline.customer_activity
[0m11:11:50.295751 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 1.165 seconds
[0m11:11:50.295751 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:11:50.296749 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:11:50.572707 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m11:11:50.575889 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419362BD40>]}
[0m11:11:50.575889 [info ] [Thread-4 (]: 9 of 24 OK snapshotted snapshots.customer_snapshot_check ....................... [[32mSUCCESS 0[0m in 4.39s]
[0m11:11:50.576888 [debug] [Thread-4 (]: Finished running node snapshot.data_pipeline.customer_snapshot_check
[0m11:11:50.577888 [debug] [Thread-2 (]: Began running node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m11:11:50.578893 [debug] [Thread-5 (]: Began running node test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba
[0m11:11:50.578893 [info ] [Thread-2 (]: 13 of 24 START test not_null_customer_snapshot_check_customer_id ............... [RUN]
[0m11:11:50.579891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.data_pipeline.customers, now test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32)
[0m11:11:50.579891 [info ] [Thread-5 (]: 14 of 24 START test unique_customer_snapshot_check_customer_id ................. [RUN]
[0m11:11:50.580888 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m11:11:50.580888 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d, now test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba)
[0m11:11:50.584888 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m11:11:50.584888 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba
[0m11:11:50.589146 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba"
[0m11:11:50.589146 [debug] [Thread-5 (]: Began executing node test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba
[0m11:11:50.590577 [debug] [Thread-2 (]: Began executing node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m11:11:50.593578 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba"
[0m11:11:50.595577 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m11:11:50.597579 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba"
[0m11:11:50.597579 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m11:11:50.598577 [debug] [Thread-5 (]: On test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dbt_db.snapshots.customer_snapshot_check
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba"} */
[0m11:11:50.598577 [debug] [Thread-2 (]: On test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dbt_db.snapshots.customer_snapshot_check
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"} */
[0m11:11:50.626885 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.993 seconds
[0m11:11:50.628987 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241922CC1A0>]}
[0m11:11:50.628987 [info ] [Thread-10 ]: 8 of 24 OK created sql table model dbt_schema.int_order_items .................. [[32mSUCCESS 1[0m in 5.02s]
[0m11:11:50.630016 [debug] [Thread-10 ]: Finished running node model.data_pipeline.int_order_items
[0m11:11:50.630016 [debug] [Thread-1 (]: Began running node model.data_pipeline.int_order_items_summary
[0m11:11:50.631079 [info ] [Thread-1 (]: 15 of 24 START sql table model dbt_schema.int_order_items_summary .............. [RUN]
[0m11:11:50.631079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_pipeline.stg_tpch_line_items, now model.data_pipeline.int_order_items_summary)
[0m11:11:50.632132 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m11:11:50.634132 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m11:11:50.635429 [debug] [Thread-1 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m11:11:50.637564 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m11:11:50.639714 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m11:11:50.639714 [debug] [Thread-1 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m11:11:50.913439 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.313 seconds
[0m11:11:50.914437 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m11:11:50.915436 [info ] [Thread-2 (]: 13 of 24 PASS not_null_customer_snapshot_check_customer_id ..................... [[32mPASS[0m in 0.34s]
[0m11:11:50.917440 [debug] [Thread-2 (]: Finished running node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m11:11:50.917440 [error] [Thread-5 (]: 14 of 24 FAIL 1 unique_customer_snapshot_check_customer_id ..................... [[31mFAIL 1[0m in 0.34s]
[0m11:11:50.918439 [debug] [Thread-5 (]: Finished running node test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba
[0m11:11:50.919437 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:11:50.919437 [debug] [Thread-9 (]: Began running node model.data_pipeline.current_customers
[0m11:11:50.920439 [debug] [Thread-7 (]: Began running node model.data_pipeline.historical_customers
[0m11:11:50.920439 [info ] [Thread-9 (]: 16 of 24 SKIP relation dbt_schema_snapshot_data.current_customers .............. [[33mSKIP[0m]
[0m11:11:50.921438 [debug] [Thread-9 (]: Finished running node model.data_pipeline.current_customers
[0m11:11:50.921438 [debug] [Thread-13 ]: Marking all children of 'model.data_pipeline.current_customers' to be skipped because of status 'skipped'. 
[0m11:11:50.921438 [info ] [Thread-7 (]: 17 of 24 SKIP relation dbt_schema_snapshot_data.historical_customers ........... [[33mSKIP[0m]
[0m11:11:50.922438 [debug] [Thread-7 (]: Finished running node model.data_pipeline.historical_customers
[0m11:11:50.922438 [debug] [Thread-13 ]: Marking all children of 'model.data_pipeline.historical_customers' to be skipped because of status 'skipped'. 
[0m11:11:51.587572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.947 seconds
[0m11:11:51.589599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024191DAC620>]}
[0m11:11:51.590928 [info ] [Thread-1 (]: 15 of 24 OK created sql table model dbt_schema.int_order_items_summary ......... [[32mSUCCESS 1[0m in 0.96s]
[0m11:11:51.591962 [debug] [Thread-1 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m11:11:51.592958 [debug] [Thread-4 (]: Began running node model.data_pipeline.fct_orders
[0m11:11:51.592958 [info ] [Thread-4 (]: 18 of 24 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m11:11:51.593954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.data_pipeline.customer_snapshot_check, now model.data_pipeline.fct_orders)
[0m11:11:51.594954 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.fct_orders
[0m11:11:51.597954 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m11:11:51.598954 [debug] [Thread-4 (]: Began executing node model.data_pipeline.fct_orders
[0m11:11:51.601318 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m11:11:51.602326 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m11:11:51.602326 [debug] [Thread-4 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m11:11:52.870863 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.267 seconds
[0m11:11:52.872862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6055105-f488-40d0-bb3a-9a05990d86a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419233BE90>]}
[0m11:11:52.872862 [info ] [Thread-4 (]: 18 of 24 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 1.28s]
[0m11:11:52.873863 [debug] [Thread-4 (]: Finished running node model.data_pipeline.fct_orders
[0m11:11:52.874862 [debug] [Thread-10 ]: Began running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m11:11:52.875858 [debug] [Thread-6 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m11:11:52.875858 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_discount
[0m11:11:52.875858 [info ] [Thread-10 ]: 19 of 24 START test accepted_values_fct_orders_status_code__P__O__F ............ [RUN]
[0m11:11:52.876875 [debug] [Thread-5 (]: Began running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m11:11:52.877875 [debug] [Thread-8 (]: Began running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m11:11:52.876875 [info ] [Thread-6 (]: 20 of 24 START test fct_orders_date_valid ...................................... [RUN]
[0m11:11:52.877875 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m11:11:52.878874 [info ] [Thread-2 (]: 21 of 24 START test fct_orders_discount ........................................ [RUN]
[0m11:11:52.878874 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.data_pipeline.int_order_items, now test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048)
[0m11:11:52.879878 [info ] [Thread-5 (]: 22 of 24 START test not_null_fct_orders_order_key .............................. [RUN]
[0m11:11:52.880878 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414, now test.data_pipeline.fct_orders_date_valid)
[0m11:11:52.879878 [info ] [Thread-8 (]: 23 of 24 START test relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m11:11:52.884081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32, now test.data_pipeline.fct_orders_discount)
[0m11:11:52.885082 [debug] [Thread-10 ]: Began compiling node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m11:11:52.880878 [info ] [Thread-9 (]: 24 of 24 START test unique_fct_orders_order_key ................................ [RUN]
[0m11:11:52.886081 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.data_pipeline.unique_customer_snapshot_check_customer_id.1c524749ba, now test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15)
[0m11:11:52.886081 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m11:11:52.887275 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.data_pipeline.customer_activity, now test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce)
[0m11:11:52.887275 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m11:11:52.896782 [debug] [Thread-10 ]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m11:11:52.897790 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly test.data_pipeline.unique_current_customer, now test.data_pipeline.unique_fct_orders_order_key.f5e7a90273)
[0m11:11:52.897790 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m11:11:52.900789 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m11:11:52.901789 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m11:11:52.904986 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m11:11:52.904986 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m11:11:52.909045 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m11:11:52.915077 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m11:11:52.919546 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m11:11:52.919546 [debug] [Thread-10 ]: Began executing node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m11:11:52.920558 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m11:11:52.920558 [debug] [Thread-6 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m11:11:52.923567 [debug] [Thread-10 ]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m11:11:52.925908 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m11:11:52.926919 [debug] [Thread-5 (]: Began executing node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m11:11:52.928919 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m11:11:52.929921 [debug] [Thread-8 (]: Began executing node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m11:11:52.929921 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m11:11:52.933430 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m11:11:52.936489 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m11:11:52.938800 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m11:11:52.939803 [debug] [Thread-10 ]: Using snowflake connection "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m11:11:52.941106 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m11:11:52.942106 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m11:11:52.942106 [debug] [Thread-10 ]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_orders
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"} */
[0m11:11:52.943269 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_discount: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    item_discount_amount > 0
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
[0m11:11:52.944264 [debug] [Thread-6 (]: On test.data_pipeline.fct_orders_date_valid: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
[0m11:11:52.944264 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m11:11:52.945487 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m11:11:52.946487 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m11:11:52.949899 [debug] [Thread-5 (]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_key
from dbt_db.dbt_schema.fct_orders
where order_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"} */
[0m11:11:52.950899 [debug] [Thread-9 (]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_orders
where order_key is not null
group by order_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"} */
[0m11:11:52.951922 [debug] [Thread-8 (]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_orders
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"} */
[0m11:11:53.138160 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m11:11:53.142176 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m11:11:53.141189 [info ] [Thread-5 (]: 22 of 24 PASS not_null_fct_orders_order_key .................................... [[32mPASS[0m in 0.25s]
[0m11:11:53.144174 [debug] [Thread-5 (]: Finished running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m11:11:53.144174 [info ] [Thread-6 (]: 20 of 24 PASS fct_orders_date_valid ............................................ [[32mPASS[0m in 0.26s]
[0m11:11:53.145402 [debug] [Thread-6 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m11:11:53.300391 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m11:11:53.300391 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m11:11:53.301401 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.356 seconds
[0m11:11:53.302904 [info ] [Thread-2 (]: 21 of 24 PASS fct_orders_discount .............................................. [[32mPASS[0m in 0.42s]
[0m11:11:53.304909 [info ] [Thread-9 (]: 24 of 24 PASS unique_fct_orders_order_key ...................................... [[32mPASS[0m in 0.41s]
[0m11:11:53.306341 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m11:11:53.307356 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m11:11:53.306341 [info ] [Thread-10 ]: 19 of 24 PASS accepted_values_fct_orders_status_code__P__O__F .................. [[32mPASS[0m in 0.43s]
[0m11:11:53.308351 [debug] [Thread-10 ]: Finished running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m11:11:53.842256 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.888 seconds
[0m11:11:53.844719 [info ] [Thread-8 (]: 23 of 24 PASS relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [[32mPASS[0m in 0.96s]
[0m11:11:53.846719 [debug] [Thread-8 (]: Finished running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m11:11:53.848719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:53.849718 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:11:53.849718 [debug] [MainThread]: On list_dbt_db: Close
[0m11:11:54.044148 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:11:54.044148 [debug] [MainThread]: On list_dbt_db: Close
[0m11:11:54.226951 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:11:54.227948 [debug] [MainThread]: On list_dbt_db: Close
[0m11:11:54.453738 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m11:11:54.453738 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m11:11:54.702878 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema_snapshot_data' was left open.
[0m11:11:54.706888 [debug] [MainThread]: On list_dbt_db_dbt_schema_snapshot_data: Close
[0m11:11:54.946554 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m11:11:54.946554 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m11:11:55.185094 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m11:11:55.185094 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m11:11:55.556536 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m11:11:55.556536 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m11:11:55.778867 [debug] [MainThread]: Connection 'snapshot.data_pipeline.customer_snapshot' was left open.
[0m11:11:55.778867 [debug] [MainThread]: On snapshot.data_pipeline.customer_snapshot: Close
[0m11:11:56.021107 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m11:11:56.021107 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m11:11:56.362446 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15' was left open.
[0m11:11:56.363452 [debug] [MainThread]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: Close
[0m11:11:56.530669 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m11:11:56.530669 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m11:11:57.003541 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' was left open.
[0m11:11:57.004850 [debug] [MainThread]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: Close
[0m11:11:57.176473 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048' was left open.
[0m11:11:57.177473 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: Close
[0m11:11:57.589081 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273' was left open.
[0m11:11:57.590108 [debug] [MainThread]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: Close
[0m11:11:57.832498 [info ] [MainThread]: 
[0m11:11:57.832498 [info ] [MainThread]: Finished running 1 seed, 2 snapshots, 6 table models, 13 data tests, 2 view models in 0 hours 0 minutes and 17.49 seconds (17.49s).
[0m11:11:57.836494 [debug] [MainThread]: Command end result
[0m11:11:57.862641 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:11:57.865110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:11:57.872239 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m11:11:57.873238 [info ] [MainThread]: 
[0m11:11:57.873238 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:11:57.873238 [info ] [MainThread]: 
[0m11:11:57.874616 [error] [MainThread]: [31mFailure in test unique_customer_snapshot_check_customer_id (snapshots\snapshot_schema.yml)[0m
[0m11:11:57.874616 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:11:57.875631 [info ] [MainThread]: 
[0m11:11:57.875631 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\snapshots\snapshot_schema.yml\unique_customer_snapshot_check_customer_id.sql
[0m11:11:57.875631 [info ] [MainThread]: 
[0m11:11:57.876626 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=24
[0m11:11:57.877625 [debug] [MainThread]: Command `dbt build` failed at 11:11:57.877625 after 19.02 seconds
[0m11:11:57.877625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418F17E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418F581A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418F581CD0>]}
[0m11:11:57.877625 [debug] [MainThread]: Flushing usage events
[0m11:11:59.378839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:49.606308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216736F7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002167451A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002167404FF20>]}


============================== 11:12:49.611468 | b344bdb2-248f-491c-8da4-3377b5c0de9e ==============================
[0m11:12:49.611468 [info ] [MainThread]: Running with dbt=1.10.5
[0m11:12:49.612470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m11:12:50.078633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216769E6990>]}
[0m11:12:50.132508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216761AA270>]}
[0m11:12:50.133508 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:12:50.398244 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m11:12:50.654234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:12:50.655233 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://snapshots\snapshot_schema.yml
[0m11:12:51.001783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021676F9D160>]}
[0m11:12:51.099018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:12:51.101027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:12:51.136407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021677285E80>]}
[0m11:12:51.136407 [info ] [MainThread]: Found 8 models, 2 snapshots, 12 data tests, 1 seed, 3 sources, 594 macros
[0m11:12:51.140408 [info ] [MainThread]: 
[0m11:12:51.140408 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:12:51.140408 [info ] [MainThread]: 
[0m11:12:51.141408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:12:51.146411 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:12:51.146411 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:12:51.160107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m11:12:51.221835 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:12:51.221835 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:12:51.222834 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:12:51.223105 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m11:12:51.223105 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:12:51.223795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:51.223795 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m11:12:51.223795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:51.224808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:52.889787 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.665 seconds
[0m11:12:52.891792 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.668 seconds
[0m11:12:53.297902 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.074 seconds
[0m11:12:53.300576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema_snapshot_data'
[0m11:12:53.309779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m11:12:53.311880 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema_snapshot_data"
[0m11:12:53.311880 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m11:12:53.311880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m11:12:53.311880 [debug] [ThreadPool]: On list_dbt_db_dbt_schema_snapshot_data: show objects in dbt_db.dbt_schema_snapshot_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema_snapshot_data"} */;
[0m11:12:53.311880 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m11:12:53.311880 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m11:12:53.311880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:53.311880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:53.311880 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m11:12:53.311880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:54.084913 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.768 seconds
[0m11:12:54.116993 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.798 seconds
[0m11:12:54.203156 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.884 seconds
[0m11:12:54.203156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021677502030>]}
[0m11:12:54.213540 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m11:12:54.213540 [debug] [Thread-2 (]: Began running node seed.data_pipeline.customers
[0m11:12:54.213540 [debug] [Thread-3 (]: Began running node snapshot.data_pipeline.customer_snapshot
[0m11:12:54.213540 [debug] [Thread-4 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m11:12:54.213540 [info ] [Thread-1 (]: 1 of 23 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m11:12:54.219919 [debug] [Thread-5 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m11:12:54.219919 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m11:12:54.213540 [info ] [Thread-2 (]: 2 of 23 START seed file dbt_schema.customers ................................... [RUN]
[0m11:12:54.221336 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m11:12:54.219919 [info ] [Thread-3 (]: 3 of 23 START snapshot snapshots.customer_snapshot ............................. [RUN]
[0m11:12:54.221336 [info ] [Thread-4 (]: 4 of 23 START test source_not_null_tpch_orders_o_orderkey ...................... [RUN]
[0m11:12:54.221336 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m11:12:54.221336 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m11:12:54.221336 [info ] [Thread-5 (]: 5 of 23 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m11:12:54.221336 [debug] [Thread-3 (]: Acquiring new snowflake connection 'snapshot.data_pipeline.customer_snapshot'
[0m11:12:54.221336 [info ] [Thread-6 (]: 6 of 23 START test source_unique_tpch_orders_o_orderkey ........................ [RUN]
[0m11:12:54.225028 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m11:12:54.225028 [debug] [Thread-2 (]: Began compiling node seed.data_pipeline.customers
[0m11:12:54.239365 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m11:12:54.241107 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m11:12:54.241107 [debug] [Thread-3 (]: Began compiling node snapshot.data_pipeline.customer_snapshot
[0m11:12:54.241107 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m11:12:54.241107 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m11:12:54.241107 [debug] [Thread-2 (]: Began executing node seed.data_pipeline.customers
[0m11:12:54.243480 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m11:12:54.245163 [debug] [Thread-3 (]: Began executing node snapshot.data_pipeline.customer_snapshot
[0m11:12:54.245163 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m11:12:54.245163 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m11:12:54.265276 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m11:12:54.277386 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m11:12:54.318178 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:54.323449 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m11:12:54.340112 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m11:12:54.345195 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:12:54.345195 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:54.345195 [debug] [Thread-4 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m11:12:54.345195 [debug] [Thread-2 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m11:12:54.345195 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:12:54.353190 [debug] [Thread-5 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m11:12:54.359873 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m11:12:54.359873 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m11:12:54.359873 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:12:54.359873 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m11:12:54.359873 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m11:12:54.359873 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m11:12:54.377027 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m11:12:54.378448 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m11:12:54.378448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:12:54.378448 [debug] [Thread-4 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
[0m11:12:54.380081 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m11:12:54.381406 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m11:12:54.381406 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:12:54.381406 [debug] [Thread-5 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
[0m11:12:54.383163 [debug] [Thread-6 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
[0m11:12:54.383163 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m11:12:54.383163 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m11:12:54.946149 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m11:12:54.954212 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m11:12:54.954212 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m11:12:54.953203 [info ] [Thread-6 (]: 6 of 23 PASS source_unique_tpch_orders_o_orderkey .............................. [[32mPASS[0m in 0.71s]
[0m11:12:54.957754 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m11:12:54.956730 [info ] [Thread-4 (]: 4 of 23 PASS source_not_null_tpch_orders_o_orderkey ............................ [[32mPASS[0m in 0.73s]
[0m11:12:54.959831 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m11:12:54.959312 [info ] [Thread-5 (]: 5 of 23 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 0.72s]
[0m11:12:54.960361 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:12:54.960885 [debug] [Thread-4 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m11:12:54.961924 [debug] [Thread-5 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m11:12:54.961924 [debug] [Thread-2 (]: On seed.data_pipeline.customers: truncate table "DBT_DB"."DBT_SCHEMA"."CUSTOMERS"
  
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */;
[0m11:12:54.963492 [debug] [Thread-8 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m11:12:54.964015 [info ] [Thread-8 (]: 7 of 23 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m11:12:54.965089 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m11:12:54.965625 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m11:12:54.969413 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m11:12:54.970456 [debug] [Thread-8 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m11:12:54.973088 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m11:12:54.974648 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m11:12:54.974648 [debug] [Thread-8 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m11:12:54.975175 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m11:12:55.195784 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.843 seconds
[0m11:12:55.322269 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:55.323272 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m11:12:55.324270 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m11:12:55.325293 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:12:55.326272 [debug] [Thread-2 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m11:12:55.689844 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m11:12:55.689844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.311 seconds
[0m11:12:55.701451 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:12:55.717393 [debug] [Thread-2 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m11:12:55.718448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021673B207D0>]}
[0m11:12:55.719640 [info ] [Thread-1 (]: 1 of 23 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 1.49s]
[0m11:12:55.719640 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m11:12:55.814729 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m11:12:55.817086 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:55.817086 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:55.851465 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m11:12:55.852463 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:12:55.852463 [debug] [Thread-2 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m11:12:56.181749 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.207 seconds
[0m11:12:56.182749 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.365 seconds
[0m11:12:56.185749 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021678AAA0F0>]}
[0m11:12:56.188749 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:56.189826 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:56.189826 [info ] [Thread-8 (]: 7 of 23 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 1.22s]
[0m11:12:56.191857 [debug] [Thread-8 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m11:12:56.192893 [debug] [Thread-10 ]: Began running node model.data_pipeline.int_order_items
[0m11:12:56.192893 [info ] [Thread-10 ]: 8 of 23 START sql table model dbt_schema.int_order_items ....................... [RUN]
[0m11:12:56.193872 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m11:12:56.194869 [debug] [Thread-10 ]: Began compiling node model.data_pipeline.int_order_items
[0m11:12:56.198867 [debug] [Thread-10 ]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m11:12:56.198867 [debug] [Thread-10 ]: Began executing node model.data_pipeline.int_order_items
[0m11:12:56.213871 [debug] [Thread-10 ]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m11:12:56.214873 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.362 seconds
[0m11:12:56.215871 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m11:12:56.215871 [debug] [Thread-2 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m11:12:56.216871 [debug] [Thread-10 ]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m11:12:56.217871 [debug] [Thread-10 ]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m11:12:56.217871 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m11:12:56.426868 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.236 seconds
[0m11:12:56.430463 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:56.431467 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:56.728807 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.297 seconds
[0m11:12:56.733934 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:56.734935 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:56.735934 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m11:12:56.746509 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m11:12:56.750511 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021676C316D0>]}
[0m11:12:56.751699 [info ] [Thread-2 (]: 2 of 23 OK loaded seed file dbt_schema.customers ............................... [[32mINSERT 4[0m in 2.53s]
[0m11:12:56.752969 [debug] [Thread-2 (]: Finished running node seed.data_pipeline.customers
[0m11:12:56.753969 [debug] [Thread-6 (]: Began running node snapshot.data_pipeline.customer_snapshot_check
[0m11:12:56.755219 [info ] [Thread-6 (]: 9 of 23 START snapshot snapshots.customer_snapshot_check ....................... [RUN]
[0m11:12:56.756220 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2, now snapshot.data_pipeline.customer_snapshot_check)
[0m11:12:56.756220 [debug] [Thread-6 (]: Began compiling node snapshot.data_pipeline.customer_snapshot_check
[0m11:12:56.761520 [debug] [Thread-6 (]: Began executing node snapshot.data_pipeline.customer_snapshot_check
[0m11:12:56.799140 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:56.800140 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select customer_name, customer_status from (
                
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:57.003492 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.267 seconds
[0m11:12:57.010805 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:57.010805 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:57.019474 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.220 seconds
[0m11:12:57.023558 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:57.024716 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:57.422405 [debug] [Thread-6 (]: SQL status: SUCCESS 7 in 0.395 seconds
[0m11:12:57.424584 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.413 seconds
[0m11:12:57.427929 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:57.453082 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:57.453082 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:57.455939 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:57.572544 [debug] [Thread-6 (]: SQL status: SUCCESS 7 in 0.117 seconds
[0m11:12:57.572544 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:57.572544 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
as (
    
    
    with snapshot_query as (

        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m11:12:57.826500 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.370 seconds
[0m11:12:57.826500 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:57.826500 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:57.939954 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.107 seconds
[0m11:12:57.940474 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot"
[0m11:12:57.941592 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:57.941592 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:58.154836 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m11:12:58.154836 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:58.156843 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m11:12:58.312689 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m11:12:58.312689 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:58.312689 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:58.646395 [debug] [Thread-6 (]: SQL status: SUCCESS 9 in 0.325 seconds
[0m11:12:58.655216 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:58.655216 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:58.814663 [debug] [Thread-6 (]: SQL status: SUCCESS 7 in 0.158 seconds
[0m11:12:58.818677 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:58.818677 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:58.880343 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.732 seconds
[0m11:12:58.880343 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m11:12:58.880343 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m11:12:58.977963 [debug] [Thread-6 (]: SQL status: SUCCESS 9 in 0.160 seconds
[0m11:12:58.982287 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:58.982287 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:59.075912 [debug] [Thread-6 (]: SQL status: SUCCESS 7 in 0.105 seconds
[0m11:12:59.091932 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:59.091932 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:59.307752 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.417 seconds
[0m11:12:59.311464 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021676DBD4F0>]}
[0m11:12:59.313057 [debug] [Thread-6 (]: SQL status: SUCCESS 9 in 0.220 seconds
[0m11:12:59.312004 [info ] [Thread-3 (]: 3 of 23 OK snapshotted snapshots.customer_snapshot ............................. [[32mSUCCESS 0[0m in 5.09s]
[0m11:12:59.317723 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:59.318240 [debug] [Thread-3 (]: Finished running node snapshot.data_pipeline.customer_snapshot
[0m11:12:59.318764 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        
    
    with snapshot_query as (

        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:59.319818 [debug] [Thread-5 (]: Began running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m11:12:59.320330 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_current_customer
[0m11:12:59.320841 [info ] [Thread-5 (]: 10 of 23 START test not_null_customer_snapshot_customer_id ..................... [RUN]
[0m11:12:59.321879 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d, now test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414)
[0m11:12:59.321356 [info ] [Thread-9 (]: 11 of 23 START test unique_current_customer .................................... [RUN]
[0m11:12:59.322919 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m11:12:59.323525 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_current_customer'
[0m11:12:59.327671 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m11:12:59.328194 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_current_customer
[0m11:12:59.329216 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_current_customer"
[0m11:12:59.329216 [debug] [Thread-5 (]: Began executing node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m11:12:59.329216 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_current_customer
[0m11:12:59.329216 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m11:12:59.329216 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_current_customer"
[0m11:12:59.336064 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m11:12:59.336064 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_current_customer"
[0m11:12:59.337952 [debug] [Thread-5 (]: On test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dbt_db.snapshots.customer_snapshot
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"} */
[0m11:12:59.337952 [debug] [Thread-9 (]: On test.data_pipeline.unique_current_customer: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Ensure there is only one current record per customer in the snapshot

SELECT 
    customer_id
FROM dbt_db.snapshots.customer_snapshot
WHERE dbt_valid_to IS NULL
GROUP BY customer_id
HAVING COUNT(*) > 1
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_current_customer"} */
[0m11:12:59.339463 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m11:12:59.504737 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m11:12:59.520651 [info ] [Thread-5 (]: 10 of 23 PASS not_null_customer_snapshot_customer_id ........................... [[32mPASS[0m in 0.20s]
[0m11:12:59.520651 [debug] [Thread-5 (]: Finished running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m11:12:59.798304 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.482 seconds
[0m11:12:59.802286 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:59.802286 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:12:59.960506 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.164 seconds
[0m11:12:59.967725 [debug] [Thread-6 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:59.967725 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:12:59.969731 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:13:00.205196 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m11:13:00.213843 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:13:00.213843 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m11:13:00.277247 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.938 seconds
[0m11:13:00.279254 [info ] [Thread-9 (]: 11 of 23 PASS unique_current_customer .......................................... [[32mPASS[0m in 0.96s]
[0m11:13:00.279254 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_current_customer
[0m11:13:00.279254 [debug] [Thread-8 (]: Began running node model.data_pipeline.customer_activity
[0m11:13:00.279254 [info ] [Thread-8 (]: 12 of 23 START sql table model dbt_schema_snapshot_data.customer_activity ...... [RUN]
[0m11:13:00.279254 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.data_pipeline.stg_tpch_orders, now model.data_pipeline.customer_activity)
[0m11:13:00.279254 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.customer_activity
[0m11:13:00.287921 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m11:13:00.287921 [debug] [Thread-8 (]: Began executing node model.data_pipeline.customer_activity
[0m11:13:00.291916 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m11:13:00.291916 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m11:13:00.291916 [debug] [Thread-8 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema_snapshot_data.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m11:13:01.032209 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.819 seconds
[0m11:13:01.033202 [debug] [Thread-6 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m11:13:01.033202 [debug] [Thread-6 (]: On snapshot.data_pipeline.customer_snapshot_check: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m11:13:01.566852 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m11:13:01.567840 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 5.349 seconds
[0m11:13:01.569720 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216788F0AD0>]}
[0m11:13:01.570720 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.276 seconds
[0m11:13:01.572809 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021676F2FDA0>]}
[0m11:13:01.575208 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216788F14F0>]}
[0m11:13:01.573821 [info ] [Thread-6 (]: 9 of 23 OK snapshotted snapshots.customer_snapshot_check ....................... [[32mSUCCESS 0[0m in 4.81s]
[0m11:13:01.575208 [info ] [Thread-10 ]: 8 of 23 OK created sql table model dbt_schema.int_order_items .................. [[32mSUCCESS 1[0m in 5.38s]
[0m11:13:01.577211 [debug] [Thread-6 (]: Finished running node snapshot.data_pipeline.customer_snapshot_check
[0m11:13:01.577211 [debug] [Thread-10 ]: Finished running node model.data_pipeline.int_order_items
[0m11:13:01.576209 [info ] [Thread-8 (]: 12 of 23 OK created sql table model dbt_schema_snapshot_data.customer_activity . [[32mSUCCESS 1[0m in 1.30s]
[0m11:13:01.578209 [debug] [Thread-8 (]: Finished running node model.data_pipeline.customer_activity
[0m11:13:01.579381 [debug] [Thread-2 (]: Began running node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m11:13:01.579381 [debug] [Thread-8 (]: Began running node model.data_pipeline.int_order_items_summary
[0m11:13:01.580379 [info ] [Thread-2 (]: 13 of 23 START test not_null_customer_snapshot_check_customer_id ............... [RUN]
[0m11:13:01.581387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.data_pipeline.customers, now test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32)
[0m11:13:01.580379 [info ] [Thread-8 (]: 14 of 23 START sql table model dbt_schema.int_order_items_summary .............. [RUN]
[0m11:13:01.581387 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m11:13:01.582381 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.data_pipeline.customer_activity, now model.data_pipeline.int_order_items_summary)
[0m11:13:01.586375 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m11:13:01.586878 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m11:13:01.588881 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m11:13:01.589881 [debug] [Thread-8 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m11:13:01.589881 [debug] [Thread-2 (]: Began executing node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m11:13:01.592881 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m11:13:01.594881 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m11:13:01.595884 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m11:13:01.595884 [debug] [Thread-8 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m11:13:01.596885 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m11:13:01.597883 [debug] [Thread-2 (]: On test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dbt_db.snapshots.customer_snapshot_check
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"} */
[0m11:13:01.957686 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m11:13:01.959686 [info ] [Thread-2 (]: 13 of 23 PASS not_null_customer_snapshot_check_customer_id ..................... [[32mPASS[0m in 0.38s]
[0m11:13:01.960697 [debug] [Thread-2 (]: Finished running node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m11:13:01.961214 [debug] [Thread-3 (]: Began running node model.data_pipeline.current_customers
[0m11:13:01.961214 [debug] [Thread-1 (]: Began running node model.data_pipeline.historical_customers
[0m11:13:01.962228 [info ] [Thread-3 (]: 15 of 23 START sql table model dbt_schema_snapshot_data.current_customers ...... [RUN]
[0m11:13:01.963226 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.data_pipeline.customer_snapshot, now model.data_pipeline.current_customers)
[0m11:13:01.962228 [info ] [Thread-1 (]: 16 of 23 START sql table model dbt_schema_snapshot_data.historical_customers ... [RUN]
[0m11:13:01.963226 [debug] [Thread-3 (]: Began compiling node model.data_pipeline.current_customers
[0m11:13:01.964421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_pipeline.stg_tpch_line_items, now model.data_pipeline.historical_customers)
[0m11:13:01.967658 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_pipeline.current_customers"
[0m11:13:01.967658 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.historical_customers
[0m11:13:01.970656 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.historical_customers"
[0m11:13:01.971655 [debug] [Thread-3 (]: Began executing node model.data_pipeline.current_customers
[0m11:13:01.972655 [debug] [Thread-1 (]: Began executing node model.data_pipeline.historical_customers
[0m11:13:01.974655 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_pipeline.current_customers"
[0m11:13:01.978655 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.historical_customers"
[0m11:13:01.979655 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m11:13:01.979655 [debug] [Thread-3 (]: On model.data_pipeline.current_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.current_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NULL
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */;
[0m11:13:01.980654 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m11:13:01.980654 [debug] [Thread-1 (]: On model.data_pipeline.historical_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.historical_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NOT NULL
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */;
[0m11:13:02.670528 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m11:13:02.673564 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216770101A0>]}
[0m11:13:02.674793 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.077 seconds
[0m11:13:02.675564 [info ] [Thread-3 (]: 15 of 23 OK created sql table model dbt_schema_snapshot_data.current_customers . [[32mSUCCESS 1[0m in 0.71s]
[0m11:13:02.677564 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021677324BC0>]}
[0m11:13:02.678578 [debug] [Thread-3 (]: Finished running node model.data_pipeline.current_customers
[0m11:13:02.679574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m11:13:02.680551 [info ] [Thread-8 (]: 14 of 23 OK created sql table model dbt_schema.int_order_items_summary ......... [[32mSUCCESS 1[0m in 1.10s]
[0m11:13:02.681551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021676E8C0E0>]}
[0m11:13:02.682549 [debug] [Thread-8 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m11:13:02.683560 [info ] [Thread-1 (]: 16 of 23 OK created sql table model dbt_schema_snapshot_data.historical_customers  [[32mSUCCESS 1[0m in 0.72s]
[0m11:13:02.684685 [debug] [Thread-1 (]: Finished running node model.data_pipeline.historical_customers
[0m11:13:02.685189 [debug] [Thread-9 (]: Began running node model.data_pipeline.fct_orders
[0m11:13:02.685692 [info ] [Thread-9 (]: 17 of 23 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m11:13:02.686194 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly test.data_pipeline.unique_current_customer, now model.data_pipeline.fct_orders)
[0m11:13:02.686697 [debug] [Thread-9 (]: Began compiling node model.data_pipeline.fct_orders
[0m11:13:02.689208 [debug] [Thread-9 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m11:13:02.690211 [debug] [Thread-9 (]: Began executing node model.data_pipeline.fct_orders
[0m11:13:02.692220 [debug] [Thread-9 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m11:13:02.693224 [debug] [Thread-9 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m11:13:02.693726 [debug] [Thread-9 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m11:13:04.316270 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 1.622 seconds
[0m11:13:04.316270 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b344bdb2-248f-491c-8da4-3377b5c0de9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021678A8B800>]}
[0m11:13:04.316270 [info ] [Thread-9 (]: 17 of 23 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 1.63s]
[0m11:13:04.316270 [debug] [Thread-9 (]: Finished running node model.data_pipeline.fct_orders
[0m11:13:04.321006 [debug] [Thread-6 (]: Began running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m11:13:04.321006 [debug] [Thread-10 ]: Began running node test.data_pipeline.fct_orders_date_valid
[0m11:13:04.321006 [debug] [Thread-4 (]: Began running node test.data_pipeline.fct_orders_discount
[0m11:13:04.321006 [debug] [Thread-2 (]: Began running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m11:13:04.321006 [info ] [Thread-6 (]: 18 of 23 START test accepted_values_fct_orders_status_code__P__O__F ............ [RUN]
[0m11:13:04.323657 [debug] [Thread-5 (]: Began running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m11:13:04.323657 [debug] [Thread-3 (]: Began running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m11:13:04.323657 [info ] [Thread-10 ]: 19 of 23 START test fct_orders_date_valid ...................................... [RUN]
[0m11:13:04.325164 [info ] [Thread-4 (]: 20 of 23 START test fct_orders_discount ........................................ [RUN]
[0m11:13:04.326600 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly snapshot.data_pipeline.customer_snapshot_check, now test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048)
[0m11:13:04.325164 [info ] [Thread-2 (]: 21 of 23 START test not_null_fct_orders_order_key .............................. [RUN]
[0m11:13:04.326600 [info ] [Thread-5 (]: 22 of 23 START test relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m11:13:04.327952 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.data_pipeline.int_order_items, now test.data_pipeline.fct_orders_date_valid)
[0m11:13:04.327561 [info ] [Thread-3 (]: 23 of 23 START test unique_fct_orders_order_key ................................ [RUN]
[0m11:13:04.327952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b, now test.data_pipeline.fct_orders_discount)
[0m11:13:04.327952 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m11:13:04.327952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32, now test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15)
[0m11:13:04.327952 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414, now test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce)
[0m11:13:04.327952 [debug] [Thread-10 ]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m11:13:04.327952 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_pipeline.current_customers, now test.data_pipeline.unique_fct_orders_order_key.f5e7a90273)
[0m11:13:04.327952 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m11:13:04.327952 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m11:13:04.327952 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m11:13:04.327952 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m11:13:04.341074 [debug] [Thread-10 ]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m11:13:04.341074 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m11:13:04.343079 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m11:13:04.347084 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m11:13:04.350828 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m11:13:04.352830 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m11:13:04.354831 [debug] [Thread-6 (]: Began executing node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m11:13:04.354831 [debug] [Thread-10 ]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m11:13:04.354831 [debug] [Thread-4 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m11:13:04.359361 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m11:13:04.362109 [debug] [Thread-10 ]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m11:13:04.362109 [debug] [Thread-2 (]: Began executing node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m11:13:04.362109 [debug] [Thread-5 (]: Began executing node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m11:13:04.364113 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m11:13:04.366118 [debug] [Thread-3 (]: Began executing node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m11:13:04.368120 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m11:13:04.370124 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m11:13:04.372128 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m11:13:04.372841 [debug] [Thread-10 ]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m11:13:04.374831 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m11:13:04.374831 [debug] [Thread-10 ]: On test.data_pipeline.fct_orders_date_valid: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
[0m11:13:04.376176 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m11:13:04.376176 [debug] [Thread-6 (]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_orders
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"} */
[0m11:13:04.376176 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m11:13:04.376176 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m11:13:04.376176 [debug] [Thread-4 (]: On test.data_pipeline.fct_orders_discount: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    item_discount_amount > 0
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
[0m11:13:04.376176 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m11:13:04.376176 [debug] [Thread-2 (]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_key
from dbt_db.dbt_schema.fct_orders
where order_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"} */
[0m11:13:04.376176 [debug] [Thread-3 (]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_orders
where order_key is not null
group by order_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"} */
[0m11:13:04.376176 [debug] [Thread-5 (]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_orders
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"} */
[0m11:13:04.554347 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.185 seconds
[0m11:13:04.554347 [info ] [Thread-10 ]: 19 of 23 PASS fct_orders_date_valid ............................................ [[32mPASS[0m in 0.23s]
[0m11:13:04.554347 [debug] [Thread-10 ]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m11:13:04.567515 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m11:13:04.567515 [info ] [Thread-2 (]: 21 of 23 PASS not_null_fct_orders_order_key .................................... [[32mPASS[0m in 0.24s]
[0m11:13:04.567515 [debug] [Thread-2 (]: Finished running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m11:13:04.805628 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m11:13:04.805628 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m11:13:04.805628 [info ] [Thread-4 (]: 20 of 23 PASS fct_orders_discount .............................................. [[32mPASS[0m in 0.48s]
[0m11:13:04.805628 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m11:13:04.805628 [info ] [Thread-3 (]: 23 of 23 PASS unique_fct_orders_order_key ...................................... [[32mPASS[0m in 0.48s]
[0m11:13:04.805628 [debug] [Thread-4 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m11:13:04.817526 [debug] [Thread-3 (]: Finished running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m11:13:04.817526 [info ] [Thread-6 (]: 18 of 23 PASS accepted_values_fct_orders_status_code__P__O__F .................. [[32mPASS[0m in 0.48s]
[0m11:13:04.817526 [debug] [Thread-6 (]: Finished running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m11:13:05.544898 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m11:13:05.552413 [info ] [Thread-5 (]: 22 of 23 PASS relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [[32mPASS[0m in 1.22s]
[0m11:13:05.552413 [debug] [Thread-5 (]: Finished running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m11:13:05.555494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:05.555494 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:13:05.557334 [debug] [MainThread]: On list_dbt_db: Close
[0m11:13:05.880447 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:13:05.880447 [debug] [MainThread]: On list_dbt_db: Close
[0m11:13:06.070314 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m11:13:06.070314 [debug] [MainThread]: On list_dbt_db: Close
[0m11:13:06.454000 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema_snapshot_data' was left open.
[0m11:13:06.454000 [debug] [MainThread]: On list_dbt_db_dbt_schema_snapshot_data: Close
[0m11:13:06.802550 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m11:13:06.802550 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m11:13:07.145112 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m11:13:07.145112 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m11:13:07.448915 [debug] [MainThread]: Connection 'model.data_pipeline.historical_customers' was left open.
[0m11:13:07.448915 [debug] [MainThread]: On model.data_pipeline.historical_customers: Close
[0m11:13:07.689950 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15' was left open.
[0m11:13:07.689950 [debug] [MainThread]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: Close
[0m11:13:07.953653 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273' was left open.
[0m11:13:07.953653 [debug] [MainThread]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: Close
[0m11:13:08.269627 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m11:13:08.283310 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m11:13:08.598827 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' was left open.
[0m11:13:08.598827 [debug] [MainThread]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: Close
[0m11:13:08.927379 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048' was left open.
[0m11:13:08.927379 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: Close
[0m11:13:09.256758 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m11:13:09.256758 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m11:13:09.589247 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m11:13:09.589247 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m11:13:09.830697 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m11:13:09.830697 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m11:13:10.006849 [info ] [MainThread]: 
[0m11:13:10.006849 [info ] [MainThread]: Finished running 1 seed, 2 snapshots, 6 table models, 12 data tests, 2 view models in 0 hours 0 minutes and 18.87 seconds (18.87s).
[0m11:13:10.024159 [debug] [MainThread]: Command end result
[0m11:13:10.042960 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m11:13:10.042960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m11:13:10.057487 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m11:13:10.057487 [info ] [MainThread]: 
[0m11:13:10.058497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:10.059005 [info ] [MainThread]: 
[0m11:13:10.059005 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m11:13:10.060217 [debug] [MainThread]: Command `dbt build` succeeded at 11:13:10.060217 after 20.57 seconds
[0m11:13:10.060217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002167466D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216714D7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021673B4E000>]}
[0m11:13:10.060217 [debug] [MainThread]: Flushing usage events
[0m11:13:12.620546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:48.319728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FA3D34D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FCC8FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FD24DD60>]}


============================== 12:24:48.331810 | 615a8a65-1330-40f8-87bf-e3caa7965817 ==============================
[0m12:24:48.331810 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:24:48.331810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:24:49.072804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FCF4A780>]}
[0m12:24:49.127725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FF7714F0>]}
[0m12:24:49.127725 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m12:24:49.519790 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m12:24:49.855242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:49.855242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:49.924761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FF86B3B0>]}
[0m12:24:50.035281 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m12:24:50.038280 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m12:24:50.086278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FF8BE9F0>]}
[0m12:24:50.087278 [info ] [MainThread]: Found 8 models, 2 snapshots, 12 data tests, 1 seed, 3 sources, 594 macros
[0m12:24:50.090284 [info ] [MainThread]: 
[0m12:24:50.091287 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:24:50.091287 [info ] [MainThread]: 
[0m12:24:50.092430 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:50.097501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m12:24:50.111845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m12:24:50.114847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m12:24:50.208074 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m12:24:50.208074 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m12:24:50.209079 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m12:24:50.209079 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m12:24:50.210078 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m12:24:50.210078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:50.211078 [debug] [ThreadPool]: On list_dbt_db: show terse schemas in database dbt_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
[0m12:24:50.211078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:50.212077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:52.370129 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.160 seconds
[0m12:24:52.398138 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.187 seconds
[0m12:24:52.619858 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.408 seconds
[0m12:24:52.623883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m12:24:52.632883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_snapshots'
[0m12:24:52.638336 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m12:24:52.640597 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_snapshots"
[0m12:24:52.641338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema_snapshot_data'
[0m12:24:52.641827 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: show objects in dbt_db.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */;
[0m12:24:52.641827 [debug] [ThreadPool]: On list_dbt_db_snapshots: show objects in dbt_db.snapshots
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_snapshots"} */;
[0m12:24:52.643420 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema_snapshot_data"
[0m12:24:52.643420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:52.644417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:52.644417 [debug] [ThreadPool]: On list_dbt_db_dbt_schema_snapshot_data: show objects in dbt_db.dbt_schema_snapshot_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema_snapshot_data"} */;
[0m12:24:52.645638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:53.358156 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.714 seconds
[0m12:24:53.464069 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.818 seconds
[0m12:24:53.857861 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.215 seconds
[0m12:24:53.862081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FF8B7D10>]}
[0m12:24:53.869926 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m12:24:53.869926 [debug] [Thread-2 (]: Began running node seed.data_pipeline.customers
[0m12:24:53.870930 [debug] [Thread-3 (]: Began running node snapshot.data_pipeline.customer_snapshot
[0m12:24:53.870930 [debug] [Thread-4 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m12:24:53.870930 [info ] [Thread-1 (]: 1 of 23 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m12:24:53.871949 [debug] [Thread-5 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m12:24:53.871949 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m12:24:53.871949 [info ] [Thread-2 (]: 2 of 23 START seed file dbt_schema.customers ................................... [RUN]
[0m12:24:53.873380 [info ] [Thread-3 (]: 3 of 23 START snapshot snapshots.customer_snapshot ............................. [RUN]
[0m12:24:53.874383 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m12:24:53.873380 [info ] [Thread-4 (]: 4 of 23 START test source_not_null_tpch_orders_o_orderkey ...................... [RUN]
[0m12:24:53.874383 [info ] [Thread-5 (]: 5 of 23 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m12:24:53.875380 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.data_pipeline.customers'
[0m12:24:53.876384 [debug] [Thread-3 (]: Acquiring new snowflake connection 'snapshot.data_pipeline.customer_snapshot'
[0m12:24:53.875380 [info ] [Thread-6 (]: 6 of 23 START test source_unique_tpch_orders_o_orderkey ........................ [RUN]
[0m12:24:53.876384 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m12:24:53.877384 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m12:24:53.877384 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m12:24:53.878384 [debug] [Thread-2 (]: Began compiling node seed.data_pipeline.customers
[0m12:24:53.878384 [debug] [Thread-3 (]: Began compiling node snapshot.data_pipeline.customer_snapshot
[0m12:24:53.878384 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m12:24:53.894668 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m12:24:53.894668 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m12:24:53.895667 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m12:24:53.895667 [debug] [Thread-2 (]: Began executing node seed.data_pipeline.customers
[0m12:24:53.898664 [debug] [Thread-3 (]: Began executing node snapshot.data_pipeline.customer_snapshot
[0m12:24:53.899662 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m12:24:53.908662 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m12:24:53.918868 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m12:24:53.968631 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m12:24:53.999661 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:54.000659 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m12:24:54.015670 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m12:24:54.016680 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:54.044517 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m12:24:54.045519 [debug] [Thread-2 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m12:24:54.045519 [debug] [Thread-5 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m12:24:54.046518 [debug] [Thread-4 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m12:24:54.046518 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m12:24:54.047520 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:24:54.048522 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:24:54.068820 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m12:24:54.072820 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m12:24:54.074815 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m12:24:54.075817 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m12:24:54.081821 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
  
  
  
  as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */;
[0m12:24:54.081821 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:54.083166 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m12:24:54.085647 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m12:24:54.085647 [debug] [Thread-4 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
[0m12:24:54.087750 [debug] [Thread-5 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
[0m12:24:54.088752 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m12:24:54.089750 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:24:54.089750 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:24:54.090751 [debug] [Thread-6 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
[0m12:24:54.093757 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:24:54.862292 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.815 seconds
[0m12:24:54.863291 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m12:24:54.864291 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m12:24:54.915042 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:54.902453 [info ] [Thread-4 (]: 4 of 23 PASS source_not_null_tpch_orders_o_orderkey ............................ [[32mPASS[0m in 1.03s]
[0m12:24:54.917341 [info ] [Thread-6 (]: 6 of 23 PASS source_unique_tpch_orders_o_orderkey .............................. [[32mPASS[0m in 1.04s]
[0m12:24:54.918342 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m12:24:54.918342 [debug] [Thread-4 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m12:24:54.918342 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m12:24:54.921127 [debug] [Thread-8 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m12:24:54.921127 [info ] [Thread-8 (]: 7 of 23 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m12:24:54.922389 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m12:24:54.923391 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m12:24:54.925757 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m12:24:54.926760 [debug] [Thread-8 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m12:24:54.930935 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m12:24:54.932936 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m12:24:54.932936 [debug] [Thread-8 (]: On model.data_pipeline.stg_tpch_orders: create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
  
  
  
  as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */;
[0m12:24:54.932936 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m12:24:55.024359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.942 seconds
[0m12:24:55.025360 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.936 seconds
[0m12:24:55.044577 [info ] [Thread-5 (]: 5 of 23 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 1.17s]
[0m12:24:55.046860 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.998 seconds
[0m12:24:55.046860 [debug] [Thread-5 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m12:24:55.047863 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m12:24:55.048862 [debug] [Thread-2 (]: On seed.data_pipeline.customers: truncate table "DBT_DB"."DBT_SCHEMA"."CUSTOMERS"
  
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */;
[0m12:24:55.049860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418145FB00>]}
[0m12:24:55.050859 [info ] [Thread-1 (]: 1 of 23 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 1.17s]
[0m12:24:55.051860 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m12:24:55.434591 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m12:24:55.435993 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m12:24:55.435993 [debug] [Thread-2 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m12:24:55.688525 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m12:24:55.701750 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m12:24:55.701750 [debug] [Thread-2 (]: On seed.data_pipeline.customers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m12:24:55.933760 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m12:24:55.935091 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m12:24:55.935091 [debug] [Thread-2 (]: On seed.data_pipeline.customers: insert into dbt_db.dbt_schema.customers (customer_id, customer_name, customer_status, updated_at) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */...
[0m12:24:55.938328 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.005 seconds
[0m12:24:55.940087 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F99918E0>]}
[0m12:24:55.940087 [info ] [Thread-8 (]: 7 of 23 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 1.02s]
[0m12:24:55.942072 [debug] [Thread-8 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m12:24:55.942072 [debug] [Thread-10 ]: Began running node model.data_pipeline.int_order_items
[0m12:24:55.943321 [info ] [Thread-10 ]: 8 of 23 START sql table model dbt_schema.int_order_items ....................... [RUN]
[0m12:24:55.943321 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m12:24:55.944756 [debug] [Thread-10 ]: Began compiling node model.data_pipeline.int_order_items
[0m12:24:55.946203 [debug] [Thread-10 ]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m12:24:55.946203 [debug] [Thread-10 ]: Began executing node model.data_pipeline.int_order_items
[0m12:24:55.962140 [debug] [Thread-10 ]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m12:24:55.963139 [debug] [Thread-10 ]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m12:24:55.963139 [debug] [Thread-10 ]: On model.data_pipeline.int_order_items: create or replace transient table dbt_db.dbt_schema.int_order_items
    
    
    
    as (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */;
[0m12:24:55.963139 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m12:24:56.344676 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.425 seconds
[0m12:24:56.344676 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:56.344676 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:56.594651 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.246 seconds
[0m12:24:56.598059 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:56.599070 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:56.612754 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.677 seconds
[0m12:24:56.612754 [debug] [Thread-2 (]: Using snowflake connection "seed.data_pipeline.customers"
[0m12:24:56.613752 [debug] [Thread-2 (]: On seed.data_pipeline.customers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "seed.data_pipeline.customers"} */
[0m12:24:56.843668 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.244 seconds
[0m12:24:56.847728 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:56.847728 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:56.851254 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m12:24:56.857279 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.data_pipeline.customers"
[0m12:24:56.861805 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241815160F0>]}
[0m12:24:56.861805 [info ] [Thread-2 (]: 2 of 23 OK loaded seed file dbt_schema.customers ............................... [[32mINSERT 4[0m in 2.99s]
[0m12:24:56.861805 [debug] [Thread-2 (]: Finished running node seed.data_pipeline.customers
[0m12:24:56.861805 [debug] [Thread-4 (]: Began running node snapshot.data_pipeline.customer_snapshot_check
[0m12:24:56.865170 [info ] [Thread-4 (]: 9 of 23 START snapshot snapshots.customer_snapshot_check ....................... [RUN]
[0m12:24:56.865170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b, now snapshot.data_pipeline.customer_snapshot_check)
[0m12:24:56.865170 [debug] [Thread-4 (]: Began compiling node snapshot.data_pipeline.customer_snapshot_check
[0m12:24:56.869896 [debug] [Thread-4 (]: Began executing node snapshot.data_pipeline.customer_snapshot_check
[0m12:24:56.895326 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:24:56.895326 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select customer_name, customer_status from (
                
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:24:56.995834 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.154 seconds
[0m12:24:57.004150 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:57.004150 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:57.110532 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.102 seconds
[0m12:24:57.116094 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:57.116094 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:57.332281 [debug] [Thread-3 (]: SQL status: SUCCESS 10 in 0.213 seconds
[0m12:24:57.346019 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:57.346019 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    customer_id,
    customer_name,
    customer_status,
    updated_at
FROM dbt_db.dbt_schema.customers  -- must match YAML source name


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:57.578154 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.229 seconds
[0m12:24:57.582069 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:57.582069 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:57.582069 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.682 seconds
[0m12:24:57.582069 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:24:57.582069 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:24:57.825916 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.242 seconds
[0m12:24:57.826915 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.238 seconds
[0m12:24:57.829356 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot"
[0m12:24:57.832359 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:24:57.832359 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:24:57.834411 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:57.834411 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:58.154945 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.322 seconds
[0m12:24:58.155954 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m12:24:58.161210 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:24:58.161210 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:58.162210 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: create or replace temporary table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
as (
    
    
    with snapshot_query as (

        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m12:24:58.163210 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */;
[0m12:24:58.813827 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.650 seconds
[0m12:24:58.813827 [debug] [Thread-3 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot"
[0m12:24:58.813827 [debug] [Thread-3 (]: On snapshot.data_pipeline.customer_snapshot: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot"} */
[0m12:24:59.065056 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.902 seconds
[0m12:24:59.066055 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m12:24:59.069056 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:24:59.073052 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FFEAC1A0>]}
[0m12:24:59.073052 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:24:59.074064 [info ] [Thread-3 (]: 3 of 23 OK snapshotted snapshots.customer_snapshot ............................. [[32mSUCCESS 0[0m in 5.20s]
[0m12:24:59.075054 [debug] [Thread-3 (]: Finished running node snapshot.data_pipeline.customer_snapshot
[0m12:24:59.076464 [debug] [Thread-9 (]: Began running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m12:24:59.077467 [debug] [Thread-5 (]: Began running node test.data_pipeline.unique_current_customer
[0m12:24:59.077467 [info ] [Thread-9 (]: 10 of 23 START test not_null_customer_snapshot_customer_id ..................... [RUN]
[0m12:24:59.078463 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414'
[0m12:24:59.078463 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m12:24:59.083466 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m12:24:59.077467 [info ] [Thread-5 (]: 11 of 23 START test unique_current_customer .................................... [RUN]
[0m12:24:59.084689 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d, now test.data_pipeline.unique_current_customer)
[0m12:24:59.084689 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.unique_current_customer
[0m12:24:59.086688 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.unique_current_customer"
[0m12:24:59.087687 [debug] [Thread-9 (]: Began executing node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m12:24:59.089908 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m12:24:59.089908 [debug] [Thread-5 (]: Began executing node test.data_pipeline.unique_current_customer
[0m12:24:59.092406 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.unique_current_customer"
[0m12:24:59.093406 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"
[0m12:24:59.093406 [debug] [Thread-9 (]: On test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dbt_db.snapshots.customer_snapshot
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414"} */
[0m12:24:59.093406 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m12:24:59.094405 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.unique_current_customer"
[0m12:24:59.095406 [debug] [Thread-5 (]: On test.data_pipeline.unique_current_customer: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Ensure there is only one current record per customer in the snapshot

SELECT 
    customer_id
FROM dbt_db.snapshots.customer_snapshot
WHERE dbt_valid_to IS NULL
GROUP BY customer_id
HAVING COUNT(*) > 1
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_current_customer"} */
[0m12:24:59.319869 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.245 seconds
[0m12:24:59.323864 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:24:59.323864 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:24:59.477108 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.153 seconds
[0m12:24:59.481292 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:24:59.481292 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:24:59.577636 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m12:24:59.579717 [info ] [Thread-5 (]: 11 of 23 PASS unique_current_customer .......................................... [[32mPASS[0m in 0.50s]
[0m12:24:59.580280 [debug] [Thread-5 (]: Finished running node test.data_pipeline.unique_current_customer
[0m12:24:59.890935 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.409 seconds
[0m12:24:59.896209 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:24:59.897208 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:25:00.007469 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.110 seconds
[0m12:25:00.011605 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:25:00.012605 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: describe table "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:25:00.027817 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.935 seconds
[0m12:25:00.030203 [info ] [Thread-9 (]: 10 of 23 PASS not_null_customer_snapshot_customer_id ........................... [[32mPASS[0m in 0.95s]
[0m12:25:00.031203 [debug] [Thread-9 (]: Finished running node test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414
[0m12:25:00.031203 [debug] [Thread-8 (]: Began running node model.data_pipeline.customer_activity
[0m12:25:00.032204 [info ] [Thread-8 (]: 12 of 23 START sql table model dbt_schema_snapshot_data.customer_activity ...... [RUN]
[0m12:25:00.032204 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.data_pipeline.stg_tpch_orders, now model.data_pipeline.customer_activity)
[0m12:25:00.033203 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.customer_activity
[0m12:25:00.036204 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.customer_activity"
[0m12:25:00.036204 [debug] [Thread-8 (]: Began executing node model.data_pipeline.customer_activity
[0m12:25:00.126561 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.customer_activity"
[0m12:25:00.128561 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.customer_activity"
[0m12:25:00.128561 [debug] [Thread-8 (]: On model.data_pipeline.customer_activity: create or replace transient table dbt_db.dbt_schema_snapshot_data.customer_activity
    
    
    
    as (-- This model demonstrates how to use snapshot data for current and historical insights

WITH snapshot_data AS (
    SELECT 
        customer_id,
        customer_name,
        customer_status,
        dbt_valid_from,
        dbt_valid_to,
        CASE 
            WHEN dbt_valid_to IS NULL THEN 'current'
            ELSE 'historical'
        END AS record_status
    FROM dbt_db.snapshots.customer_snapshot
)

SELECT 
    customer_id,
    customer_name,
    customer_status,
    record_status,
    dbt_valid_from,
    dbt_valid_to
FROM snapshot_data
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.customer_activity"} */;
[0m12:25:00.140149 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.127 seconds
[0m12:25:00.144489 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:25:00.144489 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        
    
    with snapshot_query as (

        
  

  SELECT
      customer_id,
      customer_name,
      customer_status
  FROM dbt_db.dbt_schema.customers


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CUSTOMER_NAME" != source_data."CUSTOMER_NAME"
        or
        (
            ((snapshotted_data."CUSTOMER_NAME" is null) and not (source_data."CUSTOMER_NAME" is null))
            or
            ((not snapshotted_data."CUSTOMER_NAME" is null) and (source_data."CUSTOMER_NAME" is null))
        ) or snapshotted_data."CUSTOMER_STATUS" != source_data."CUSTOMER_STATUS"
        or
        (
            ((snapshotted_data."CUSTOMER_STATUS" is null) and not (source_data."CUSTOMER_STATUS" is null))
            or
            ((not snapshotted_data."CUSTOMER_STATUS" is null) and (source_data."CUSTOMER_STATUS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:25:00.948839 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.804 seconds
[0m12:25:00.949839 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m12:25:00.951839 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:25:00.953839 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418175BDD0>]}
[0m12:25:00.953839 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:25:00.954839 [info ] [Thread-8 (]: 12 of 23 OK created sql table model dbt_schema_snapshot_data.customer_activity . [[32mSUCCESS 1[0m in 0.92s]
[0m12:25:00.956839 [debug] [Thread-8 (]: Finished running node model.data_pipeline.customer_activity
[0m12:25:01.212527 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.257 seconds
[0m12:25:01.214003 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.data_pipeline.customer_snapshot_check"
[0m12:25:01.215011 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:25:01.216011 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:25:01.355525 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 5.390 seconds
[0m12:25:01.358708 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024181734A40>]}
[0m12:25:01.359741 [info ] [Thread-10 ]: 8 of 23 OK created sql table model dbt_schema.int_order_items .................. [[32mSUCCESS 1[0m in 5.42s]
[0m12:25:01.360757 [debug] [Thread-10 ]: Finished running node model.data_pipeline.int_order_items
[0m12:25:01.360757 [debug] [Thread-2 (]: Began running node model.data_pipeline.int_order_items_summary
[0m12:25:01.361765 [info ] [Thread-2 (]: 13 of 23 START sql table model dbt_schema.int_order_items_summary .............. [RUN]
[0m12:25:01.361765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.data_pipeline.customers, now model.data_pipeline.int_order_items_summary)
[0m12:25:01.362765 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m12:25:01.365765 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m12:25:01.366769 [debug] [Thread-2 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m12:25:01.368769 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m12:25:01.370769 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m12:25:01.370769 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:25:01.371779 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: merge into "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK" as DBT_INTERNAL_DEST
    using "DBT_DB"."SNAPSHOTS"."CUSTOMER_SNAPSHOT_CHECK__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_NAME", "CUSTOMER_STATUS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */;
[0m12:25:01.373123 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m12:25:01.373123 [debug] [Thread-2 (]: On model.data_pipeline.int_order_items_summary: create or replace transient table dbt_db.dbt_schema.int_order_items_summary
    
    
    
    as (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.int_order_items
group by
    order_key
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */;
[0m12:25:01.920901 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.549 seconds
[0m12:25:01.920901 [debug] [Thread-4 (]: Using snowflake connection "snapshot.data_pipeline.customer_snapshot_check"
[0m12:25:01.920901 [debug] [Thread-4 (]: On snapshot.data_pipeline.customer_snapshot_check: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "snapshot.data_pipeline.customer_snapshot_check"} */
[0m12:25:02.222336 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m12:25:02.222336 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m12:25:02.235312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241815598E0>]}
[0m12:25:02.238193 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024181583D40>]}
[0m12:25:02.238193 [info ] [Thread-2 (]: 13 of 23 OK created sql table model dbt_schema.int_order_items_summary ......... [[32mSUCCESS 1[0m in 0.87s]
[0m12:25:02.240823 [debug] [Thread-2 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m12:25:02.240823 [info ] [Thread-4 (]: 9 of 23 OK snapshotted snapshots.customer_snapshot_check ....................... [[32mSUCCESS 0[0m in 5.37s]
[0m12:25:02.240823 [debug] [Thread-4 (]: Finished running node snapshot.data_pipeline.customer_snapshot_check
[0m12:25:02.240823 [debug] [Thread-3 (]: Began running node model.data_pipeline.fct_orders
[0m12:25:02.240823 [debug] [Thread-5 (]: Began running node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m12:25:02.240823 [info ] [Thread-3 (]: 14 of 23 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m12:25:02.240823 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.data_pipeline.customer_snapshot, now model.data_pipeline.fct_orders)
[0m12:25:02.240823 [info ] [Thread-5 (]: 15 of 23 START test not_null_customer_snapshot_check_customer_id ............... [RUN]
[0m12:25:02.240823 [debug] [Thread-3 (]: Began compiling node model.data_pipeline.fct_orders
[0m12:25:02.240823 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.data_pipeline.unique_current_customer, now test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32)
[0m12:25:02.240823 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_pipeline.fct_orders"
[0m12:25:02.240823 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m12:25:02.240823 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m12:25:02.240823 [debug] [Thread-3 (]: Began executing node model.data_pipeline.fct_orders
[0m12:25:02.256232 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_pipeline.fct_orders"
[0m12:25:02.256232 [debug] [Thread-5 (]: Began executing node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m12:25:02.259328 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m12:25:02.259328 [debug] [Thread-3 (]: Using snowflake connection "model.data_pipeline.fct_orders"
[0m12:25:02.259328 [debug] [Thread-3 (]: On model.data_pipeline.fct_orders: create or replace transient table dbt_db.dbt_schema.fct_orders
    
    
    
    as (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_orders"} */;
[0m12:25:02.261136 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"
[0m12:25:02.261136 [debug] [Thread-5 (]: On test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dbt_db.snapshots.customer_snapshot_check
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32"} */
[0m12:25:02.582423 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m12:25:02.584836 [info ] [Thread-5 (]: 15 of 23 PASS not_null_customer_snapshot_check_customer_id ..................... [[32mPASS[0m in 0.34s]
[0m12:25:02.586342 [debug] [Thread-5 (]: Finished running node test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32
[0m12:25:02.586342 [debug] [Thread-7 (]: Began running node model.data_pipeline.current_customers
[0m12:25:02.586342 [debug] [Thread-8 (]: Began running node model.data_pipeline.historical_customers
[0m12:25:02.588348 [info ] [Thread-7 (]: 16 of 23 START sql table model dbt_schema_snapshot_data.current_customers ...... [RUN]
[0m12:25:02.588348 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.data_pipeline.current_customers'
[0m12:25:02.588348 [info ] [Thread-8 (]: 17 of 23 START sql table model dbt_schema_snapshot_data.historical_customers ... [RUN]
[0m12:25:02.588348 [debug] [Thread-7 (]: Began compiling node model.data_pipeline.current_customers
[0m12:25:02.588348 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.data_pipeline.customer_activity, now model.data_pipeline.historical_customers)
[0m12:25:02.593859 [debug] [Thread-7 (]: Writing injected SQL for node "model.data_pipeline.current_customers"
[0m12:25:02.593859 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.historical_customers
[0m12:25:02.595862 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.historical_customers"
[0m12:25:02.595862 [debug] [Thread-7 (]: Began executing node model.data_pipeline.current_customers
[0m12:25:02.599870 [debug] [Thread-7 (]: Writing runtime sql for node "model.data_pipeline.current_customers"
[0m12:25:02.599870 [debug] [Thread-8 (]: Began executing node model.data_pipeline.historical_customers
[0m12:25:02.601874 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.historical_customers"
[0m12:25:02.603880 [debug] [Thread-7 (]: Using snowflake connection "model.data_pipeline.current_customers"
[0m12:25:02.603880 [debug] [Thread-7 (]: On model.data_pipeline.current_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.current_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NULL
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.current_customers"} */;
[0m12:25:02.605291 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.historical_customers"
[0m12:25:02.605662 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m12:25:02.605662 [debug] [Thread-8 (]: On model.data_pipeline.historical_customers: create or replace transient table dbt_db.dbt_schema_snapshot_data.historical_customers
    
    
    
    as (SELECT 
    customer_id,
    customer_name,
    customer_status,
    dbt_valid_from,
    dbt_valid_to
FROM dbt_db.snapshots.customer_snapshot_check
WHERE dbt_valid_to IS NOT NULL
ORDER BY customer_id, dbt_valid_from
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.historical_customers"} */;
[0m12:25:03.551588 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m12:25:03.551588 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024181737E30>]}
[0m12:25:03.551588 [info ] [Thread-8 (]: 17 of 23 OK created sql table model dbt_schema_snapshot_data.historical_customers  [[32mSUCCESS 1[0m in 0.96s]
[0m12:25:03.551588 [debug] [Thread-8 (]: Finished running node model.data_pipeline.historical_customers
[0m12:25:03.624092 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.372 seconds
[0m12:25:03.624092 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FFEA5490>]}
[0m12:25:03.624092 [info ] [Thread-3 (]: 14 of 23 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 1.38s]
[0m12:25:03.624092 [debug] [Thread-3 (]: Finished running node model.data_pipeline.fct_orders
[0m12:25:03.624092 [debug] [Thread-6 (]: Began running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m12:25:03.638135 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m12:25:03.638135 [debug] [Thread-4 (]: Began running node test.data_pipeline.fct_orders_discount
[0m12:25:03.638135 [info ] [Thread-6 (]: 18 of 23 START test accepted_values_fct_orders_status_code__P__O__F ............ [RUN]
[0m12:25:03.639663 [debug] [Thread-1 (]: Began running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m12:25:03.640219 [debug] [Thread-9 (]: Began running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m12:25:03.640219 [info ] [Thread-2 (]: 19 of 23 START test fct_orders_date_valid ...................................... [RUN]
[0m12:25:03.641234 [debug] [Thread-5 (]: Began running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m12:25:03.641234 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2, now test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048)
[0m12:25:03.641234 [info ] [Thread-4 (]: 20 of 23 START test fct_orders_discount ........................................ [RUN]
[0m12:25:03.643235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_pipeline.int_order_items_summary, now test.data_pipeline.fct_orders_date_valid)
[0m12:25:03.642240 [info ] [Thread-1 (]: 21 of 23 START test not_null_fct_orders_order_key .............................. [RUN]
[0m12:25:03.642240 [info ] [Thread-9 (]: 22 of 23 START test relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m12:25:03.644234 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m12:25:03.643235 [info ] [Thread-5 (]: 23 of 23 START test unique_fct_orders_order_key ................................ [RUN]
[0m12:25:03.644234 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.data_pipeline.customer_snapshot_check, now test.data_pipeline.fct_orders_discount)
[0m12:25:03.645348 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m12:25:03.645348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_pipeline.stg_tpch_line_items, now test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15)
[0m12:25:03.646337 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly test.data_pipeline.not_null_customer_snapshot_customer_id.0e40d02414, now test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce)
[0m12:25:03.646337 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m12:25:03.646337 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.data_pipeline.not_null_customer_snapshot_check_customer_id.14c11eab32, now test.data_pipeline.unique_fct_orders_order_key.f5e7a90273)
[0m12:25:03.646337 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m12:25:03.657770 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m12:25:03.657770 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m12:25:03.657770 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m12:25:03.659089 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m12:25:03.661602 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m12:25:03.663312 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m12:25:03.663312 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m12:25:03.672841 [debug] [Thread-6 (]: Began executing node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m12:25:03.673563 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m12:25:03.674590 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m12:25:03.675074 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m12:25:03.675074 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m12:25:03.675074 [debug] [Thread-1 (]: Began executing node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m12:25:03.675074 [debug] [Thread-9 (]: Began executing node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m12:25:03.682337 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m12:25:03.675074 [debug] [Thread-4 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m12:25:03.684239 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m12:25:03.684239 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"
[0m12:25:03.686361 [debug] [Thread-5 (]: Began executing node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m12:25:03.687978 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m12:25:03.687978 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m12:25:03.687978 [debug] [Thread-6 (]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_orders
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048"} */
[0m12:25:03.691003 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m12:25:03.691003 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"
[0m12:25:03.692542 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_date_valid: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
[0m12:25:03.692542 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"
[0m12:25:03.694773 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m12:25:03.694773 [debug] [Thread-1 (]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_key
from dbt_db.dbt_schema.fct_orders
where order_key is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15"} */
[0m12:25:03.695787 [debug] [Thread-9 (]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_orders
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce"} */
[0m12:25:03.696791 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"
[0m12:25:03.696791 [debug] [Thread-4 (]: On test.data_pipeline.fct_orders_discount: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    *
from
    dbt_db.dbt_schema.fct_orders
where
    item_discount_amount > 0
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
[0m12:25:03.696791 [debug] [Thread-5 (]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_orders
where order_key is not null
group by order_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_orders_order_key.f5e7a90273"} */
[0m12:25:04.048378 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m12:25:04.049391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m12:25:04.049391 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m12:25:04.053606 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m12:25:04.051575 [info ] [Thread-2 (]: 19 of 23 PASS fct_orders_date_valid ............................................ [[32mPASS[0m in 0.41s]
[0m12:25:04.053606 [info ] [Thread-1 (]: 21 of 23 PASS not_null_fct_orders_order_key .................................... [[32mPASS[0m in 0.41s]
[0m12:25:04.057021 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m12:25:04.055723 [info ] [Thread-4 (]: 20 of 23 PASS fct_orders_discount .............................................. [[32mPASS[0m in 0.41s]
[0m12:25:04.058030 [debug] [Thread-1 (]: Finished running node test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15
[0m12:25:04.057021 [info ] [Thread-6 (]: 18 of 23 PASS accepted_values_fct_orders_status_code__P__O__F .................. [[32mPASS[0m in 0.42s]
[0m12:25:04.059056 [debug] [Thread-4 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m12:25:04.059056 [debug] [Thread-6 (]: Finished running node test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048
[0m12:25:04.127124 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m12:25:04.129122 [info ] [Thread-5 (]: 23 of 23 PASS unique_fct_orders_order_key ...................................... [[32mPASS[0m in 0.48s]
[0m12:25:04.131335 [debug] [Thread-5 (]: Finished running node test.data_pipeline.unique_fct_orders_order_key.f5e7a90273
[0m12:25:04.131335 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.527 seconds
[0m12:25:04.133781 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '615a8a65-1330-40f8-87bf-e3caa7965817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FFE96510>]}
[0m12:25:04.133781 [info ] [Thread-7 (]: 16 of 23 OK created sql table model dbt_schema_snapshot_data.current_customers . [[32mSUCCESS 1[0m in 1.55s]
[0m12:25:04.134781 [debug] [Thread-7 (]: Finished running node model.data_pipeline.current_customers
[0m12:25:04.918725 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 1.221 seconds
[0m12:25:04.921041 [info ] [Thread-9 (]: 22 of 23 PASS relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_  [[32mPASS[0m in 1.27s]
[0m12:25:04.922041 [debug] [Thread-9 (]: Finished running node test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce
[0m12:25:04.924042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:04.924042 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m12:25:04.925041 [debug] [MainThread]: On list_dbt_db: Close
[0m12:25:05.197324 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m12:25:05.198324 [debug] [MainThread]: On list_dbt_db: Close
[0m12:25:05.454477 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m12:25:05.454477 [debug] [MainThread]: On list_dbt_db: Close
[0m12:25:05.735814 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m12:25:05.736833 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m12:25:06.103671 [debug] [MainThread]: Connection 'list_dbt_db_snapshots' was left open.
[0m12:25:06.103671 [debug] [MainThread]: On list_dbt_db_snapshots: Close
[0m12:25:06.597109 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema_snapshot_data' was left open.
[0m12:25:06.597109 [debug] [MainThread]: On list_dbt_db_dbt_schema_snapshot_data: Close
[0m12:25:06.842621 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15' was left open.
[0m12:25:06.843578 [debug] [MainThread]: On test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15: Close
[0m12:25:07.092129 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m12:25:07.092129 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m12:25:07.501349 [debug] [MainThread]: Connection 'model.data_pipeline.fct_orders' was left open.
[0m12:25:07.502780 [debug] [MainThread]: On model.data_pipeline.fct_orders: Close
[0m12:25:07.831297 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m12:25:07.832296 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m12:25:08.085179 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273' was left open.
[0m12:25:08.086181 [debug] [MainThread]: On test.data_pipeline.unique_fct_orders_order_key.f5e7a90273: Close
[0m12:25:08.335023 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048' was left open.
[0m12:25:08.335023 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048: Close
[0m12:25:08.903254 [debug] [MainThread]: Connection 'model.data_pipeline.historical_customers' was left open.
[0m12:25:08.904254 [debug] [MainThread]: On model.data_pipeline.historical_customers: Close
[0m12:25:09.160419 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m12:25:09.160419 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m12:25:09.483926 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' was left open.
[0m12:25:09.484960 [debug] [MainThread]: On test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce: Close
[0m12:25:10.145159 [debug] [MainThread]: Connection 'model.data_pipeline.current_customers' was left open.
[0m12:25:10.146167 [debug] [MainThread]: On model.data_pipeline.current_customers: Close
[0m12:25:10.468971 [info ] [MainThread]: 
[0m12:25:10.469971 [info ] [MainThread]: Finished running 1 seed, 2 snapshots, 6 table models, 12 data tests, 2 view models in 0 hours 0 minutes and 20.38 seconds (20.38s).
[0m12:25:10.474935 [debug] [MainThread]: Command end result
[0m12:25:10.506806 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\data_pipeline\target\manifest.json
[0m12:25:10.508806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\data_pipeline\target\semantic_manifest.json
[0m12:25:10.514809 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\data_pipeline\target\run_results.json
[0m12:25:10.514809 [info ] [MainThread]: 
[0m12:25:10.515810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:10.515810 [info ] [MainThread]: 
[0m12:25:10.516809 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m12:25:10.517811 [debug] [MainThread]: Command `dbt build` succeeded at 12:25:10.517811 after 22.39 seconds
[0m12:25:10.517811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FC4631A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FC463C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FFCA2DE0>]}
[0m12:25:10.518812 [debug] [MainThread]: Flushing usage events
[0m12:25:12.609576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:17.209808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5F77A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE61834C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5E5EA450>]}


============================== 09:46:17.214788 | 03e86039-00f5-4d67-91cf-48e82906b4bb ==============================
[0m09:46:17.214788 [info ] [MainThread]: Running with dbt=1.10.5
[0m09:46:17.222242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\data_pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:46:17.277268 [info ] [MainThread]: dbt version: 1.10.5
[0m09:46:17.277268 [info ] [MainThread]: python version: 3.12.6
[0m09:46:17.277268 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m09:46:17.277268 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m09:46:18.591093 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m09:46:18.591093 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m09:46:18.591093 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\data_pipeline\dbt_project.yml
[0m09:46:18.603138 [info ] [MainThread]: adapter type: snowflake
[0m09:46:18.605147 [info ] [MainThread]: adapter version: 1.10.0
[0m09:46:18.766541 [info ] [MainThread]: Configuration:
[0m09:46:18.768293 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:46:18.768293 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:46:18.768293 [info ] [MainThread]: Required dependencies:
[0m09:46:18.768293 [debug] [MainThread]: Executing "git --help"
[0m09:46:18.821873 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:46:18.821873 [debug] [MainThread]: STDERR: "b''"
[0m09:46:18.823387 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:46:18.823387 [info ] [MainThread]: Connection:
[0m09:46:18.823387 [info ] [MainThread]:   account: YFCCUOK-SC28960
[0m09:46:18.825664 [info ] [MainThread]:   user: Pranjal007
[0m09:46:18.825664 [info ] [MainThread]:   database: dbt_db
[0m09:46:18.825664 [info ] [MainThread]:   warehouse: dbt_wh
[0m09:46:18.825664 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m09:46:18.825664 [info ] [MainThread]:   schema: dbt_schema
[0m09:46:18.825664 [info ] [MainThread]:   authenticator: None
[0m09:46:18.825664 [info ] [MainThread]:   oauth_client_id: None
[0m09:46:18.825664 [info ] [MainThread]:   query_tag: None
[0m09:46:18.831431 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:46:18.831431 [info ] [MainThread]:   host: None
[0m09:46:18.831431 [info ] [MainThread]:   port: None
[0m09:46:18.834238 [info ] [MainThread]:   proxy_host: None
[0m09:46:18.834238 [info ] [MainThread]:   proxy_port: None
[0m09:46:18.834238 [info ] [MainThread]:   protocol: None
[0m09:46:18.836246 [info ] [MainThread]:   connect_retries: 1
[0m09:46:18.836246 [info ] [MainThread]:   connect_timeout: None
[0m09:46:18.838257 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:46:18.838257 [info ] [MainThread]:   retry_all: False
[0m09:46:18.839764 [info ] [MainThread]:   insecure_mode: False
[0m09:46:18.839764 [info ] [MainThread]:   reuse_connections: True
[0m09:46:18.839764 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m09:46:18.842238 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:46:19.488041 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:46:23.197178 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:46:23.197178 [debug] [MainThread]: On debug: select 1 as id
[0m09:46:23.198176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:25.447887 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.250 seconds
[0m09:46:25.449893 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:46:25.449893 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:46:25.452222 [debug] [MainThread]: Command `dbt debug` succeeded at 09:46:25.452222 after 8.55 seconds
[0m09:46:25.453223 [debug] [MainThread]: Connection 'debug' was left open.
[0m09:46:25.454223 [debug] [MainThread]: On debug: Close
[0m09:46:25.938289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5F77A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE65115CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE6496AED0>]}
[0m09:46:25.939294 [debug] [MainThread]: Flushing usage events
[0m09:46:26.991526 [debug] [MainThread]: An error was encountered while trying to flush usage events
